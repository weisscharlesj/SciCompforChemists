
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 15: Cheminformatics with RDKit &#8212; Scientific Computing for Chemists with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/chapter_15/chap_15_notebook';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 16: Bioinformatics with Biopython and Nglview" href="../chapter_16/chap_16_notebook.html" />
    <link rel="prev" title="Chapter 14: Optimization and Root Finding" href="../chapter_14/chap_14_notebook.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../introduction/intro.html">
  
  
  
  
  
    
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Scientific Computing for Chemists with Python - Home"/>
    <img src="../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt="Scientific Computing for Chemists with Python - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction/intro.html">
                    Scientific Computing for Chemists with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Scientific Computing Skills</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_00/chap_00_notebook.html">Chapter 0: Python &amp; Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_01/chap_01_notebook.html">Chapter 1: Basic Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_02/chap_02_notebook.html">Chapter 2: Intermediate Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_03/chap_03_notebook.html">Chapter 3: Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_04/chap_04_notebook.html">Chapter 4: NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_05/chap_05_notebook.html">Chapter 5: Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics &amp; Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_06/chap_06_notebook.html">Chapter 6: Signal &amp; Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_07/chap_07_notebook.html">Chapter 7: Image Processing &amp; Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_08/chap_08_notebook.html">Chapter 8: Mathematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_09/chap_09_notebook.html">Chapter 9: Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_10/chap_10_notebook.html">Chapter 10: Plotting with Seaborn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_11/chap_11_notebook.html">Chapter 11: Nuclear Magnetic Resonance with nmrglue and nmrsim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_12/chap_12_notebook.html">Chapter 12: Machine Learning using Scikit-Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_13/chap_13_notebook.html">Chapter 13: Command Line &amp; Spyder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_14/chap_14_notebook.html">Chapter 14: Optimization and Root Finding</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 15: Cheminformatics with RDKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_16/chap_16_notebook.html">Chapter 16: Bioinformatics with Biopython and Nglview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix_00/appendix_00_notebook.html">Appendix 0: Ipython Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix_01/appendix_01_notebook.html">Appendix 1: Remote Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix_02/appendix_02_notebook.html">Appendix 2: Visualizing Atomic Orbitals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists/issues/new?title=Issue%20on%20page%20%2Fnotebooks/chapter_15/chap_15_notebook.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/chapter_15/chap_15_notebook.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 15: Cheminformatics with RDKit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-molecular-representations-into-rdkit">15.1 Loading Molecular Representations into RDKit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-chemical-structures">15.2 Visualizing Chemical Structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-chemical-structures">15.2.1 Single Chemical Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grids-of-chemical-structures">15.2.2 Grids of Chemical Structures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stereochemistry">15.3 Stereochemistry</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assigning-stereochemistry">15.3.1 Assigning Stereochemistry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-and-generating-isomers">15.3.2 Counting and Generating Isomers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chem-descriptor-module">15.4 <code class="docutils literal notranslate"><span class="pre">Chem.Descriptor</span></code> Module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-features">15.4.1 Molecular Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-functional-groups">15.4.2 Quantifying Functional Groups</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-molecules-for-structural-patterns">15.5 Searching Molecules for Structural Patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms-and-bonds">15.6 Atoms and Bonds</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-15-cheminformatics-with-rdkit">
<span id="id1"></span><h1>Chapter 15: Cheminformatics with RDKit<a class="headerlink" href="#chapter-15-cheminformatics-with-rdkit" title="Link to this heading">#</a></h1>
<p><em>Cheminformatics</em> can be thought of as the intersection of data science, computer science, and chemistry as a means of better understanding and solving chemical problems. This chapter introduces a popular and versatile Python cheminformatics library known as RDKit which is useful for tasks such as:</p>
<ul class="simple">
<li><p>Visualizing molecules</p></li>
<li><p>Reading SMILES or InChI molecular representations</p></li>
<li><p>Quantifying structural features in molecules such as number of rings or hydrogen bond donors</p></li>
<li><p>Generating all possible stereoisomers of a molecular structure</p></li>
<li><p>Filtering molecules based on structural features</p></li>
</ul>
<p>This is a popular library for those in chemical computing research with examples of its use being relatively easy to find in the chemical literature. As of this writing, RDKit can be installed with either conda or pip (see <a class="reference internal" href="../chapter_00/chap_00_notebook.html#id4"><span class="std std-ref">section 0.2.1</span></a> and link below). If you are using Google Colab, you will need to install RDKit at the top of your notebook (see <a class="reference internal" href="../chapter_00/chap_00_notebook.html#id5"><span class="std std-ref">section 0.2.2</span></a>) as it is not installed by default in Colab.</p>
<p><a class="reference external" href="https://www.rdkit.org/docs/Install.html">Installing RDKit</a></p>
<p>This chapter assumes the following imports from RDKit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span><span class="p">,</span> <span class="n">Descriptors</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">SimilarityMaps</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">rdFingerprintGenerator</span>

<span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">IPythonConsole</span>
<span class="n">IPythonConsole</span><span class="o">.</span><span class="n">ipython_useSVG</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>RDKit is composed of a number of modules including, but not limited to, the following.</p>
<p><strong>Table 1</strong> Key Modules and Submodules in the RDKit Library</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Module/Submodule</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem</span></code></p></td>
<td class="text-left"><p>General purpose tools for chemistry. The <a class="reference external" href="https://www.rdkit.org/docs/source/rdkit.Chem.html#module-rdkit.Chem">RDKit website</a> describes it as “A module for molecules and stuff”.</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.AllChem</span></code></p></td>
<td class="text-left"><p>Submodule containing more specialized or less often used features; needs to be imported separatly from <code class="docutils literal notranslate"><span class="pre">Chem</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.Descriptors</span></code></p></td>
<td class="text-left"><p>Submodule for quantifying molecular features</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.Draw</span></code></p></td>
<td class="text-left"><p>Submodule for visualizing molecules</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ML</span></code></p></td>
<td class="text-left"><p>Machine learning tools</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Chem</span></code> and <code class="docutils literal notranslate"><span class="pre">ML</span></code> modules are the major modules in RDKit, but for this chapter, we will only be focusing on the <code class="docutils literal notranslate"><span class="pre">Chem</span></code> module which has already been imported above.</p>
<section id="loading-molecular-representations-into-rdkit">
<span id="id2"></span><h2>15.1 Loading Molecular Representations into RDKit<a class="headerlink" href="#loading-molecular-representations-into-rdkit" title="Link to this heading">#</a></h2>
<p id="index-1"><span id="index-0"></span>There are many ways to depict molecular structures on paper such as Lewis structures, line-angle structural formulas, and condensed notation. When representing molecules for a computer, machine-readable methods such as Simplified Molecular-Input Line-Entry System (SMILES), the International Chemical Identifier (InChI), or mol files are preferred. For example, the SMILES and InChI representations for benzene are listed below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SMILES: c1ccccc1

InChI: 1S/C6H6/c1-2-4-6-5-3-1/h1-6H
</pre></div>
</div>
<p>These are not the most human-readable formats, but computer software such as RDKit is quite good at dealing with them. We will not get into the structure and rules for interpreting these representations here because it is not really neccesary; reading and writing them is RDKit’s job. You can obtain these representations of a molecular structure from a variety of sources such as generating them from chemical drawing software (e.g., ChemDraw or ChemDoodle), searching <a class="reference external" href="https://webbook.nist.gov/chemistry/">NIST Chemical Webbook</a> or <a class="reference external" href="https://pubchem.ncbi.nlm.nih.gov/">NIH PubChem</a>, and many other sources. In this chapter, we will mainly focus on SMILES representations, but working with the InChI and MOL file formats is analogous and may be used from time-to-time herein.</p>
<p>The functions below can read and write molecular structures from a variety of formats including SMILES, InChI, and MOL files. When reading these molecular structures, a Molecule object (RDKit-specific class of object) is generated.</p>
<p><strong>Table 2</strong> Functions for Loading Molecular Structures</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmiles()</span></code></p></td>
<td><p>Generates a Molecule object from SMILES representation</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.MolToSmiles()</span></code></p></td>
<td><p>Generates SMILES representation from a Molecule object</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.inchi.MolFromInchi()</span></code></p></td>
<td><p>Generates a Molecule object from InChI representation</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Chem.inchi.MolToInchi()</span></code></p></td>
<td><p>Generates InChI representation from a Molecule object</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">MolFromMolFile()</span></code></p></td>
<td><p>Generates a Molecule object from a MOL file</p></td>
</tr>
</tbody>
</table>
</div>
<p>As an example, we will load the structure of aspirin (acetylsalicylic acid) using the <code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmiles()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">Chem</span></code> module.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspirin</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;O=C(C)Oc1ccccc1C(=O)O&#39;</span><span class="p">)</span>
<span class="n">aspirin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 164.0,50.6 L 167.3,65.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 167.3,65.7 L 170.5,80.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 158.8,51.7 L 162.0,66.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 162.0,66.8 L 165.2,81.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 167.5,79.8 L 140.8,103.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 167.5,79.8 L 181.7,84.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 181.7,84.4 L 195.9,89.0' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 207.6,85.6 L 218.1,76.2' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 218.1,76.2 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 228.5,66.8 L 221.0,31.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 233.1,62.6 L 226.9,33.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 221.0,31.6 L 247.7,7.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 247.7,7.5 L 281.9,18.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 249.0,13.6 L 277.3,22.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 281.9,18.6 L 289.5,53.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 289.5,53.8 L 262.7,77.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 283.5,51.9 L 261.4,71.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 262.7,77.9 L 270.3,113.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 267.9,115.2 L 282.9,120.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 282.9,120.0 L 297.8,124.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 269.6,110.0 L 284.5,114.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 284.5,114.9 L 299.5,119.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 270.3,113.1 L 259.8,122.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 259.8,122.5 L 249.4,131.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-9 atom-4' d='M 262.7,77.9 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 166.2,81.0 L 167.5,79.8 L 168.3,80.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 221.4,33.4 L 221.0,31.6 L 222.3,30.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 246.4,8.7 L 247.7,7.5 L 249.4,8.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 280.2,18.0 L 281.9,18.6 L 282.3,20.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 289.1,52.0 L 289.5,53.8 L 288.1,55.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 269.9,111.3 L 270.3,113.1 L 269.7,113.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 155.3 44.7
Q 155.3 42.2, 156.6 40.9
Q 157.8 39.5, 160.0 39.5
Q 162.3 39.5, 163.5 40.9
Q 164.7 42.2, 164.7 44.7
Q 164.7 47.1, 163.5 48.6
Q 162.3 50.0, 160.0 50.0
Q 157.8 50.0, 156.6 48.6
Q 155.3 47.2, 155.3 44.7
M 160.0 48.8
Q 161.6 48.8, 162.4 47.8
Q 163.3 46.7, 163.3 44.7
Q 163.3 42.7, 162.4 41.7
Q 161.6 40.6, 160.0 40.6
Q 158.5 40.6, 157.6 41.6
Q 156.8 42.7, 156.8 44.7
Q 156.8 46.7, 157.6 47.8
Q 158.5 48.8, 160.0 48.8
' fill='#FF0000'/>
<path class='atom-3' d='M 197.1 90.9
Q 197.1 88.5, 198.3 87.1
Q 199.5 85.8, 201.8 85.8
Q 204.0 85.8, 205.2 87.1
Q 206.5 88.5, 206.5 90.9
Q 206.5 93.4, 205.2 94.8
Q 204.0 96.2, 201.8 96.2
Q 199.5 96.2, 198.3 94.8
Q 197.1 93.4, 197.1 90.9
M 201.8 95.1
Q 203.3 95.1, 204.2 94.0
Q 205.0 93.0, 205.0 90.9
Q 205.0 88.9, 204.2 87.9
Q 203.3 86.9, 201.8 86.9
Q 200.2 86.9, 199.4 87.9
Q 198.5 88.9, 198.5 90.9
Q 198.5 93.0, 199.4 94.0
Q 200.2 95.1, 201.8 95.1
' fill='#FF0000'/>
<path class='atom-11' d='M 299.8 124.2
Q 299.8 121.7, 301.0 120.4
Q 302.2 119.0, 304.5 119.0
Q 306.8 119.0, 308.0 120.4
Q 309.2 121.7, 309.2 124.2
Q 309.2 126.7, 308.0 128.1
Q 306.7 129.5, 304.5 129.5
Q 302.3 129.5, 301.0 128.1
Q 299.8 126.7, 299.8 124.2
M 304.5 128.3
Q 306.1 128.3, 306.9 127.3
Q 307.7 126.2, 307.7 124.2
Q 307.7 122.2, 306.9 121.2
Q 306.1 120.2, 304.5 120.2
Q 302.9 120.2, 302.1 121.2
Q 301.3 122.2, 301.3 124.2
Q 301.3 126.2, 302.1 127.3
Q 302.9 128.3, 304.5 128.3
' fill='#FF0000'/>
<path class='atom-12' d='M 228.8 132.2
L 230.2 132.2
L 230.2 136.5
L 235.4 136.5
L 235.4 132.2
L 236.8 132.2
L 236.8 142.3
L 235.4 142.3
L 235.4 137.6
L 230.2 137.6
L 230.2 142.3
L 228.8 142.3
L 228.8 132.2
' fill='#FF0000'/>
<path class='atom-12' d='M 238.9 137.2
Q 238.9 134.8, 240.1 133.4
Q 241.3 132.0, 243.5 132.0
Q 245.8 132.0, 247.0 133.4
Q 248.2 134.8, 248.2 137.2
Q 248.2 139.7, 247.0 141.1
Q 245.8 142.5, 243.5 142.5
Q 241.3 142.5, 240.1 141.1
Q 238.9 139.7, 238.9 137.2
M 243.5 141.3
Q 245.1 141.3, 245.9 140.3
Q 246.8 139.3, 246.8 137.2
Q 246.8 135.2, 245.9 134.2
Q 245.1 133.2, 243.5 133.2
Q 242.0 133.2, 241.1 134.2
Q 240.3 135.2, 240.3 137.2
Q 240.3 139.3, 241.1 140.3
Q 242.0 141.3, 243.5 141.3
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<p>If we check the object type, we find that it is a Molecule (<code class="docutils literal notranslate"><span class="pre">rdchem.Mol</span></code>) RDKit object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">aspirin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>rdkit.Chem.rdchem.Mol
</pre></div>
</div>
</div>
</div>
<p>RDKit can generate other molecular representations such as InChI from the Molecule object as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">inchi</span><span class="o">.</span><span class="n">MolToInchi</span><span class="p">(</span><span class="n">aspirin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;InChI=1S/C9H8O4/c1-6(10)13-8-5-3-2-4-7(8)9(11)12/h2-5H,1H3,(H,11,12)&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-chemical-structures">
<span id="id3"></span><h2>15.2 Visualizing Chemical Structures<a class="headerlink" href="#visualizing-chemical-structures" title="Link to this heading">#</a></h2>
<p>In the above examples, RDKit provided an image of the molecule simply by Jupyter running the Molecule object. By default, this generates a rather small and low resolution image. To generate a sharper image, like above, running the following code at the top of a notebook changes the settings to produce SVG (Scalable Vector Graphic) images which are a vector graphic format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rdkit.Chem.Draw</span> <span class="kn">import</span> <span class="n">IPythonConsole</span>
<span class="n">IPythonConsole</span><span class="o">.</span><span class="n">ipython_useSVG</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<section id="single-chemical-structures">
<span id="id4"></span><h3>15.2.1 Single Chemical Structures<a class="headerlink" href="#single-chemical-structures" title="Link to this heading">#</a></h3>
<p>However, simply running the Molecule object does not provide easy control over the image. In this section, we will generate images that can be saved along with visualizing grids of molecules and other visual representations.</p>
<p>To view the molecule, we can use the <code class="docutils literal notranslate"><span class="pre">Chem.Draw.MolToImage(Mol)</span></code> function which takes one required positional arguments of the Molecule object (<code class="docutils literal notranslate"><span class="pre">Mol</span></code>). Optional keyword arguments can be used to set other parameters such as the image size (<code class="docutils literal notranslate"><span class="pre">size=</span></code>) in pixels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">aspirin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0117c1512fcf1eb086b9845cd56c4cd0d8681d30a10084641b9494e21baf3e6d.png" src="../../_images/0117c1512fcf1eb086b9845cd56c4cd0d8681d30a10084641b9494e21baf3e6d.png" />
</div>
</div>
<p>If we want to save the image to a file, this is accomplished using the <code class="docutils literal notranslate"><span class="pre">Chem.Draw.MolToFile()</span></code> function which requires two pieces of information - the Molecule object and the name of the new file as a string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToFile</span><span class="p">(</span><span class="n">mol_object</span><span class="p">,</span> <span class="s1">&#39;file_name.png&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">imageType</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Other optional parameters include the <code class="docutils literal notranslate"><span class="pre">size=</span></code> which is a tuple that takes the width and height, respectively, in pixels, and the <code class="docutils literal notranslate"><span class="pre">imageType=</span></code> accepts a string to designate the file format (‘png’ or ‘svg’).</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PNG file formate is a great general-purpose raster file format. Unless you know you need a different file format, this is often a good choice. The SVG file format is a vector format which makes it easily editable in software applications such as <a class="reference external" href="https://inkscape.org/">Inkscape</a>.</p>
</div>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important that the extension (e.g., “.png”) matches the <code class="docutils literal notranslate"><span class="pre">imageType=</span></code> argument or else your computer may have difficulties opening the file.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToFile</span><span class="p">(</span><span class="n">aspirin</span><span class="p">,</span> <span class="s1">&#39;aspirin.svg&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span>
                    <span class="n">imageType</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Molecules can also be displayed in plots created by matplotlib. Below is an example of the <em>trans</em>-cinnamic acid structure being displayed on top of the IR spectrum of the compound.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cinn_acid</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;O=C(O)\C=C\c1ccccc1&#39;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">cinn_acid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
&lt;&gt;:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
/var/folders/zy/7y6kpdbx6p1ffrp1vtxy3ttc0000gn/T/ipykernel_2272/2415650442.py:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
  cinn_acid = Chem.MolFromSmiles(&#39;O=C(O)\C=C\c1ccccc1&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;data/cinnamic_acid.CSV&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">IR</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">IR</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavenumbers, cm$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;%, Transmittance&#39;</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1203ffe00&gt;
</pre></div>
</div>
<img alt="../../_images/b590f6640af7ca5fb738aef7eddcab7355f768a516da198b7f48692082b33817.svg" src="../../_images/b590f6640af7ca5fb738aef7eddcab7355f768a516da198b7f48692082b33817.svg" />
</div>
</div>
</section>
<section id="grids-of-chemical-structures">
<span id="id5"></span><h3>15.2.2 Grids of Chemical Structures<a class="headerlink" href="#grids-of-chemical-structures" title="Link to this heading">#</a></h3>
<p>Whenever we are dealing with collections of molecules, it may be helpful to generate an image that includes multiple molecular structures known as a grid. As an example, we will load the SMILES strings of the twenty common amino acids from a text file using pandas and then load the Molecule objects for each structure into a single list called <code class="docutils literal notranslate"><span class="pre">AminoAcids</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/amino_acid_SMILES.txt&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>SMILES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alanine</td>
      <td>C[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>arginine</td>
      <td>[NH3+][C@@H](CCCNC(=[NH2+])N)C(=O)[O-]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>asparagine</td>
      <td>O=C(N)C[C@H]([NH3+])C(=O)[O-]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aspartate</td>
      <td>C([C@@H](C(=O)[O-])[NH3+])C(=O)[O-]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cysteine</td>
      <td>C([C@@H](C(=O)[O-])[NH3+])S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>glutamine</td>
      <td>[NH3+][C@@H](CCC(=O)N)C([O-])=O</td>
    </tr>
    <tr>
      <th>6</th>
      <td>glutamate</td>
      <td>C(CC(=O)[O-])[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>7</th>
      <td>glycine</td>
      <td>C(C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>8</th>
      <td>histidine</td>
      <td>O=C([C@H](CC1=CNC=N1)[NH3+])[O-]</td>
    </tr>
    <tr>
      <th>9</th>
      <td>isoleucine</td>
      <td>CC[C@H](C)[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>10</th>
      <td>leucine</td>
      <td>CC(C)C[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>11</th>
      <td>lysine</td>
      <td>C(CC[NH3+])C[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
    <tr>
      <th>12</th>
      <td>methionine</td>
      <td>CSCC[C@H]([NH3+])C(=O)[O-]</td>
    </tr>
    <tr>
      <th>13</th>
      <td>phenylalanine</td>
      <td>[NH3+][C@@H](CC1=CC=CC=C1)C([O-])=O</td>
    </tr>
    <tr>
      <th>14</th>
      <td>proline</td>
      <td>[O-]C(=O)[C@H](CCC2)[NH2+]2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>serine</td>
      <td>C([C@@H](C(=O)[O-])[NH3+])O</td>
    </tr>
    <tr>
      <th>16</th>
      <td>threonine</td>
      <td>C[C@H]([C@@H](C(=O)[O-])[NH3+])O</td>
    </tr>
    <tr>
      <th>17</th>
      <td>tryptophan</td>
      <td>c1[nH]c2ccccc2c1C[C@H]([NH3+])C(=O)[O-]</td>
    </tr>
    <tr>
      <th>18</th>
      <td>tyrosine</td>
      <td>[NH3+][C@@H](Cc1ccc(O)cc1)C([O-])=O</td>
    </tr>
    <tr>
      <th>19</th>
      <td>valine</td>
      <td>CC(C)[C@@H](C(=O)[O-])[NH3+]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AminoAcids</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">SMILES</span><span class="p">)</span> <span class="k">for</span> <span class="n">SMILES</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]]</span>
<span class="n">AminoAcids</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;rdkit.Chem.rdchem.Mol at 0x120197060&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120196b90&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201971b0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197220&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197300&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197370&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201973e0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197450&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201974c0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197530&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201975a0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197680&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201976f0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197760&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201977d0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197840&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1201978b0&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197920&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197990&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x120197a00&gt;]
</pre></div>
</div>
</div>
</div>
<p>To generate the grid, we will use the <code class="docutils literal notranslate"><span class="pre">MolsToGridImage()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">Chem.Draw</span></code> submodule. This function requires one positional argument of an array-like object (e.g., list, tuple, ndarray, etc.) containing the Molecule objects. Other optional keyword arguments include the number of molecules per row (<code class="docutils literal notranslate"><span class="pre">molsPerRow=</span></code>), the pixel dimensions of each molecule (<code class="docutils literal notranslate"><span class="pre">subImgSize=</span></code>), labels below each molecule (<code class="docutils literal notranslate"><span class="pre">legends=</span></code>), and the ability to make images SVG format (<code class="docutils literal notranslate"><span class="pre">usesSVG=</span></code>). The image dimensions only matter if using a raster image format and requires a tuple with the width and height in that order. The <code class="docutils literal notranslate"><span class="pre">legends=</span></code> argument requires an array-like object with the labels in the same order as the object containing the Molecule objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">AminoAcids</span><span class="p">,</span> 
                          <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                          <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span>
                          <span class="n">legends</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span>
                          <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/60cac339e086d89f821e29c339d35e23ed3e1491e00d2b52cb4fd1376269a06e.svg" src="../../_images/60cac339e086d89f821e29c339d35e23ed3e1491e00d2b52cb4fd1376269a06e.svg" />
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re wondering what is up with the <code class="docutils literal notranslate"><span class="pre">AllChem</span></code> submodule, it stores lesser used features separately from the more mainstay features. By storing these features separately, it speeds up importing the main features. However, the extra cost in time is not substatial, and this submodule contains some cool features such as <a class="reference internal" href="#id8"><span class="std std-ref">generating all possible stereoisomers</span></a> and <a class="reference internal" href="#id12"><span class="std std-ref">filtering molecules based on structural features</span></a>.</p>
</div>
</aside>
</section>
</section>
<section id="stereochemistry">
<span id="id6"></span><h2>15.3 Stereochemistry<a class="headerlink" href="#stereochemistry" title="Link to this heading">#</a></h2>
<p id="index-3"><span id="index-2"></span>RDKit can assign the stereochemistry of stereocenters, including chiral centers (<em>R</em> vs. <em>S</em>) and alkene stereocenters (<em>E</em> vs. <em>Z</em>), determine the number of isomers possible, and even generate all possible isomers. Whether or not any stereochemistry is designated in the SMILES representation or Molecule object is an important detail in carrying out the above tasks. Even though a molecule may contain a chiral center or an alkene carbon, the stereochemistry around that atom may be ambiguous.</p>
<p>The SMILES representation shows stereochemistry around a tetrahedral carbon with either <strong>&#64;</strong> or <strong>&#64;&#64;</strong> and around an alkene with <strong>\</strong> and <strong>/</strong> symbols. If the SMILES representation does not include these symbols, the stereochemistry is not indicated.</p>
<p><strong>Table 3</strong> SMILES Stereochemical Designations</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Designation</p></th>
<th class="head"><p>Alkene</p></th>
<th class="head"><p>Chiral sp<span class="math notranslate nohighlight">\(^3\)</span> Atom</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>No isomer designation</p></td>
<td><p>C(=CC)C</p></td>
<td><p>CCC(C)O</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>First isomer</p></td>
<td><p>C/C=C\C</p></td>
<td><p>CC[C&#64;H](C)O</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Second isomer</p></td>
<td><p>C/C=C/C</p></td>
<td><p>CC[C&#64;&#64;H](C)O</p></td>
</tr>
</tbody>
</table>
</div>
<section id="assigning-stereochemistry">
<span id="id7"></span><h3>15.3.1 Assigning Stereochemistry<a class="headerlink" href="#assigning-stereochemistry" title="Link to this heading">#</a></h3>
<p>The first task is to assign the absolute stereochemistry of a molecule. As an example, below we have a single isomer of pent-3-en-2-ol which has a single chiral center and an alkene that could potentially be either <em>E</em> or <em>Z</em>. Let’s have RDKit tell us the absolute configuration (i.e., <em>R</em> or <em>S</em>) of the tetrahedral chiral center and if the alkene is <em>E</em> or <em>Z</em>. First, we will load the SMILES representation of this compound, <code class="docutils literal notranslate"><span class="pre">O[C&#64;&#64;H](C)/C=C/C</span></code>, which contains both <strong>&#64;</strong> and <strong>/</strong> symbols, so we know the stereochemistry is assigned in this representation. When we visualize it below, we can see a wedge for the methyl on the chiral center instead of a regular line, for example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pentenol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;O[C@@H](C)/C=C/C&#39;</span><span class="p">)</span>
<span class="n">pentenol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 149.0,118.4 L 153.3,88.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 153.3,88.1 L 157.7,57.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 157.7,57.9 L 95.7,16.3 L 102.6,7.5 Z' style='fill:#000000;fill-rule:evenodd;fill-opacity:1;stroke:#000000;stroke-width:0.5px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='bond-2 atom-1 atom-3' d='M 157.7,57.9 L 226.7,30.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 226.7,30.2 L 285.2,76.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 224.9,42.9 L 278.3,84.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 285.2,76.1 L 354.3,48.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 157.4,59.4 L 157.7,57.9 L 161.1,56.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 223.3,31.5 L 226.7,30.2 L 229.6,32.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 282.3,73.8 L 285.2,76.1 L 288.7,74.7' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 137.4 131.6
Q 137.4 126.5, 139.9 123.7
Q 142.4 120.9, 147.1 120.9
Q 151.8 120.9, 154.3 123.7
Q 156.8 126.5, 156.8 131.6
Q 156.8 136.7, 154.3 139.6
Q 151.7 142.5, 147.1 142.5
Q 142.5 142.5, 139.9 139.6
Q 137.4 136.7, 137.4 131.6
M 147.1 140.1
Q 150.3 140.1, 152.0 138.0
Q 153.8 135.8, 153.8 131.6
Q 153.8 127.4, 152.0 125.4
Q 150.3 123.2, 147.1 123.2
Q 143.9 123.2, 142.1 125.3
Q 140.4 127.4, 140.4 131.6
Q 140.4 135.8, 142.1 138.0
Q 143.9 140.1, 147.1 140.1
' fill='#FF0000'/>
<path class='atom-0' d='M 160.1 121.1
L 162.9 121.1
L 162.9 130.1
L 173.7 130.1
L 173.7 121.1
L 176.6 121.1
L 176.6 142.2
L 173.7 142.2
L 173.7 132.4
L 162.9 132.4
L 162.9 142.2
L 160.1 142.2
L 160.1 121.1
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<p>To obtain the absolute configuration (i.e.,R or S), we can use the <code class="docutils literal notranslate"><span class="pre">Chem.FindMolChiralCenters()</span></code> function which returns the absolute configuration and an index indication which atom has that configuration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">FindMolChiralCenters</span><span class="p">(</span><span class="n">pentenol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1, &#39;S&#39;)]
</pre></div>
</div>
</div>
</div>
<p>Our pent-3-en-2-ol isomer above has an <em>S</em> stereocenter. Being that pent-3-en-2-ol has only one chiral center, it is not difficult to determine which atom has the stereochemistry, but if there are multiple chiral centers, it can get confusing. To see the atom indices and stereochemistry labels on the molecule, this can be enabled (or disabled using <code class="docutils literal notranslate"><span class="pre">False</span></code>) by the following code.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The index values are assigned by RDKit and are <strong>not</strong> the same thing as the numbers from chemical nomenclature.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPythonConsole</span><span class="o">.</span><span class="n">drawOptions</span><span class="o">.</span><span class="n">addAtomIndices</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">IPythonConsole</span><span class="o">.</span><span class="n">drawOptions</span><span class="o">.</span><span class="n">addStereoAnnotation</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pentenol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 159.9,104.7 L 163.7,78.2' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 163.7,78.2 L 167.5,51.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 167.5,51.6 L 113.2,15.2 L 119.2,7.5 Z' style='fill:#000000;fill-rule:evenodd;fill-opacity:1;stroke:#000000;stroke-width:0.5px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='bond-2 atom-1 atom-3' d='M 167.5,51.6 L 228.0,27.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 228.0,27.4 L 279.3,67.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 226.4,38.5 L 273.3,75.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 279.3,67.7 L 339.8,43.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 167.3,53.0 L 167.5,51.6 L 170.5,50.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 225.0,28.6 L 228.0,27.4 L 230.6,29.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 276.7,65.6 L 279.3,67.7 L 282.3,66.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 149.8 116.3
Q 149.8 111.8, 151.9 109.3
Q 154.1 106.9, 158.2 106.9
Q 162.3 106.9, 164.5 109.3
Q 166.7 111.8, 166.7 116.3
Q 166.7 120.7, 164.5 123.3
Q 162.3 125.8, 158.2 125.8
Q 154.2 125.8, 151.9 123.3
Q 149.8 120.8, 149.8 116.3
M 158.2 123.7
Q 161.0 123.7, 162.6 121.9
Q 164.1 120.0, 164.1 116.3
Q 164.1 112.6, 162.6 110.8
Q 161.0 109.0, 158.2 109.0
Q 155.4 109.0, 153.9 110.8
Q 152.4 112.6, 152.4 116.3
Q 152.4 120.0, 153.9 121.9
Q 155.4 123.7, 158.2 123.7
' fill='#FF0000'/>
<path class='atom-0' d='M 169.6 107.1
L 172.1 107.1
L 172.1 114.9
L 181.5 114.9
L 181.5 107.1
L 184.0 107.1
L 184.0 125.5
L 181.5 125.5
L 181.5 117.0
L 172.1 117.0
L 172.1 125.5
L 169.6 125.5
L 169.6 107.1
' fill='#FF0000'/>
<path class='note' d='M 155.1 142.5
Q 153.5 142.5, 152.6 141.2
Q 151.8 140.0, 151.8 137.8
Q 151.8 135.5, 152.6 134.3
Q 153.4 133.1, 155.1 133.1
Q 156.9 133.1, 157.7 134.3
Q 158.5 135.5, 158.5 137.8
Q 158.5 140.0, 157.7 141.2
Q 156.8 142.5, 155.1 142.5
M 155.1 141.5
Q 156.2 141.5, 156.7 140.5
Q 157.2 139.6, 157.2 137.8
Q 157.2 136.0, 156.7 135.0
Q 156.2 134.1, 155.1 134.1
Q 154.2 134.1, 153.6 135.0
Q 153.1 136.0, 153.1 137.8
Q 153.1 139.6, 153.6 140.5
Q 154.2 141.5, 155.1 141.5
' fill='#000000'/>
<path class='note' d='M 136.6 63.9
L 138.7 63.9
L 138.7 57.0
L 136.4 57.6
L 136.1 56.9
L 139.0 55.6
L 139.9 55.8
L 139.9 63.9
L 141.7 63.9
L 141.7 64.9
L 136.6 64.9
L 136.6 63.9
' fill='#000000'/>
<path class='note' d='M 142.6 63.6
L 143.9 63.6
L 143.9 64.6
L 143.7 66.4
L 143.2 66.4
L 143.2 64.9
L 142.6 64.9
L 142.6 63.6
' fill='#000000'/>
<path class='note' d='M 145.1 61.2
Q 145.1 59.3, 145.7 57.8
Q 146.2 56.2, 147.3 54.6
L 148.0 55.0
Q 147.2 56.6, 146.7 58.0
Q 146.3 59.4, 146.3 61.2
Q 146.3 62.9, 146.7 64.3
Q 147.2 65.7, 148.0 67.3
L 147.3 67.8
Q 146.2 66.1, 145.7 64.6
Q 145.1 63.1, 145.1 61.2
' fill='#000000'/>
<path class='note' d='M 149.1 63.5
Q 149.2 63.5, 149.6 63.7
Q 150.0 63.9, 150.5 64.0
Q 151.0 64.1, 151.4 64.1
Q 152.3 64.1, 152.8 63.7
Q 153.3 63.2, 153.3 62.5
Q 153.3 62.0, 153.1 61.7
Q 152.8 61.4, 152.4 61.2
Q 152.0 61.0, 151.4 60.8
Q 150.6 60.6, 150.1 60.3
Q 149.6 60.1, 149.2 59.6
Q 148.9 59.1, 148.9 58.3
Q 148.9 57.1, 149.7 56.4
Q 150.5 55.7, 152.0 55.7
Q 153.1 55.7, 154.3 56.2
L 154.0 57.2
Q 152.9 56.7, 152.1 56.7
Q 151.2 56.7, 150.7 57.1
Q 150.2 57.5, 150.2 58.1
Q 150.2 58.6, 150.4 58.9
Q 150.7 59.2, 151.1 59.4
Q 151.5 59.6, 152.1 59.8
Q 152.9 60.0, 153.4 60.3
Q 153.9 60.5, 154.3 61.1
Q 154.6 61.6, 154.6 62.5
Q 154.6 63.8, 153.8 64.5
Q 152.9 65.1, 151.5 65.1
Q 150.7 65.1, 150.0 65.0
Q 149.4 64.8, 148.7 64.5
L 149.1 63.5
' fill='#000000'/>
<path class='note' d='M 158.5 61.2
Q 158.5 63.1, 157.9 64.6
Q 157.4 66.1, 156.3 67.8
L 155.6 67.3
Q 156.5 65.7, 156.9 64.3
Q 157.3 62.9, 157.3 61.2
Q 157.3 59.4, 156.9 58.0
Q 156.5 56.6, 155.6 55.0
L 156.3 54.6
Q 157.4 56.2, 157.9 57.8
Q 158.5 59.3, 158.5 61.2
' fill='#000000'/>
<path class='note' d='M 103.0 12.6
Q 103.3 11.7, 104.2 11.2
Q 105.0 10.7, 106.1 10.7
Q 107.5 10.7, 108.3 11.5
Q 109.0 12.2, 109.0 13.6
Q 109.0 14.9, 108.0 16.2
Q 107.0 17.5, 104.9 19.0
L 109.2 19.0
L 109.2 20.1
L 103.0 20.1
L 103.0 19.2
Q 104.7 18.0, 105.7 17.0
Q 106.8 16.1, 107.2 15.3
Q 107.7 14.5, 107.7 13.6
Q 107.7 12.8, 107.3 12.3
Q 106.9 11.8, 106.1 11.8
Q 105.3 11.8, 104.8 12.1
Q 104.4 12.4, 104.0 13.0
L 103.0 12.6
' fill='#000000'/>
<path class='note' d='M 230.9 16.4
Q 231.8 16.7, 232.2 17.3
Q 232.7 17.8, 232.7 18.7
Q 232.7 19.5, 232.3 20.1
Q 231.9 20.7, 231.2 21.1
Q 230.4 21.4, 229.5 21.4
Q 228.5 21.4, 227.8 21.1
Q 227.0 20.7, 226.5 20.0
L 227.2 19.2
Q 227.8 19.9, 228.3 20.1
Q 228.7 20.4, 229.5 20.4
Q 230.3 20.4, 230.8 19.9
Q 231.4 19.5, 231.4 18.7
Q 231.4 17.8, 230.8 17.4
Q 230.3 16.9, 229.2 16.9
L 228.5 16.9
L 228.5 16.0
L 229.1 16.0
Q 230.1 16.0, 230.6 15.6
Q 231.2 15.1, 231.2 14.3
Q 231.2 13.7, 230.7 13.3
Q 230.3 13.0, 229.5 13.0
Q 228.7 13.0, 228.3 13.2
Q 227.8 13.5, 227.4 14.2
L 226.5 13.7
Q 226.9 13.0, 227.6 12.5
Q 228.4 11.9, 229.5 11.9
Q 230.9 11.9, 231.7 12.6
Q 232.5 13.2, 232.5 14.3
Q 232.5 15.0, 232.1 15.6
Q 231.7 16.1, 230.9 16.4
' fill='#000000'/>
<path class='note' d='M 283.3 58.3
L 284.4 58.3
L 284.4 59.4
L 283.3 59.4
L 283.3 61.5
L 282.1 61.5
L 282.1 59.4
L 277.3 59.4
L 277.3 58.6
L 281.3 52.3
L 283.3 52.3
L 283.3 58.3
M 278.8 58.3
L 282.1 58.3
L 282.1 53.1
L 278.8 58.3
' fill='#000000'/>
<path class='note' d='M 344.1 52.3
Q 344.9 52.3, 345.6 52.7
Q 346.3 53.0, 346.6 53.7
Q 347.0 54.3, 347.0 55.2
Q 347.0 56.1, 346.5 56.8
Q 346.1 57.5, 345.3 57.8
Q 344.6 58.2, 343.7 58.2
Q 342.9 58.2, 342.1 57.9
Q 341.3 57.6, 340.8 57.0
L 341.6 56.2
Q 342.0 56.6, 342.6 56.9
Q 343.2 57.1, 343.8 57.1
Q 344.6 57.1, 345.1 56.6
Q 345.7 56.1, 345.7 55.2
Q 345.7 54.2, 345.1 53.8
Q 344.6 53.3, 343.7 53.3
Q 342.9 53.3, 342.0 53.6
L 341.3 53.3
L 341.7 48.9
L 346.4 48.9
L 346.3 49.9
L 342.8 49.9
L 342.5 52.6
Q 343.3 52.3, 344.1 52.3
' fill='#000000'/>
<path class='note' d='M 255.2 38.7
Q 255.2 36.8, 255.7 35.3
Q 256.3 33.8, 257.3 32.1
L 258.0 32.6
Q 257.2 34.1, 256.8 35.5
Q 256.3 36.9, 256.3 38.7
Q 256.3 40.5, 256.8 41.9
Q 257.2 43.2, 258.0 44.8
L 257.3 45.3
Q 256.3 43.7, 255.7 42.1
Q 255.2 40.6, 255.2 38.7
' fill='#7F7FFF'/>
<path class='note' d='M 258.7 33.2
L 264.2 33.2
L 264.2 34.2
L 260.0 34.2
L 260.0 37.0
L 263.8 37.0
L 263.8 38.1
L 260.0 38.1
L 260.0 41.3
L 264.4 41.3
L 264.4 42.4
L 258.7 42.4
L 258.7 33.2
' fill='#7F7FFF'/>
<path class='note' d='M 268.3 38.7
Q 268.3 40.6, 267.7 42.1
Q 267.2 43.7, 266.1 45.3
L 265.4 44.8
Q 266.2 43.2, 266.7 41.9
Q 267.1 40.5, 267.1 38.7
Q 267.1 36.9, 266.7 35.5
Q 266.2 34.1, 265.4 32.6
L 266.1 32.1
Q 267.2 33.8, 267.7 35.3
Q 268.3 36.8, 268.3 38.7
' fill='#7F7FFF'/>
</svg>
</div></div>
</div>
<p>To obtain the stereochemistry of double bonds, we can iteration through the bonds and obtain the stereochemistry using the <code class="docutils literal notranslate"><span class="pre">GetStereo()</span></code> bond method as shown below. There are three possible outputs list below.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on bond methods, see <a class="reference internal" href="#id13"><span class="std std-ref">section 15.6</span></a>.</p>
</div>
</aside>
<p><strong>Table 4</strong> Bond Stereochemical Designations in RDKit</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Ouput</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>STEREONONE</p></td>
<td><p>No stereochemistry (often not a double bond)</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>STEREOE</p></td>
<td><p><em>E</em> stereochemistry</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>STEREOZ</p></td>
<td><p><em>Z</em> stereochemistry</p></td>
</tr>
</tbody>
</table>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">STEREONONE</span></code> indicates there is no bond stereochemistry which could be the result of a singel or triple bond or it could be the result of the alkene bond has multiple equivalent substituents on the same carbon (e.g., 2-methylpent-2-ene).</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">pentenol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetStereo</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STEREONONE
STEREONONE
STEREONONE
STEREOE
STEREONONE
</pre></div>
</div>
</div>
</div>
<p>In the above example, there are four bonds with no stereochemistry due to being single bonds, and there is one <em>E</em> bond corresponding to the alkene. If there are multiple double bonds, it can be difficult to determine which bond has which stereochemistry. In this case, either use the image like shown above or use additional
bond methods (see <a class="reference internal" href="#id13"><span class="std std-ref">section 15.6</span></a>) to obtain more information about the bonds.</p>
<p>As another example, below we will look at the bonds in 9-<em>cis</em>-retinoic acid where we can see examples of all three possible bond stereochemical assignments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">retinoic</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;O=C(O)\C=C(\C=C\C=C(/C=C/C1=C(/CCCC1(C)C)C)C)C&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">retinoic</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bond</span><span class="o">.</span><span class="n">GetStereo</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STEREONONE
STEREONONE
STEREONONE
STEREOE
STEREONONE
STEREOE
STEREONONE
STEREOZ
STEREONONE
STEREOE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
STEREONONE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
&lt;&gt;:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
/var/folders/zy/7y6kpdbx6p1ffrp1vtxy3ttc0000gn/T/ipykernel_2272/3495209284.py:1: SyntaxWarning: invalid escape sequence &#39;\C&#39;
  retinoic = Chem.MolFromSmiles(&#39;O=C(O)\C=C(\C=C\C=C(/C=C/C1=C(/CCCC1(C)C)C)C)C&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">retinoic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 134.3,29.1 L 128.7,39.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 128.7,39.9 L 123.1,50.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 130.4,27.1 L 124.8,37.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 124.8,37.9 L 119.2,48.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 121.7,48.6 L 109.6,49.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 109.6,49.1 L 97.5,49.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 121.7,48.6 L 137.3,73.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 137.3,73.0 L 166.3,71.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 139.6,68.6 L 163.6,67.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 166.3,71.7 L 181.9,96.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 181.9,96.2 L 210.8,94.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 184.2,91.7 L 210.6,90.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 210.8,94.9 L 226.4,119.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 226.4,119.3 L 255.4,118.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 228.7,114.9 L 252.7,113.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 255.4,118.1 L 268.8,92.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 268.8,92.3 L 297.7,91.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 271.5,96.6 L 297.9,95.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 297.7,91.0 L 311.1,65.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-11 atom-12' d='M 311.1,65.3 L 295.5,40.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-11 atom-12' d='M 313.4,60.9 L 300.5,40.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-12 atom-13' d='M 295.5,40.9 L 308.9,15.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-13 atom-13 atom-14' d='M 308.9,15.1 L 337.8,13.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-14 atom-14 atom-15' d='M 337.8,13.9 L 353.4,38.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-15 atom-15 atom-16' d='M 353.4,38.3 L 340.1,64.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-16 atom-16 atom-17' d='M 340.1,64.0 L 367.7,72.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-17 atom-16 atom-18' d='M 340.1,64.0 L 336.3,92.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-18 atom-12 atom-19' d='M 295.5,40.9 L 266.5,42.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-19 atom-8 atom-20' d='M 255.4,118.1 L 271.0,142.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-20 atom-4 atom-21' d='M 166.3,71.7 L 179.6,46.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-21 atom-16 atom-11' d='M 340.1,64.0 L 311.1,65.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 121.1,48.6 L 121.7,48.6 L 122.5,49.8' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 136.5,71.8 L 137.3,73.0 L 138.8,73.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 181.1,95.0 L 181.9,96.2 L 183.3,96.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 209.4,95.0 L 210.8,94.9 L 211.6,96.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 225.7,118.1 L 226.4,119.3 L 227.9,119.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 268.1,93.6 L 268.8,92.3 L 270.2,92.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 296.3,91.1 L 297.7,91.0 L 298.4,89.8' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 308.2,16.4 L 308.9,15.1 L 310.3,15.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 336.4,13.9 L 337.8,13.9 L 338.6,15.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 352.7,37.1 L 353.4,38.3 L 352.8,39.6' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 131.3 22.9
Q 131.3 20.9, 132.3 19.8
Q 133.3 18.7, 135.1 18.7
Q 136.9 18.7, 137.9 19.8
Q 138.8 20.9, 138.8 22.9
Q 138.8 24.9, 137.9 26.0
Q 136.9 27.1, 135.1 27.1
Q 133.3 27.1, 132.3 26.0
Q 131.3 24.9, 131.3 22.9
M 135.1 26.2
Q 136.3 26.2, 137.0 25.4
Q 137.7 24.5, 137.7 22.9
Q 137.7 21.3, 137.0 20.5
Q 136.3 19.6, 135.1 19.6
Q 133.8 19.6, 133.1 20.4
Q 132.5 21.3, 132.5 22.9
Q 132.5 24.5, 133.1 25.4
Q 133.8 26.2, 135.1 26.2
' fill='#FF0000'/>
<path class='atom-2' d='M 80.9 45.8
L 82.0 45.8
L 82.0 49.3
L 86.2 49.3
L 86.2 45.8
L 87.3 45.8
L 87.3 54.0
L 86.2 54.0
L 86.2 50.2
L 82.0 50.2
L 82.0 54.0
L 80.9 54.0
L 80.9 45.8
' fill='#FF0000'/>
<path class='atom-2' d='M 89.0 49.9
Q 89.0 47.9, 89.9 46.8
Q 90.9 45.7, 92.7 45.7
Q 94.6 45.7, 95.5 46.8
Q 96.5 47.9, 96.5 49.9
Q 96.5 51.9, 95.5 53.0
Q 94.5 54.1, 92.7 54.1
Q 90.9 54.1, 89.9 53.0
Q 89.0 51.9, 89.0 49.9
M 92.7 53.2
Q 94.0 53.2, 94.7 52.4
Q 95.3 51.5, 95.3 49.9
Q 95.3 48.3, 94.7 47.5
Q 94.0 46.6, 92.7 46.6
Q 91.5 46.6, 90.8 47.5
Q 90.1 48.3, 90.1 49.9
Q 90.1 51.6, 90.8 52.4
Q 91.5 53.2, 92.7 53.2
' fill='#FF0000'/>
<path class='note' d='M 139.5 16.4
Q 138.8 16.4, 138.4 15.8
Q 138.0 15.3, 138.0 14.3
Q 138.0 13.3, 138.4 12.8
Q 138.8 12.2, 139.5 12.2
Q 140.3 12.2, 140.7 12.8
Q 141.0 13.3, 141.0 14.3
Q 141.0 15.3, 140.7 15.8
Q 140.3 16.4, 139.5 16.4
M 139.5 15.9
Q 140.0 15.9, 140.2 15.5
Q 140.5 15.1, 140.5 14.3
Q 140.5 13.5, 140.2 13.1
Q 140.0 12.7, 139.5 12.7
Q 139.1 12.7, 138.8 13.1
Q 138.6 13.5, 138.6 14.3
Q 138.6 15.1, 138.8 15.5
Q 139.1 15.9, 139.5 15.9
' fill='#000000'/>
<path class='note' d='M 118.5 54.5
L 119.4 54.5
L 119.4 51.4
L 118.4 51.7
L 118.2 51.4
L 119.5 50.8
L 119.9 50.9
L 119.9 54.5
L 120.7 54.5
L 120.7 54.9
L 118.5 54.9
L 118.5 54.5
' fill='#000000'/>
<path class='note' d='M 86.2 40.5
Q 86.3 40.1, 86.7 39.9
Q 87.0 39.6, 87.5 39.6
Q 88.2 39.6, 88.5 40.0
Q 88.9 40.3, 88.9 40.9
Q 88.9 41.5, 88.4 42.1
Q 88.0 42.7, 87.0 43.3
L 88.9 43.3
L 88.9 43.8
L 86.2 43.8
L 86.2 43.4
Q 86.9 42.9, 87.4 42.5
Q 87.8 42.1, 88.1 41.7
Q 88.3 41.3, 88.3 40.9
Q 88.3 40.6, 88.1 40.3
Q 87.9 40.1, 87.5 40.1
Q 87.2 40.1, 87.0 40.2
Q 86.8 40.4, 86.6 40.7
L 86.2 40.5
' fill='#000000'/>
<path class='note' d='M 135.7 77.2
Q 136.1 77.3, 136.3 77.6
Q 136.5 77.9, 136.5 78.3
Q 136.5 78.6, 136.3 78.9
Q 136.1 79.2, 135.8 79.3
Q 135.5 79.4, 135.1 79.4
Q 134.6 79.4, 134.3 79.3
Q 134.0 79.1, 133.7 78.8
L 134.0 78.5
Q 134.3 78.8, 134.5 78.9
Q 134.7 79.0, 135.1 79.0
Q 135.4 79.0, 135.7 78.8
Q 135.9 78.6, 135.9 78.3
Q 135.9 77.8, 135.6 77.7
Q 135.4 77.5, 134.9 77.5
L 134.6 77.5
L 134.6 77.0
L 134.9 77.0
Q 135.3 77.0, 135.6 76.9
Q 135.8 76.7, 135.8 76.3
Q 135.8 76.0, 135.6 75.9
Q 135.4 75.7, 135.1 75.7
Q 134.7 75.7, 134.5 75.8
Q 134.3 75.9, 134.1 76.3
L 133.7 76.0
Q 133.9 75.7, 134.2 75.5
Q 134.6 75.2, 135.1 75.2
Q 135.7 75.2, 136.0 75.5
Q 136.4 75.8, 136.4 76.3
Q 136.4 76.6, 136.2 76.9
Q 136.0 77.1, 135.7 77.2
' fill='#000000'/>
<path class='note' d='M 165.1 76.7
L 165.6 76.7
L 165.6 77.1
L 165.1 77.1
L 165.1 78.1
L 164.6 78.1
L 164.6 77.1
L 162.5 77.1
L 162.5 76.8
L 164.3 74.0
L 165.1 74.0
L 165.1 76.7
M 163.1 76.7
L 164.6 76.7
L 164.6 74.3
L 163.1 76.7
' fill='#000000'/>
<path class='note' d='M 179.7 100.0
Q 180.1 100.0, 180.4 100.1
Q 180.7 100.3, 180.9 100.6
Q 181.0 100.8, 181.0 101.2
Q 181.0 101.7, 180.8 102.0
Q 180.6 102.3, 180.3 102.4
Q 179.9 102.6, 179.6 102.6
Q 179.2 102.6, 178.8 102.4
Q 178.5 102.3, 178.3 102.0
L 178.6 101.7
Q 178.8 101.9, 179.1 102.0
Q 179.3 102.1, 179.6 102.1
Q 179.9 102.1, 180.2 101.9
Q 180.4 101.7, 180.4 101.2
Q 180.4 100.8, 180.2 100.6
Q 179.9 100.4, 179.5 100.4
Q 179.2 100.4, 178.8 100.5
L 178.5 100.4
L 178.7 98.4
L 180.8 98.4
L 180.7 98.9
L 179.1 98.9
L 179.0 100.1
Q 179.4 100.0, 179.7 100.0
' fill='#000000'/>
<path class='note' d='M 213.2 90.1
Q 213.6 90.1, 213.9 90.3
Q 214.2 90.4, 214.3 90.7
Q 214.5 91.0, 214.5 91.4
Q 214.5 91.8, 214.3 92.1
Q 214.1 92.4, 213.8 92.6
Q 213.5 92.7, 213.1 92.7
Q 212.4 92.7, 212.0 92.2
Q 211.6 91.7, 211.6 90.8
Q 211.6 89.7, 212.1 89.1
Q 212.6 88.5, 213.4 88.5
Q 213.7 88.5, 213.9 88.6
Q 214.1 88.7, 214.3 88.8
L 214.1 89.2
Q 213.8 89.0, 213.4 89.0
Q 212.9 89.0, 212.6 89.4
Q 212.3 89.7, 212.2 90.5
Q 212.4 90.3, 212.7 90.2
Q 213.0 90.1, 213.2 90.1
M 213.1 92.3
Q 213.3 92.3, 213.5 92.1
Q 213.7 92.0, 213.8 91.8
Q 213.9 91.6, 213.9 91.4
Q 213.9 91.0, 213.7 90.8
Q 213.5 90.6, 213.1 90.6
Q 212.9 90.6, 212.6 90.7
Q 212.4 90.8, 212.2 91.0
Q 212.3 91.6, 212.5 92.0
Q 212.7 92.3, 213.1 92.3
' fill='#000000'/>
<path class='note' d='M 225.0 122.0
L 222.8 122.0
L 222.8 121.6
L 225.6 121.6
L 225.6 122.0
L 223.9 125.7
L 223.4 125.7
L 225.0 122.0
' fill='#000000'/>
<path class='note' d='M 260.9 117.7
Q 261.2 117.9, 261.5 118.1
Q 261.7 118.4, 261.7 118.8
Q 261.7 119.1, 261.5 119.4
Q 261.3 119.7, 261.0 119.8
Q 260.7 120.0, 260.3 120.0
Q 259.6 120.0, 259.2 119.7
Q 258.8 119.3, 258.8 118.8
Q 258.8 118.5, 259.0 118.2
Q 259.1 118.0, 259.5 117.8
Q 259.2 117.6, 259.1 117.4
Q 258.9 117.2, 258.9 116.8
Q 258.9 116.3, 259.3 116.1
Q 259.6 115.8, 260.2 115.8
Q 260.8 115.8, 261.2 116.1
Q 261.5 116.3, 261.5 116.8
Q 261.5 117.1, 261.4 117.3
Q 261.2 117.6, 260.9 117.7
M 260.2 116.2
Q 259.9 116.2, 259.7 116.4
Q 259.5 116.5, 259.5 116.8
Q 259.5 117.0, 259.6 117.2
Q 259.8 117.3, 259.9 117.4
Q 260.1 117.5, 260.5 117.6
Q 260.7 117.4, 260.8 117.2
Q 260.9 117.1, 260.9 116.8
Q 260.9 116.5, 260.8 116.4
Q 260.6 116.2, 260.2 116.2
M 260.3 119.5
Q 260.6 119.5, 260.9 119.3
Q 261.1 119.1, 261.1 118.8
Q 261.1 118.6, 261.0 118.4
Q 260.9 118.3, 260.7 118.2
Q 260.5 118.1, 260.2 118.0
L 259.9 117.9
Q 259.6 118.1, 259.5 118.3
Q 259.4 118.5, 259.4 118.8
Q 259.4 119.1, 259.6 119.3
Q 259.8 119.5, 260.3 119.5
' fill='#000000'/>
<path class='note' d='M 266.1 86.2
Q 266.9 86.2, 267.2 86.7
Q 267.6 87.2, 267.6 88.2
Q 267.6 89.2, 267.1 89.8
Q 266.7 90.4, 265.8 90.4
Q 265.6 90.4, 265.3 90.3
Q 265.1 90.3, 264.9 90.1
L 265.1 89.7
Q 265.4 89.9, 265.8 89.9
Q 266.4 89.9, 266.7 89.5
Q 267.0 89.2, 267.0 88.4
Q 266.8 88.6, 266.5 88.7
Q 266.3 88.8, 266.0 88.8
Q 265.6 88.8, 265.3 88.6
Q 265.1 88.5, 264.9 88.2
Q 264.7 87.9, 264.7 87.5
Q 264.7 87.1, 264.9 86.8
Q 265.1 86.5, 265.4 86.4
Q 265.7 86.2, 266.1 86.2
M 265.3 87.5
Q 265.3 87.9, 265.5 88.1
Q 265.7 88.3, 266.1 88.3
Q 266.3 88.3, 266.6 88.2
Q 266.8 88.1, 267.0 87.9
Q 267.0 87.3, 266.8 87.0
Q 266.6 86.7, 266.1 86.7
Q 265.9 86.7, 265.7 86.8
Q 265.5 86.9, 265.4 87.1
Q 265.3 87.3, 265.3 87.5
' fill='#000000'/>
<path class='note' d='M 299.3 94.9
L 300.2 94.9
L 300.2 91.8
L 299.2 92.1
L 299.0 91.8
L 300.3 91.2
L 300.7 91.3
L 300.7 94.9
L 301.5 94.9
L 301.5 95.3
L 299.3 95.3
L 299.3 94.9
' fill='#000000'/>
<path class='note' d='M 303.5 95.4
Q 302.8 95.4, 302.4 94.8
Q 302.0 94.3, 302.0 93.3
Q 302.0 92.3, 302.4 91.7
Q 302.8 91.2, 303.5 91.2
Q 304.3 91.2, 304.7 91.7
Q 305.0 92.3, 305.0 93.3
Q 305.0 94.3, 304.6 94.8
Q 304.3 95.4, 303.5 95.4
M 303.5 94.9
Q 304.0 94.9, 304.2 94.5
Q 304.4 94.1, 304.4 93.3
Q 304.4 92.5, 304.2 92.1
Q 304.0 91.7, 303.5 91.7
Q 303.1 91.7, 302.8 92.1
Q 302.6 92.5, 302.6 93.3
Q 302.6 94.1, 302.8 94.5
Q 303.1 94.9, 303.5 94.9
' fill='#000000'/>
<path class='note' d='M 299.0 67.3
L 299.9 67.3
L 299.9 64.3
L 298.9 64.6
L 298.7 64.2
L 300.0 63.7
L 300.4 63.7
L 300.4 67.3
L 301.2 67.3
L 301.2 67.8
L 299.0 67.8
L 299.0 67.3
' fill='#000000'/>
<path class='note' d='M 301.9 67.3
L 302.8 67.3
L 302.8 64.3
L 301.8 64.6
L 301.7 64.2
L 303.0 63.7
L 303.4 63.7
L 303.4 67.3
L 304.2 67.3
L 304.2 67.8
L 301.9 67.8
L 301.9 67.3
' fill='#000000'/>
<path class='note' d='M 293.3 52.1
L 294.2 52.1
L 294.2 49.1
L 293.2 49.4
L 293.1 49.0
L 294.3 48.5
L 294.7 48.5
L 294.7 52.1
L 295.5 52.1
L 295.5 52.6
L 293.3 52.6
L 293.3 52.1
' fill='#000000'/>
<path class='note' d='M 296.1 49.3
Q 296.2 48.9, 296.6 48.7
Q 296.9 48.4, 297.4 48.4
Q 298.0 48.4, 298.4 48.8
Q 298.7 49.1, 298.7 49.7
Q 298.7 50.3, 298.3 50.9
Q 297.8 51.5, 296.9 52.1
L 298.8 52.1
L 298.8 52.6
L 296.0 52.6
L 296.0 52.2
Q 296.8 51.7, 297.3 51.3
Q 297.7 50.9, 297.9 50.5
Q 298.2 50.1, 298.2 49.7
Q 298.2 49.4, 298.0 49.1
Q 297.8 48.9, 297.4 48.9
Q 297.1 48.9, 296.9 49.0
Q 296.7 49.2, 296.5 49.5
L 296.1 49.3
' fill='#000000'/>
<path class='note' d='M 303.6 12.7
L 304.5 12.7
L 304.5 9.6
L 303.5 9.9
L 303.4 9.6
L 304.7 9.0
L 305.1 9.1
L 305.1 12.7
L 305.9 12.7
L 305.9 13.1
L 303.6 13.1
L 303.6 12.7
' fill='#000000'/>
<path class='note' d='M 308.4 11.0
Q 308.8 11.1, 309.0 11.4
Q 309.2 11.6, 309.2 12.0
Q 309.2 12.4, 309.0 12.6
Q 308.8 12.9, 308.5 13.1
Q 308.2 13.2, 307.7 13.2
Q 307.3 13.2, 307.0 13.0
Q 306.7 12.9, 306.4 12.6
L 306.7 12.2
Q 307.0 12.5, 307.2 12.6
Q 307.4 12.7, 307.7 12.7
Q 308.1 12.7, 308.3 12.5
Q 308.6 12.3, 308.6 12.0
Q 308.6 11.6, 308.3 11.4
Q 308.1 11.2, 307.6 11.2
L 307.3 11.2
L 307.3 10.8
L 307.6 10.8
Q 308.0 10.8, 308.2 10.6
Q 308.5 10.4, 308.5 10.0
Q 308.5 9.8, 308.3 9.6
Q 308.1 9.5, 307.8 9.5
Q 307.4 9.5, 307.2 9.6
Q 307.0 9.7, 306.8 10.0
L 306.4 9.8
Q 306.6 9.4, 306.9 9.2
Q 307.3 9.0, 307.8 9.0
Q 308.4 9.0, 308.7 9.3
Q 309.1 9.6, 309.1 10.0
Q 309.1 10.4, 308.9 10.6
Q 308.7 10.8, 308.4 11.0
' fill='#000000'/>
<path class='note' d='M 337.2 11.2
L 338.1 11.2
L 338.1 8.1
L 337.1 8.4
L 337.0 8.1
L 338.3 7.5
L 338.7 7.6
L 338.7 11.2
L 339.5 11.2
L 339.5 11.6
L 337.2 11.6
L 337.2 11.2
' fill='#000000'/>
<path class='note' d='M 342.7 10.2
L 343.2 10.2
L 343.2 10.7
L 342.7 10.7
L 342.7 11.6
L 342.1 11.6
L 342.1 10.7
L 340.0 10.7
L 340.0 10.3
L 341.8 7.5
L 342.7 7.5
L 342.7 10.2
M 340.7 10.2
L 342.1 10.2
L 342.1 7.9
L 340.7 10.2
' fill='#000000'/>
<path class='note' d='M 355.6 39.7
L 356.5 39.7
L 356.5 36.6
L 355.5 36.9
L 355.4 36.6
L 356.7 36.0
L 357.1 36.1
L 357.1 39.7
L 357.9 39.7
L 357.9 40.1
L 355.6 40.1
L 355.6 39.7
' fill='#000000'/>
<path class='note' d='M 359.9 37.6
Q 360.2 37.6, 360.5 37.7
Q 360.8 37.9, 361.0 38.2
Q 361.2 38.5, 361.2 38.8
Q 361.2 39.3, 360.9 39.6
Q 360.7 39.9, 360.4 40.0
Q 360.1 40.2, 359.7 40.2
Q 359.3 40.2, 359.0 40.1
Q 358.6 39.9, 358.4 39.6
L 358.7 39.3
Q 358.9 39.5, 359.2 39.6
Q 359.4 39.7, 359.7 39.7
Q 360.1 39.7, 360.3 39.5
Q 360.6 39.3, 360.6 38.9
Q 360.6 38.4, 360.3 38.2
Q 360.1 38.0, 359.7 38.0
Q 359.3 38.0, 358.9 38.2
L 358.6 38.0
L 358.8 36.0
L 360.9 36.0
L 360.8 36.5
L 359.3 36.5
L 359.1 37.7
Q 359.5 37.6, 359.9 37.6
' fill='#000000'/>
<path class='note' d='M 333.5 62.7
L 334.4 62.7
L 334.4 59.6
L 333.5 59.9
L 333.3 59.6
L 334.6 59.0
L 335.0 59.1
L 335.0 62.7
L 335.8 62.7
L 335.8 63.2
L 333.5 63.2
L 333.5 62.7
' fill='#000000'/>
<path class='note' d='M 337.9 60.6
Q 338.3 60.6, 338.6 60.8
Q 338.8 60.9, 339.0 61.2
Q 339.2 61.5, 339.2 61.8
Q 339.2 62.2, 339.0 62.6
Q 338.8 62.9, 338.5 63.0
Q 338.2 63.2, 337.8 63.2
Q 337.0 63.2, 336.7 62.7
Q 336.3 62.2, 336.3 61.2
Q 336.3 60.1, 336.8 59.6
Q 337.2 59.0, 338.1 59.0
Q 338.4 59.0, 338.6 59.1
Q 338.8 59.1, 339.0 59.2
L 338.8 59.6
Q 338.5 59.5, 338.1 59.5
Q 337.5 59.5, 337.2 59.9
Q 336.9 60.2, 336.9 61.0
Q 337.1 60.8, 337.4 60.7
Q 337.6 60.6, 337.9 60.6
M 337.8 62.7
Q 338.0 62.7, 338.2 62.6
Q 338.4 62.5, 338.5 62.3
Q 338.6 62.1, 338.6 61.8
Q 338.6 61.5, 338.4 61.3
Q 338.2 61.1, 337.8 61.1
Q 337.6 61.1, 337.3 61.2
Q 337.1 61.3, 336.9 61.4
Q 336.9 62.1, 337.1 62.4
Q 337.3 62.7, 337.8 62.7
' fill='#000000'/>
<path class='note' d='M 363.7 78.9
L 364.6 78.9
L 364.6 75.9
L 363.6 76.2
L 363.4 75.8
L 364.7 75.3
L 365.1 75.3
L 365.1 78.9
L 365.9 78.9
L 365.9 79.4
L 363.7 79.4
L 363.7 78.9
' fill='#000000'/>
<path class='note' d='M 368.6 75.8
L 366.4 75.8
L 366.4 75.3
L 369.1 75.3
L 369.1 75.7
L 367.5 79.4
L 366.9 79.4
L 368.6 75.8
' fill='#000000'/>
<path class='note' d='M 328.8 93.8
L 329.7 93.8
L 329.7 90.7
L 328.7 91.0
L 328.6 90.7
L 329.8 90.1
L 330.2 90.2
L 330.2 93.8
L 331.1 93.8
L 331.1 94.2
L 328.8 94.2
L 328.8 93.8
' fill='#000000'/>
<path class='note' d='M 333.7 92.1
Q 334.0 92.2, 334.3 92.5
Q 334.5 92.7, 334.5 93.1
Q 334.5 93.4, 334.3 93.7
Q 334.1 94.0, 333.8 94.1
Q 333.5 94.3, 333.0 94.3
Q 332.4 94.3, 332.0 94.0
Q 331.6 93.7, 331.6 93.1
Q 331.6 92.8, 331.7 92.5
Q 331.9 92.3, 332.3 92.1
Q 332.0 91.9, 331.9 91.7
Q 331.7 91.5, 331.7 91.1
Q 331.7 90.6, 332.1 90.4
Q 332.4 90.1, 333.0 90.1
Q 333.6 90.1, 334.0 90.4
Q 334.3 90.6, 334.3 91.1
Q 334.3 91.4, 334.1 91.7
Q 334.0 91.9, 333.7 92.1
M 333.0 90.5
Q 332.7 90.5, 332.5 90.7
Q 332.3 90.8, 332.3 91.1
Q 332.3 91.3, 332.4 91.5
Q 332.6 91.6, 332.7 91.7
Q 332.9 91.8, 333.3 91.9
Q 333.5 91.7, 333.6 91.5
Q 333.7 91.4, 333.7 91.1
Q 333.7 90.8, 333.5 90.7
Q 333.4 90.5, 333.0 90.5
M 333.0 93.8
Q 333.4 93.8, 333.7 93.6
Q 333.9 93.4, 333.9 93.1
Q 333.9 92.9, 333.8 92.7
Q 333.6 92.6, 333.5 92.5
Q 333.3 92.4, 333.0 92.3
L 332.7 92.2
Q 332.4 92.4, 332.3 92.6
Q 332.1 92.8, 332.1 93.1
Q 332.1 93.4, 332.4 93.6
Q 332.6 93.8, 333.0 93.8
' fill='#000000'/>
<path class='note' d='M 263.6 38.9
L 264.5 38.9
L 264.5 35.9
L 263.5 36.2
L 263.4 35.8
L 264.7 35.3
L 265.1 35.3
L 265.1 38.9
L 265.9 38.9
L 265.9 39.4
L 263.6 39.4
L 263.6 38.9
' fill='#000000'/>
<path class='note' d='M 267.8 35.3
Q 268.5 35.3, 268.9 35.7
Q 269.2 36.2, 269.2 37.2
Q 269.2 38.3, 268.8 38.9
Q 268.3 39.4, 267.5 39.4
Q 267.2 39.4, 267.0 39.4
Q 266.8 39.3, 266.6 39.2
L 266.8 38.8
Q 267.1 39.0, 267.5 39.0
Q 268.0 39.0, 268.3 38.6
Q 268.6 38.2, 268.7 37.5
Q 268.5 37.7, 268.2 37.8
Q 267.9 37.9, 267.6 37.9
Q 267.3 37.9, 267.0 37.7
Q 266.7 37.5, 266.6 37.3
Q 266.4 37.0, 266.4 36.6
Q 266.4 36.2, 266.6 35.9
Q 266.8 35.6, 267.1 35.4
Q 267.4 35.3, 267.8 35.3
M 267.0 36.6
Q 267.0 37.0, 267.2 37.2
Q 267.4 37.4, 267.7 37.4
Q 268.0 37.4, 268.2 37.3
Q 268.5 37.2, 268.7 37.0
Q 268.6 36.3, 268.4 36.0
Q 268.2 35.7, 267.8 35.7
Q 267.6 35.7, 267.4 35.8
Q 267.2 36.0, 267.1 36.2
Q 267.0 36.4, 267.0 36.6
' fill='#000000'/>
<path class='note' d='M 271.9 138.6
Q 272.0 138.3, 272.4 138.0
Q 272.8 137.8, 273.2 137.8
Q 273.9 137.8, 274.2 138.2
Q 274.6 138.5, 274.6 139.1
Q 274.6 139.7, 274.1 140.3
Q 273.7 140.8, 272.7 141.5
L 274.6 141.5
L 274.6 142.0
L 271.9 142.0
L 271.9 141.6
Q 272.6 141.0, 273.1 140.6
Q 273.5 140.2, 273.8 139.9
Q 274.0 139.5, 274.0 139.1
Q 274.0 138.7, 273.8 138.5
Q 273.6 138.3, 273.2 138.3
Q 272.9 138.3, 272.7 138.4
Q 272.5 138.6, 272.3 138.9
L 271.9 138.6
' fill='#000000'/>
<path class='note' d='M 276.8 142.0
Q 276.0 142.0, 275.6 141.5
Q 275.3 140.9, 275.3 139.9
Q 275.3 138.9, 275.6 138.4
Q 276.0 137.8, 276.8 137.8
Q 277.5 137.8, 277.9 138.4
Q 278.3 138.9, 278.3 139.9
Q 278.3 140.9, 277.9 141.5
Q 277.5 142.0, 276.8 142.0
M 276.8 141.6
Q 277.2 141.6, 277.5 141.1
Q 277.7 140.7, 277.7 139.9
Q 277.7 139.1, 277.5 138.7
Q 277.2 138.3, 276.8 138.3
Q 276.3 138.3, 276.1 138.7
Q 275.9 139.1, 275.9 139.9
Q 275.9 140.7, 276.1 141.1
Q 276.3 141.6, 276.8 141.6
' fill='#000000'/>
<path class='note' d='M 181.0 47.0
Q 181.2 46.6, 181.5 46.4
Q 181.9 46.2, 182.4 46.2
Q 183.0 46.2, 183.4 46.5
Q 183.7 46.8, 183.7 47.4
Q 183.7 48.0, 183.2 48.6
Q 182.8 49.2, 181.9 49.9
L 183.8 49.9
L 183.8 50.3
L 181.0 50.3
L 181.0 49.9
Q 181.8 49.4, 182.2 49.0
Q 182.7 48.6, 182.9 48.2
Q 183.1 47.8, 183.1 47.5
Q 183.1 47.1, 182.9 46.8
Q 182.7 46.6, 182.4 46.6
Q 182.1 46.6, 181.8 46.8
Q 181.6 46.9, 181.5 47.2
L 181.0 47.0
' fill='#000000'/>
<path class='note' d='M 184.6 49.9
L 185.5 49.9
L 185.5 46.8
L 184.5 47.1
L 184.4 46.8
L 185.6 46.2
L 186.1 46.3
L 186.1 49.9
L 186.9 49.9
L 186.9 50.3
L 184.6 50.3
L 184.6 49.9
' fill='#000000'/>
<path class='note' d='M 149.1 78.8
Q 149.1 78.0, 149.4 77.3
Q 149.6 76.6, 150.1 75.9
L 150.4 76.1
Q 150.0 76.8, 149.8 77.4
Q 149.7 78.0, 149.7 78.8
Q 149.7 79.6, 149.8 80.2
Q 150.0 80.8, 150.4 81.6
L 150.1 81.8
Q 149.6 81.0, 149.4 80.3
Q 149.1 79.7, 149.1 78.8
' fill='#7F7FFF'/>
<path class='note' d='M 150.7 76.4
L 153.2 76.4
L 153.2 76.8
L 151.3 76.8
L 151.3 78.1
L 153.0 78.1
L 153.0 78.6
L 151.3 78.6
L 151.3 80.0
L 153.2 80.0
L 153.2 80.5
L 150.7 80.5
L 150.7 76.4
' fill='#7F7FFF'/>
<path class='note' d='M 155.0 78.8
Q 155.0 79.7, 154.7 80.3
Q 154.5 81.0, 154.0 81.8
L 153.7 81.6
Q 154.1 80.8, 154.2 80.2
Q 154.4 79.6, 154.4 78.8
Q 154.4 78.0, 154.2 77.4
Q 154.1 76.8, 153.7 76.1
L 154.0 75.9
Q 154.5 76.6, 154.7 77.3
Q 155.0 78.0, 155.0 78.8
' fill='#7F7FFF'/>
<path class='note' d='M 193.7 102.0
Q 193.7 101.1, 193.9 100.5
Q 194.2 99.8, 194.6 99.0
L 195.0 99.2
Q 194.6 99.9, 194.4 100.6
Q 194.2 101.2, 194.2 102.0
Q 194.2 102.8, 194.4 103.4
Q 194.6 104.0, 195.0 104.7
L 194.6 104.9
Q 194.2 104.2, 193.9 103.5
Q 193.7 102.8, 193.7 102.0
' fill='#7F7FFF'/>
<path class='note' d='M 195.3 99.5
L 197.7 99.5
L 197.7 100.0
L 195.8 100.0
L 195.8 101.2
L 197.5 101.2
L 197.5 101.7
L 195.8 101.7
L 195.8 103.2
L 197.8 103.2
L 197.8 103.6
L 195.3 103.6
L 195.3 99.5
' fill='#7F7FFF'/>
<path class='note' d='M 199.5 102.0
Q 199.5 102.8, 199.3 103.5
Q 199.0 104.2, 198.6 104.9
L 198.2 104.7
Q 198.6 104.0, 198.8 103.4
Q 199.0 102.8, 199.0 102.0
Q 199.0 101.2, 198.8 100.6
Q 198.6 99.9, 198.2 99.2
L 198.6 99.0
Q 199.0 99.8, 199.3 100.5
Q 199.5 101.1, 199.5 102.0
' fill='#7F7FFF'/>
<path class='note' d='M 238.1 125.1
Q 238.1 124.3, 238.4 123.6
Q 238.6 122.9, 239.1 122.2
L 239.4 122.4
Q 239.0 123.1, 238.8 123.7
Q 238.7 124.3, 238.7 125.1
Q 238.7 125.9, 238.8 126.5
Q 239.0 127.2, 239.4 127.9
L 239.1 128.1
Q 238.6 127.3, 238.4 126.7
Q 238.1 126.0, 238.1 125.1
' fill='#7F7FFF'/>
<path class='note' d='M 239.7 126.4
L 241.8 123.2
L 239.8 123.2
L 239.8 122.7
L 242.5 122.7
L 242.5 123.1
L 240.4 126.3
L 242.5 126.3
L 242.5 126.8
L 239.7 126.8
L 239.7 126.4
' fill='#7F7FFF'/>
<path class='note' d='M 244.2 125.1
Q 244.2 126.0, 244.0 126.7
Q 243.7 127.3, 243.3 128.1
L 242.9 127.9
Q 243.3 127.2, 243.5 126.5
Q 243.7 125.9, 243.7 125.1
Q 243.7 124.3, 243.5 123.7
Q 243.3 123.1, 242.9 122.4
L 243.3 122.2
Q 243.7 122.9, 244.0 123.6
Q 244.2 124.3, 244.2 125.1
' fill='#7F7FFF'/>
<path class='note' d='M 280.1 86.5
Q 280.1 85.7, 280.3 85.0
Q 280.6 84.3, 281.0 83.6
L 281.4 83.8
Q 281.0 84.5, 280.8 85.1
Q 280.6 85.7, 280.6 86.5
Q 280.6 87.3, 280.8 87.9
Q 281.0 88.6, 281.4 89.3
L 281.0 89.5
Q 280.6 88.7, 280.3 88.1
Q 280.1 87.4, 280.1 86.5
' fill='#7F7FFF'/>
<path class='note' d='M 281.7 84.1
L 284.1 84.1
L 284.1 84.6
L 282.2 84.6
L 282.2 85.8
L 283.9 85.8
L 283.9 86.3
L 282.2 86.3
L 282.2 87.7
L 284.2 87.7
L 284.2 88.2
L 281.7 88.2
L 281.7 84.1
' fill='#7F7FFF'/>
<path class='note' d='M 285.9 86.5
Q 285.9 87.4, 285.7 88.1
Q 285.4 88.7, 285.0 89.5
L 284.6 89.3
Q 285.0 88.6, 285.2 87.9
Q 285.4 87.3, 285.4 86.5
Q 285.4 85.7, 285.2 85.1
Q 285.0 84.5, 284.6 83.8
L 285.0 83.6
Q 285.4 84.3, 285.7 85.0
Q 285.9 85.7, 285.9 86.5
' fill='#7F7FFF'/>
</svg>
</div></div>
</div>
</section>
<section id="counting-and-generating-isomers">
<span id="id8"></span><h3>15.3.2 Counting and Generating Isomers<a class="headerlink" href="#counting-and-generating-isomers" title="Link to this heading">#</a></h3>
<p>Another interesting feature of RDKit is the ability to determine the number of stereoisomers possible for a given structure and to generate the different isomers. In both these applications, RDKit treats any explicitly assigned stereocenter as fixed and will not allow it to be changed. For example, below we will again look at (2<em>S</em>, 3<em>E</em>)-pent-3-en-2-ol. Because the structure already designates this as the (2<em>S</em>, 3<em>E</em>) isomer, the stereochemistry of the chiral center and alkene cannot be changed. As a result, when using the <code class="docutils literal notranslate"><span class="pre">GetStereoisomerCount()</span></code> method from the <code class="docutils literal notranslate"><span class="pre">EnumerateStereoisomers</span></code> module, it returns a <code class="docutils literal notranslate"><span class="pre">1</span></code> indicating that there is only one stereoisomer possible with these constraints.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">GetStereoisomerCount</span><span class="p">(</span><span class="n">pentenol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>In contrast, if we provide the <code class="docutils literal notranslate"><span class="pre">GetStereoisomerCount()</span></code> function hexan-2-ol without any stereochemistry designated (see <a class="reference internal" href="#id6"><span class="std std-ref">above</span></a>), it returns <code class="docutils literal notranslate"><span class="pre">2</span></code> as the number of stereoisomers. This is because (<em>S</em>)-hexan-2-ol and (<em>R</em>)-hexan-2-ol are both possible isomers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hexanol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;OC(C)CCCC&#39;</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">GetStereoisomerCount</span><span class="p">(</span><span class="n">hexanol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">EnumerateStereoisomers</span></code> module can also generate the different possible isomers, and again, it will only generate isomers by changing stereochemical features that do not already have assigned configurations. If we again look at hexan-2-ol, it generates two Molecule objects which are the two isomers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isomers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="p">(</span><span class="n">hexanol</span><span class="p">))</span>
<span class="n">isomers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;rdkit.Chem.rdchem.Mol at 0x1203ae200&gt;,
 &lt;rdkit.Chem.rdchem.Mol at 0x1203ae430&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPythonConsole</span><span class="o">.</span><span class="n">drawOptions</span><span class="o">.</span><span class="n">addAtomIndices</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">IPythonConsole</span><span class="o">.</span><span class="n">drawOptions</span><span class="o">.</span><span class="n">addStereoAnnotation</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">isomers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/53b6dd508d331ccbfaa898f26e1f679ca6913d4bed8c8c6c654cd13e704bad9d.svg" src="../../_images/53b6dd508d331ccbfaa898f26e1f679ca6913d4bed8c8c6c654cd13e704bad9d.svg" />
</div>
</div>
<p>As a more challenging example, arabinos has three chiral centers allowing for up to eight possible stereoisomers. Because there is a lack of symmetry between the top and bottom (i.e., -CHO and -CH<span class="math notranslate nohighlight">\(_2\)</span>OH are different), no meso compound can exist, so it will have the full eight stereoisomers. The real challenge lies in drawing out all eight… unless we make RDKit do the work for us like below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arabinos</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;O=CC(O)C(O)C(O)CO&#39;</span><span class="p">)</span>
<span class="n">isomers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="p">(</span><span class="n">arabinos</span><span class="p">))</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">isomers</span><span class="p">,</span> <span class="n">useSVG</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/27267a536df9d17e2b5a9d5d6f4776d533cb398dc3caf49df98c8fa653e00539.svg" src="../../_images/27267a536df9d17e2b5a9d5d6f4776d533cb398dc3caf49df98c8fa653e00539.svg" />
</div>
</div>
<p>While the examples above mainly focus on stereoisomers from tetrahedral chiral centers, this also works with <em>E/Z</em> stereoisomers. One limitation with RDKit is that it currently struggles to recognize non-alkene <em>cis/trans</em> stereoisomers when there are stereocenters that are not chiral centers involved such as rings (see <a class="reference external" href="https://github.com/rdkit/rdkit/issues/5597">GitHub issue 5597</a>). For example, with 1,2,3-trimethylcyclopropane, it only believes there are eight stereoisomers when in fact there are two.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A chiral center is a specific example of stereogenic center that is an sp<span class="math notranslate nohighlight">\(^3\)</span> atom with four different substituents whereas a stereogenic center is any atom where exchanging any two substituents/ligands produces a different stereoisomer. For example, 1,4-dimethylcyclohexane has two stereogenic centers (yields <em>cis</em> versus <em>trans</em>) but no chiral centers.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TriCProp</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CC1C(C1C)C &#39;</span><span class="p">)</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">GetStereoisomerCount</span><span class="p">(</span><span class="n">TriCProp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
</div>
</div>
<p>In contrast, it has no difficulty identifying the three isomers for 1,2-dimethylcyclopropane because both methylated carbons are chiral centers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DiCProp</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CC1CC1C&#39;</span><span class="p">)</span>
<span class="n">CPropisomers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="o">.</span><span class="n">EnumerateStereoisomers</span><span class="p">(</span><span class="n">DiCProp</span><span class="p">))</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">CPropisomers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7162b4df8e670677221b6369062885825757c11dfdb72e1f0eb0420ef268b074.svg" src="../../_images/7162b4df8e670677221b6369062885825757c11dfdb72e1f0eb0420ef268b074.svg" />
</div>
</div>
</section>
</section>
<section id="chem-descriptor-module">
<span id="id9"></span><h2>15.4 <code class="docutils literal notranslate"><span class="pre">Chem.Descriptor</span></code> Module<a class="headerlink" href="#chem-descriptor-module" title="Link to this heading">#</a></h2>
<p id="index-5"><span id="index-4"></span>RDKit can be use to determine a number of key physical properties of molecules known as <em>descriptors</em> using the <code class="docutils literal notranslate"><span class="pre">Chem.Descriptor</span></code> module. These can be useful for generating features for a large number of molecules for machine learning or understanding structural trends in a body of chemical compounds.</p>
<section id="molecular-features">
<span id="id10"></span><h3>15.4.1 Molecular Features<a class="headerlink" href="#molecular-features" title="Link to this heading">#</a></h3>
<p>There are numerous descriptor functions available which are callable using <code class="docutils literal notranslate"><span class="pre">Chem.Descriptors.method()</span></code> where <code class="docutils literal notranslate"><span class="pre">method()</span></code> is the name of a descriptor function that accepts an RDKit Molecule object and returns a numerical value. Below are a few examples of descriptor functions, with a more complete list is available on the <a class="reference external" href="https://www.rdkit.org/docs/GettingStartedInPython.html#list-of-available-descriptors">RDKit website</a>.</p>
<p><strong>Table 5</strong> Examples of Molecular Descriptors</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">MolWt</span></code></p></td>
<td><p>Molecular weight, assumes natural isotopic distribution</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">HeavyAtomCount()</span></code></p></td>
<td><p>Number of non-hydrogen atoms</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NOCount()</span></code></p></td>
<td><p>Number of N and O atoms</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumAliphaticRings()</span></code></p></td>
<td><p>Number of aliphatic rings</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumAromaticRings()</span></code></p></td>
<td><p>Number of aromatic rings</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumSaturatedRings()</span></code></p></td>
<td><p>Number of saturated rings</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumHAcceptors()</span></code></p></td>
<td><p>Number of hydrogen bond acceptors</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumHDonors()</span></code></p></td>
<td><p>Number of hydrogen bond donors</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumRadicalElectrons()</span></code></p></td>
<td><p>Number of radical electrons</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumValenceElectrons()</span></code></p></td>
<td><p>Number of valence electrons</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">NumRotatableBonds()</span></code></p></td>
<td><p>Number of rotatable bonds</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">RingCount()</span></code></p></td>
<td><p>Number of rings</p></td>
</tr>
</tbody>
</table>
</div>
<p>Below we will look at a few of these descriptor functions demonstrated on the compound paclitaxel. Specifically, we will generate the molecular weight, number of rings, number of aromatic rings, number of valence electrons, and number of rotatable bonds.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If RDKit displays a molecule with sections overlapping, try adding <code class="docutils literal notranslate"><span class="pre">AllChem.Compute2DCoords(mol)</span></code> to your code where <code class="docutils literal notranslate"><span class="pre">mol</span></code> is your Molecule object like is done with paclitaxel.</p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ptx</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CC1=C2[C@@]([C@]([C@H]([C@@H]3[C@]4([C@H](OC4)C[C@@H]&#39;</span>\
                         <span class="s1">&#39;([C@]3(C(=O)[C@@H]2OC(=O)C)C)O)OC(=O)C)OC(=O)c5ccccc5)&#39;</span>\
                         <span class="s1">&#39;(C[C@@H]1OC(=O)[C@H](O)[C@@H](NC(=O)c6ccccc6)c7ccccc7)O)(C)C&#39;</span><span class="p">)</span>

<span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span> <span class="c1"># makes molecule display more clearly</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolToImage</span><span class="p">(</span><span class="n">ptx</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/febac7bbf23fc4d473dc45a5bbaa08a16a59af8e91d8b084e0312f181c8d395b.png" src="../../_images/febac7bbf23fc4d473dc45a5bbaa08a16a59af8e91d8b084e0312f181c8d395b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># molecular weight</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>853.9180000000003
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of rings</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">RingCount</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of aromatic rings</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">NumAromaticRings</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of valence electrons</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">NumValenceElectrons</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>328
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of rotable bonds</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">NumRotatableBonds</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantifying-functional-groups">
<span id="id11"></span><h3>15.4.2 Quantifying Functional Groups<a class="headerlink" href="#quantifying-functional-groups" title="Link to this heading">#</a></h3>
<p>Among the descriptor methods is a long list of functions that look like <code class="docutils literal notranslate"><span class="pre">fr_group()</span></code> where <code class="docutils literal notranslate"><span class="pre">group</span></code> is the name or abbreviation of a chemical functional group. These functions return an integer quantification of that functional group present in the molecule. A table with a few examples is provided below, but there are over 80 of these functions available in RDKit.</p>
<p><strong>Table 6</strong> Examples of Methods to Quantify Functional Groups</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Function</p></th>
<th class="head"><p>Functional Group</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_Al_OH()</span></code></p></td>
<td><p>Aliphatic alcohols</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_aldehyde()</span></code></p></td>
<td><p>Aldehydes</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_amide()</span></code></p></td>
<td><p>Amide</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_C_C()</span></code></p></td>
<td><p>Carbonyl oxygens</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_guanido()</span></code></p></td>
<td><p>Guanidine</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_NH0()</span></code></p></td>
<td><p>Amines with 0 H’s (i.e., tertiary)</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_phenol()</span></code></p></td>
<td><p>Phenol</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_phos_ester()</span></code></p></td>
<td><p>Phosphoric ester</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">fr_SH()</span></code></p></td>
<td><p>Thiol</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To see a complete list of functional groups, type <code class="docutils literal notranslate"><span class="pre">Chem.Descriptors.fr_</span></code> into a code cell, press <strong>Tab</strong> for autocomplete, and see the long list of options. If the functional group is not obvious from the name, place the computer cursor inside the function’s parentheses and press <strong>Shift + Tab</strong> to see the Docstring description of what functional group it quantifies.</p>
</div>
<p>We will again look at paclitaxel to see how many benzene rings, aliphatic alcohols, aromatic carboxyls, and esters are present in the structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of benzene rings</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">fr_benzene</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of alphatic alcohols</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">fr_Al_OH</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of aromatic carboxyls</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">fr_Ar_COO</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># number of esters</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">fr_ester</span><span class="p">(</span><span class="n">ptx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="searching-molecules-for-structural-patterns">
<span id="id12"></span><h2>15.5 Searching Molecules for Structural Patterns<a class="headerlink" href="#searching-molecules-for-structural-patterns" title="Link to this heading">#</a></h2>
<p>Molecules can be searched for key structural features using the <code class="docutils literal notranslate"><span class="pre">HasSubstructMatch()</span></code> method which returns <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> depending if a structural pattern exists in a molecule or not. This function requires two RDKit Molecule objects - one Molecule object (<code class="docutils literal notranslate"><span class="pre">molecule</span></code>) is checked for the presence of the other Molecule object structure (<code class="docutils literal notranslate"><span class="pre">substructure</span></code>) as shown below. There are optional keyword parameters such as <code class="docutils literal notranslate"><span class="pre">useChirality=</span></code> which allows for chirality to be factored into whether there is a match or not. The default setting is <code class="docutils literal notranslate"><span class="pre">useChirality=False</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">,</span> <span class="n">useChirality</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>As an example, we will look for the presence of a carbonyl (i.e., C=O bond) in acetone and pent-3-en-2-ol below, so the substructure that we will search for is a <code class="docutils literal notranslate"><span class="pre">C=O</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acetone</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CC(=O)C&#39;</span><span class="p">)</span>
<span class="n">acetone</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 153.9,142.5 L 225.0,101.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 231.2,105.0 L 231.2,69.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 231.2,69.5 L 231.2,34.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 218.8,105.0 L 218.8,69.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 218.8,69.5 L 218.8,34.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 225.0,101.4 L 296.1,142.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 221.4,103.5 L 225.0,101.4 L 228.6,103.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-2' d='M 214.3 19.3
Q 214.3 13.7, 217.1 10.6
Q 219.8 7.5, 225.0 7.5
Q 230.2 7.5, 232.9 10.6
Q 235.7 13.7, 235.7 19.3
Q 235.7 25.0, 232.9 28.2
Q 230.1 31.4, 225.0 31.4
Q 219.9 31.4, 217.1 28.2
Q 214.3 25.0, 214.3 19.3
M 225.0 28.8
Q 228.5 28.8, 230.5 26.4
Q 232.4 24.0, 232.4 19.3
Q 232.4 14.8, 230.5 12.5
Q 228.5 10.1, 225.0 10.1
Q 221.5 10.1, 219.5 12.4
Q 217.6 14.7, 217.6 19.3
Q 217.6 24.0, 219.5 26.4
Q 221.5 28.8, 225.0 28.8
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">substructure</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;C=O&#39;</span><span class="p">)</span>
<span class="n">acetone</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pentenol</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Not very surprisingly, the <code class="docutils literal notranslate"><span class="pre">HasSubstructMatch()</span></code> function returns <code class="docutils literal notranslate"><span class="pre">True</span></code> for acetone and <code class="docutils literal notranslate"><span class="pre">False</span></code> for the alcohol because the latter has a single CO bond, not a double. If we change our substructure to <code class="docutils literal notranslate"><span class="pre">CO</span></code>, we are now searching for a carbon-oxygen single bond (see Table 7), so acetone returns <code class="docutils literal notranslate"><span class="pre">False</span></code> while pent-3-en-2-ol returns <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p><strong>Table 7</strong> SMILES Bond Order Notation</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>SMILES Bond</p></th>
<th class="head"><p>Bond Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>- (or nothing)</p></td>
<td><p>Single</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>=</p></td>
<td><p>Double</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>#</p></td>
<td><p>Triple</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>:</p></td>
<td><p>Aromatic</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">substructure</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CO&#39;</span><span class="p">)</span>
<span class="n">substructure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 60.1,74.8 L 193.9,74.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 193.9,74.8 L 327.7,74.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='atom-1' d='M 337.3 74.9
Q 337.3 68.1, 340.7 64.3
Q 344.0 60.5, 350.3 60.5
Q 356.6 60.5, 359.9 64.3
Q 363.3 68.1, 363.3 74.9
Q 363.3 81.7, 359.9 85.7
Q 356.5 89.5, 350.3 89.5
Q 344.1 89.5, 340.7 85.7
Q 337.3 81.8, 337.3 74.9
M 350.3 86.3
Q 354.6 86.3, 356.9 83.5
Q 359.3 80.5, 359.3 74.9
Q 359.3 69.3, 356.9 66.5
Q 354.6 63.7, 350.3 63.7
Q 346.0 63.7, 343.6 66.5
Q 341.3 69.3, 341.3 74.9
Q 341.3 80.6, 343.6 83.5
Q 346.0 86.3, 350.3 86.3
' fill='#FF0000'/>
<path class='atom-1' d='M 367.7 60.8
L 371.6 60.8
L 371.6 72.8
L 386.0 72.8
L 386.0 60.8
L 389.9 60.8
L 389.9 89.1
L 386.0 89.1
L 386.0 76.0
L 371.6 76.0
L 371.6 89.1
L 367.7 89.1
L 367.7 60.8
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acetone</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pentenol</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>For a more interesting set of examples, we can search our collection of 20 common amino acids (see <a class="reference internal" href="#id5"><span class="std std-ref">section 15.2.2</span></a>) for key substructures. We will start by using glycine, the simplest of the common amino acids, as the substructure which should return all 20 amino acids. As an extra step below, we will also orient all the amino acids in the same way with respect to the substructure. That is, the substructural element that we are searching for in each amino acid will be oriented the same way for all 20 amino acids.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># seraches for substruture</span>
<span class="n">substructure</span><span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;C(C(=O)[O-])[NH3+]&#39;</span><span class="p">)</span>
<span class="n">matching_amino_acids</span> <span class="o">=</span> <span class="p">[</span><span class="n">AA</span> <span class="k">for</span> <span class="n">AA</span> <span class="ow">in</span> <span class="n">AminoAcids</span> <span class="k">if</span> <span class="n">AA</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)]</span>

<span class="c1"># orients common substructures the same way</span>
<span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">substructure</span><span class="p">)</span>
<span class="k">for</span> <span class="n">amino_acid</span> <span class="ow">in</span> <span class="n">matching_amino_acids</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GenerateDepictionMatching2DStructure</span><span class="p">(</span><span class="n">amino_acid</span><span class="p">,</span> <span class="n">substructure</span><span class="p">)</span>

<span class="c1"># generates grid of matching molecules</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">matching_amino_acids</span><span class="p">,</span> 
                          <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                          <span class="n">subImgSize</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span>
                          <span class="n">legends</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/416e80d172bb2f14bd2e92288fc47254e1f59a4adb8eba8681c300134dc7a8ea.svg" src="../../_images/416e80d172bb2f14bd2e92288fc47254e1f59a4adb8eba8681c300134dc7a8ea.svg" />
</div>
</div>
<p>Indeed, it did return all 20 amino acids, and notice how the core structure of all amino acids are oriented the same direction. Now let us try something a little more interesting by search for all amino acids with a benzene ring in them. The substructural bonding pattern in this case is benzene itself, and the three aromatic amino acids are returned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">substructure</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
<span class="n">AA_with_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">AA</span> <span class="k">for</span> <span class="n">AA</span> <span class="ow">in</span> <span class="n">AminoAcids</span> <span class="k">if</span> <span class="n">AA</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)]</span>

<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">AA_with_pattern</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6ce53a1e464ba85228a70e4cbee6f14ef67a553d00efcaba386188e5baf4d0cd.svg" src="../../_images/6ce53a1e464ba85228a70e4cbee6f14ef67a553d00efcaba386188e5baf4d0cd.svg" />
</div>
</div>
<p>It might be nice to still have the name labels for our three matches, so the above search is repeated but instead on a zip object comprised of the names of the amino acids and the Molecule objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AA_zipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">AminoAcids</span><span class="p">))</span>

<span class="n">substructure</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
<span class="n">with_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">AA</span> <span class="k">for</span> <span class="n">AA</span> <span class="ow">in</span> <span class="n">AA_zipped</span> <span class="k">if</span> <span class="n">AA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">substructure</span><span class="p">)]</span>

<span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">AA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">AA</span> <span class="ow">in</span> <span class="n">with_pattern</span><span class="p">]</span>
<span class="n">mol_obj</span> <span class="o">=</span>  <span class="p">[</span><span class="n">AA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">AA</span> <span class="ow">in</span> <span class="n">with_pattern</span><span class="p">]</span>

<span class="n">Chem</span><span class="o">.</span><span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">mol_obj</span><span class="p">,</span> <span class="n">legends</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a1503e48c6df595a2848d593fbc8df835d53876a318cc8f9e1de505f19979d84.svg" src="../../_images/a1503e48c6df595a2848d593fbc8df835d53876a318cc8f9e1de505f19979d84.svg" />
</div>
</div>
</section>
<section id="atoms-and-bonds">
<span id="id13"></span><h2>15.6 Atoms and Bonds<a class="headerlink" href="#atoms-and-bonds" title="Link to this heading">#</a></h2>
<p>RDKit allows access to information on specific atoms and bonds through the <code class="docutils literal notranslate"><span class="pre">GetAtoms()</span></code> and <code class="docutils literal notranslate"><span class="pre">GetBonds()</span></code> methods, respectively. These functions return a sequence type of object that can be iterated through using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to access individual atoms or bonds. Using the following methods, the user can access or even modify various pieces of information about the atoms or bonds. Below Table 9 and Table 10 contain some key functions for working with atoms and bonds.</p>
<p><strong>Table 9</strong> Select Atom Methods</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetDegree()</span></code></p></td>
<td><p>Returns number of atoms bonded directly to it, includes hydrogens only if they are explicitly defined</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetAtomicNum()</span></code></p></td>
<td><p>Returns atomic number</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetChiralTag()</span></code></p></td>
<td><p>Determines if the atom is a chiral center and CW or CCW designation</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetFormalCharge()</span></code></p></td>
<td><p>Returns formal charage of atom</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetHybridization()</span></code></p></td>
<td><p>Returns hybridization of atom</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetIsAromatic()</span></code></p></td>
<td><p>Returns bool as to whether atom is aromatic</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetIsotope()</span></code></p></td>
<td><p>Returns isotope number if designated, otherwise returns <code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetNeighbors()</span></code></p></td>
<td><p>Returns tuple of directly bonded atoms</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetSymbol()</span></code></p></td>
<td><p>Returns atomic symbols as a string</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetTotalNumHs()</span></code></p></td>
<td><p>Returns number of hydrogens bonded to the atom</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">IsInRing()</span></code></p></td>
<td><p>Returns bool designating if the atom is in a ring</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">SetAtomicNum()</span></code></p></td>
<td><p>Sets the atomic number to user defined value</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">SetFormalCharge()</span></code></p></td>
<td><p>Sets formal charge to user defined value</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">SetIsotope()</span></code></p></td>
<td><p>Sets isotope to user defined integer value</p></td>
</tr>
</tbody>
</table>
</div>
<p>As an example, let’s look at the atoms in aspirin.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspirin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 164.0,50.6 L 167.3,65.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 167.3,65.7 L 170.5,80.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 158.8,51.7 L 162.0,66.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 162.0,66.8 L 165.2,81.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 167.5,79.8 L 140.8,103.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 167.5,79.8 L 181.7,84.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 181.7,84.4 L 195.9,89.0' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 207.6,85.6 L 218.1,76.2' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 218.1,76.2 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 228.5,66.8 L 221.0,31.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 233.1,62.6 L 226.9,33.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 221.0,31.6 L 247.7,7.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 247.7,7.5 L 281.9,18.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 249.0,13.6 L 277.3,22.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 281.9,18.6 L 289.5,53.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 289.5,53.8 L 262.7,77.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 283.5,51.9 L 261.4,71.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 262.7,77.9 L 270.3,113.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 267.9,115.2 L 282.9,120.0' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 282.9,120.0 L 297.8,124.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 269.6,110.0 L 284.5,114.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 284.5,114.9 L 299.5,119.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 270.3,113.1 L 259.8,122.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 259.8,122.5 L 249.4,131.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-9 atom-4' d='M 262.7,77.9 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 166.2,81.0 L 167.5,79.8 L 168.3,80.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 221.4,33.4 L 221.0,31.6 L 222.3,30.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 246.4,8.7 L 247.7,7.5 L 249.4,8.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 280.2,18.0 L 281.9,18.6 L 282.3,20.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 289.1,52.0 L 289.5,53.8 L 288.1,55.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 269.9,111.3 L 270.3,113.1 L 269.7,113.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 155.3 44.7
Q 155.3 42.2, 156.6 40.9
Q 157.8 39.5, 160.0 39.5
Q 162.3 39.5, 163.5 40.9
Q 164.7 42.2, 164.7 44.7
Q 164.7 47.1, 163.5 48.6
Q 162.3 50.0, 160.0 50.0
Q 157.8 50.0, 156.6 48.6
Q 155.3 47.2, 155.3 44.7
M 160.0 48.8
Q 161.6 48.8, 162.4 47.8
Q 163.3 46.7, 163.3 44.7
Q 163.3 42.7, 162.4 41.7
Q 161.6 40.6, 160.0 40.6
Q 158.5 40.6, 157.6 41.6
Q 156.8 42.7, 156.8 44.7
Q 156.8 46.7, 157.6 47.8
Q 158.5 48.8, 160.0 48.8
' fill='#FF0000'/>
<path class='atom-3' d='M 197.1 90.9
Q 197.1 88.5, 198.3 87.1
Q 199.5 85.8, 201.8 85.8
Q 204.0 85.8, 205.2 87.1
Q 206.5 88.5, 206.5 90.9
Q 206.5 93.4, 205.2 94.8
Q 204.0 96.2, 201.8 96.2
Q 199.5 96.2, 198.3 94.8
Q 197.1 93.4, 197.1 90.9
M 201.8 95.1
Q 203.3 95.1, 204.2 94.0
Q 205.0 93.0, 205.0 90.9
Q 205.0 88.9, 204.2 87.9
Q 203.3 86.9, 201.8 86.9
Q 200.2 86.9, 199.4 87.9
Q 198.5 88.9, 198.5 90.9
Q 198.5 93.0, 199.4 94.0
Q 200.2 95.1, 201.8 95.1
' fill='#FF0000'/>
<path class='atom-11' d='M 299.8 124.2
Q 299.8 121.7, 301.0 120.4
Q 302.2 119.0, 304.5 119.0
Q 306.8 119.0, 308.0 120.4
Q 309.2 121.7, 309.2 124.2
Q 309.2 126.7, 308.0 128.1
Q 306.7 129.5, 304.5 129.5
Q 302.3 129.5, 301.0 128.1
Q 299.8 126.7, 299.8 124.2
M 304.5 128.3
Q 306.1 128.3, 306.9 127.3
Q 307.7 126.2, 307.7 124.2
Q 307.7 122.2, 306.9 121.2
Q 306.1 120.2, 304.5 120.2
Q 302.9 120.2, 302.1 121.2
Q 301.3 122.2, 301.3 124.2
Q 301.3 126.2, 302.1 127.3
Q 302.9 128.3, 304.5 128.3
' fill='#FF0000'/>
<path class='atom-12' d='M 228.8 132.2
L 230.2 132.2
L 230.2 136.5
L 235.4 136.5
L 235.4 132.2
L 236.8 132.2
L 236.8 142.3
L 235.4 142.3
L 235.4 137.6
L 230.2 137.6
L 230.2 142.3
L 228.8 142.3
L 228.8 132.2
' fill='#FF0000'/>
<path class='atom-12' d='M 238.9 137.2
Q 238.9 134.8, 240.1 133.4
Q 241.3 132.0, 243.5 132.0
Q 245.8 132.0, 247.0 133.4
Q 248.2 134.8, 248.2 137.2
Q 248.2 139.7, 247.0 141.1
Q 245.8 142.5, 243.5 142.5
Q 241.3 142.5, 240.1 141.1
Q 238.9 139.7, 238.9 137.2
M 243.5 141.3
Q 245.1 141.3, 245.9 140.3
Q 246.8 139.3, 246.8 137.2
Q 246.8 135.2, 245.9 134.2
Q 245.1 133.2, 243.5 133.2
Q 242.0 133.2, 241.1 134.2
Q 240.3 135.2, 240.3 137.2
Q 240.3 139.3, 241.1 140.3
Q 242.0 141.3, 243.5 141.3
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<p>If we generate a list populated with the degrees of atoms (i.e., number of other atoms bonded directly to it), you may notice that there are no 4 values even though the methyl (i.e., -CH<span class="math notranslate nohighlight">\(_3\)</span>) carbon should have four atoms attached to it. This is because the hydrogens are not explicitly designated in the structure (i.e., the are implicit), so they are not counted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetDegree</span><span class="p">()</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">aspirin</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 1, 2, 3, 2, 2, 2, 2, 3, 3, 1, 1]
</pre></div>
</div>
</div>
</div>
<p>We can count the number of implicit hydrogens using the <code class="docutils literal notranslate"><span class="pre">GetNumImplicitHs()</span></code> method, and the third value is a <code class="docutils literal notranslate"><span class="pre">3</span></code> making it the methyl carbon.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetNumImplicitHs</span><span class="p">()</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">aspirin</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 0, 3, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to make all hydrogens explicitly defined, this is accomplished using the <code class="docutils literal notranslate"><span class="pre">Chem.AddHs(mol)</span></code> function. An example is in <a class="reference internal" href="../chapter_16/chap_16_notebook.html#id15"><span class="std std-ref">section 16.3.1</span></a>.</p>
</div>
</aside>
<p>We can also use these atom methods to change values and attributes of various atoms. For example, we can set the isotopes of the carbonyl carbons (i.e., C=O) to <span class="math notranslate nohighlight">\(^{13}\)</span>C. This is accomplished with the following code that iterates through all the atoms and finds the carbonyl carbons by testing for atoms that have an atomic number of 6, are not aromatic, and have no hydrogens and then setting the isotope value to 13. The molecular weight is calculated before and after the isotopes are changed for comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">aspirin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>180.15899999999996
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">aspirin</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> \
        <span class="ow">not</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetIsAromatic</span><span class="p">()</span> <span class="ow">and</span> \
        <span class="n">atom</span><span class="o">.</span><span class="n">GetTotalNumHs</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    
        <span class="n">atom</span><span class="o">.</span><span class="n">SetIsotope</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">MolWt</span><span class="p">(</span><span class="n">aspirin</span><span class="p">))</span>
<span class="n">aspirin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>182.14370968
</pre></div>
</div>
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 164.0,50.6 L 166.4,61.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 166.4,61.8 L 168.8,72.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 158.8,51.7 L 161.2,62.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-0 atom-0 atom-1' d='M 161.2,62.9 L 163.5,74.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 162.4,84.4 L 140.8,103.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 172.7,81.5 L 184.3,85.3' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 184.3,85.3 L 195.9,89.0' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 207.6,85.6 L 218.1,76.2' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-3 atom-3 atom-4' d='M 218.1,76.2 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 228.5,66.8 L 221.0,31.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-4 atom-4 atom-5' d='M 233.1,62.6 L 226.9,33.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-5 atom-5 atom-6' d='M 221.0,31.6 L 247.7,7.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 247.7,7.5 L 281.9,18.6' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-6 atom-6 atom-7' d='M 249.0,13.6 L 277.3,22.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-7 atom-7 atom-8' d='M 281.9,18.6 L 289.5,53.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 289.5,53.8 L 262.7,77.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-8 atom-8 atom-9' d='M 283.5,51.9 L 261.4,71.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-9 atom-9 atom-10' d='M 262.7,77.9 L 268.9,106.7' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 274.5,117.3 L 286.2,121.1' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 286.2,121.1 L 297.8,124.8' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 276.2,112.2 L 287.8,115.9' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-10 atom-10 atom-11' d='M 287.8,115.9 L 299.5,119.7' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 265.1,117.7 L 257.3,124.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-11 atom-10 atom-12' d='M 257.3,124.8 L 249.4,131.9' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-12 atom-9 atom-4' d='M 262.7,77.9 L 228.5,66.8' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 221.4,33.4 L 221.0,31.6 L 222.3,30.4' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 246.4,8.7 L 247.7,7.5 L 249.4,8.1' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 280.2,18.0 L 281.9,18.6 L 282.3,20.3' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path d='M 289.1,52.0 L 289.5,53.8 L 288.1,55.0' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-0' d='M 155.3 44.7
Q 155.3 42.2, 156.6 40.9
Q 157.8 39.5, 160.0 39.5
Q 162.3 39.5, 163.5 40.9
Q 164.7 42.2, 164.7 44.7
Q 164.7 47.1, 163.5 48.6
Q 162.3 50.0, 160.0 50.0
Q 157.8 50.0, 156.6 48.6
Q 155.3 47.2, 155.3 44.7
M 160.0 48.8
Q 161.6 48.8, 162.4 47.8
Q 163.3 46.7, 163.3 44.7
Q 163.3 42.7, 162.4 41.7
Q 161.6 40.6, 160.0 40.6
Q 158.5 40.6, 157.6 41.6
Q 156.8 42.7, 156.8 44.7
Q 156.8 46.7, 157.6 47.8
Q 158.5 48.8, 160.0 48.8
' fill='#FF0000'/>
<path class='atom-1' d='M 153.1 79.0
L 154.5 79.0
L 154.5 74.0
L 152.9 74.5
L 152.7 73.9
L 154.7 73.0
L 155.4 73.1
L 155.4 79.0
L 156.7 79.0
L 156.7 79.8
L 153.1 79.8
L 153.1 79.0
' fill='#000000'/>
<path class='atom-1' d='M 161.1 76.2
Q 161.7 76.4, 162.0 76.8
Q 162.4 77.3, 162.4 77.9
Q 162.4 78.5, 162.1 78.9
Q 161.8 79.4, 161.3 79.6
Q 160.7 79.9, 160.1 79.9
Q 159.3 79.9, 158.8 79.6
Q 158.3 79.4, 157.8 78.8
L 158.4 78.3
Q 158.8 78.8, 159.1 78.9
Q 159.5 79.1, 160.1 79.1
Q 160.7 79.1, 161.0 78.8
Q 161.4 78.4, 161.4 77.9
Q 161.4 77.2, 161.0 76.9
Q 160.6 76.6, 159.8 76.6
L 159.3 76.6
L 159.3 75.9
L 159.8 75.9
Q 160.5 75.9, 160.9 75.6
Q 161.3 75.3, 161.3 74.7
Q 161.3 74.2, 160.9 74.0
Q 160.6 73.7, 160.1 73.7
Q 159.5 73.7, 159.2 73.9
Q 158.8 74.1, 158.5 74.6
L 157.9 74.3
Q 158.1 73.7, 158.7 73.3
Q 159.3 73.0, 160.1 73.0
Q 161.1 73.0, 161.6 73.4
Q 162.2 73.9, 162.2 74.7
Q 162.2 75.2, 161.9 75.6
Q 161.6 76.0, 161.1 76.2
' fill='#000000'/>
<path class='atom-1' d='M 163.6 79.9
Q 163.6 77.3, 164.8 76.0
Q 166.0 74.7, 168.2 74.7
Q 170.3 74.7, 171.5 76.2
L 170.5 76.9
Q 169.7 75.9, 168.2 75.9
Q 166.7 75.9, 165.9 76.9
Q 165.1 77.9, 165.1 79.9
Q 165.1 81.9, 165.9 82.9
Q 166.8 84.0, 168.4 84.0
Q 169.5 84.0, 170.8 83.3
L 171.2 84.4
Q 170.7 84.7, 169.9 84.9
Q 169.1 85.1, 168.2 85.1
Q 166.0 85.1, 164.8 83.8
Q 163.6 82.4, 163.6 79.9
' fill='#000000'/>
<path class='atom-3' d='M 197.1 90.9
Q 197.1 88.5, 198.3 87.1
Q 199.5 85.8, 201.8 85.8
Q 204.0 85.8, 205.2 87.1
Q 206.5 88.5, 206.5 90.9
Q 206.5 93.4, 205.2 94.8
Q 204.0 96.2, 201.8 96.2
Q 199.5 96.2, 198.3 94.8
Q 197.1 93.4, 197.1 90.9
M 201.8 95.1
Q 203.3 95.1, 204.2 94.0
Q 205.0 93.0, 205.0 90.9
Q 205.0 88.9, 204.2 87.9
Q 203.3 86.9, 201.8 86.9
Q 200.2 86.9, 199.4 87.9
Q 198.5 88.9, 198.5 90.9
Q 198.5 93.0, 199.4 94.0
Q 200.2 95.1, 201.8 95.1
' fill='#FF0000'/>
<path class='atom-10' d='M 255.8 112.3
L 257.2 112.3
L 257.2 107.2
L 255.6 107.7
L 255.4 107.2
L 257.5 106.2
L 258.1 106.4
L 258.1 112.3
L 259.5 112.3
L 259.5 113.0
L 255.8 113.0
L 255.8 112.3
' fill='#000000'/>
<path class='atom-10' d='M 263.8 109.5
Q 264.4 109.7, 264.7 110.1
Q 265.1 110.5, 265.1 111.2
Q 265.1 111.7, 264.8 112.2
Q 264.5 112.6, 264.0 112.9
Q 263.5 113.1, 262.8 113.1
Q 262.1 113.1, 261.5 112.9
Q 261.0 112.6, 260.5 112.1
L 261.1 111.5
Q 261.5 112.0, 261.9 112.2
Q 262.2 112.3, 262.8 112.3
Q 263.4 112.3, 263.8 112.0
Q 264.1 111.7, 264.1 111.2
Q 264.1 110.5, 263.7 110.2
Q 263.4 109.9, 262.5 109.9
L 262.0 109.9
L 262.0 109.2
L 262.5 109.2
Q 263.2 109.2, 263.6 108.9
Q 264.0 108.5, 264.0 107.9
Q 264.0 107.5, 263.7 107.2
Q 263.3 107.0, 262.8 107.0
Q 262.2 107.0, 261.9 107.2
Q 261.5 107.4, 261.3 107.9
L 260.6 107.5
Q 260.8 107.0, 261.4 106.6
Q 262.0 106.2, 262.8 106.2
Q 263.8 106.2, 264.4 106.7
Q 264.9 107.1, 264.9 107.9
Q 264.9 108.5, 264.6 108.9
Q 264.3 109.3, 263.8 109.5
' fill='#000000'/>
<path class='atom-10' d='M 266.3 113.1
Q 266.3 110.6, 267.5 109.3
Q 268.7 107.9, 271.0 107.9
Q 273.1 107.9, 274.2 109.4
L 273.2 110.2
Q 272.4 109.1, 271.0 109.1
Q 269.4 109.1, 268.6 110.1
Q 267.8 111.2, 267.8 113.1
Q 267.8 115.1, 268.6 116.2
Q 269.5 117.2, 271.1 117.2
Q 272.2 117.2, 273.6 116.5
L 274.0 117.6
Q 273.4 118.0, 272.6 118.2
Q 271.8 118.4, 270.9 118.4
Q 268.7 118.4, 267.5 117.0
Q 266.3 115.7, 266.3 113.1
' fill='#000000'/>
<path class='atom-11' d='M 299.8 124.2
Q 299.8 121.7, 301.0 120.4
Q 302.2 119.0, 304.5 119.0
Q 306.8 119.0, 308.0 120.4
Q 309.2 121.7, 309.2 124.2
Q 309.2 126.7, 308.0 128.1
Q 306.7 129.5, 304.5 129.5
Q 302.3 129.5, 301.0 128.1
Q 299.8 126.7, 299.8 124.2
M 304.5 128.3
Q 306.1 128.3, 306.9 127.3
Q 307.7 126.2, 307.7 124.2
Q 307.7 122.2, 306.9 121.2
Q 306.1 120.2, 304.5 120.2
Q 302.9 120.2, 302.1 121.2
Q 301.3 122.2, 301.3 124.2
Q 301.3 126.2, 302.1 127.3
Q 302.9 128.3, 304.5 128.3
' fill='#FF0000'/>
<path class='atom-12' d='M 228.8 132.2
L 230.2 132.2
L 230.2 136.5
L 235.4 136.5
L 235.4 132.2
L 236.8 132.2
L 236.8 142.3
L 235.4 142.3
L 235.4 137.6
L 230.2 137.6
L 230.2 142.3
L 228.8 142.3
L 228.8 132.2
' fill='#FF0000'/>
<path class='atom-12' d='M 238.9 137.2
Q 238.9 134.8, 240.1 133.4
Q 241.3 132.0, 243.5 132.0
Q 245.8 132.0, 247.0 133.4
Q 248.2 134.8, 248.2 137.2
Q 248.2 139.7, 247.0 141.1
Q 245.8 142.5, 243.5 142.5
Q 241.3 142.5, 240.1 141.1
Q 238.9 139.7, 238.9 137.2
M 243.5 141.3
Q 245.1 141.3, 245.9 140.3
Q 246.8 139.3, 246.8 137.2
Q 246.8 135.2, 245.9 134.2
Q 245.1 133.2, 243.5 133.2
Q 242.0 133.2, 241.1 134.2
Q 240.3 135.2, 240.3 137.2
Q 240.3 139.3, 241.1 140.3
Q 242.0 141.3, 243.5 141.3
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<p>The molar mass has increased due to two of the carbon atoms being isotopically labeled, and we can see in the image which of the two carbons were isotopically labeled. It is worth nothing that the molecular weight before isotopically labeling assumes a natural distribution of isotopes which for carbon is 98.9% <span class="math notranslate nohighlight">\(^{12}\)</span>C and 1.1% <span class="math notranslate nohighlight">\(^{13}\)</span>C. In the isotopically labeled structure, the two carbonyl carbons are 100% <span class="math notranslate nohighlight">\(^{13}\)</span>C.</p>
<p>Using bond methods, we can perform analogous types of operations except that bonds have different attributes than atoms. A table of selected bond methods is provided below.</p>
<p><strong>Table 10</strong> Select Bond Methods</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetBeginAtom()</span></code></p></td>
<td><p>Returns first atom in bond</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetEndAtom()</span></code></p></td>
<td><p>Returns second atom in bond</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetBondType()</span></code></p></td>
<td><p>Returns type of bond (e.g., SINGLE, DOUBLE, AROMATIC)</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetIsAromatic()</span></code></p></td>
<td><p>Returns bool as to whether bond is aromatic</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">GetIsConjugated()</span></code></p></td>
<td><p>Returns bool as to wether bond is conjugated</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">IsInRing()</span></code></p></td>
<td><p>Returns bool as to wether bond is in ring</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">SetBondType()</span></code></p></td>
<td><p>Sets bond type</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">SetIsAromatic()</span></code></p></td>
<td><p>Sets bool designating if a bond is aromatic</p></td>
</tr>
</tbody>
</table>
</div>
<p>As a demonstration, we will examine the bonds in the structure of acetone and change the carbonyl double bond to a single bond. This is done by searching for a double bond, setting it to a single bond, and then changing the formal charges of the atoms attached to that bond.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acetone</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 153.9,142.5 L 225.0,101.4' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 231.2,105.0 L 231.2,69.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 231.2,69.5 L 231.2,34.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 218.8,105.0 L 218.8,69.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 218.8,69.5 L 218.8,34.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 225.0,101.4 L 296.1,142.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path d='M 221.4,103.5 L 225.0,101.4 L 228.6,103.5' style='fill:none;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;' />
<path class='atom-2' d='M 214.3 19.3
Q 214.3 13.7, 217.1 10.6
Q 219.8 7.5, 225.0 7.5
Q 230.2 7.5, 232.9 10.6
Q 235.7 13.7, 235.7 19.3
Q 235.7 25.0, 232.9 28.2
Q 230.1 31.4, 225.0 31.4
Q 219.9 31.4, 217.1 28.2
Q 214.3 25.0, 214.3 19.3
M 225.0 28.8
Q 228.5 28.8, 230.5 26.4
Q 232.4 24.0, 232.4 19.3
Q 232.4 14.8, 230.5 12.5
Q 228.5 10.1, 225.0 10.1
Q 221.5 10.1, 219.5 12.4
Q 217.6 14.7, 217.6 19.3
Q 217.6 24.0, 219.5 26.4
Q 221.5 28.8, 225.0 28.8
' fill='#FF0000'/>
</svg>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">acetone</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">DOUBLE</span><span class="p">:</span>
        <span class="n">bond</span><span class="o">.</span><span class="n">SetBondType</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span><span class="o">.</span><span class="n">SetFormalCharge</span><span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">acetone</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><?xml version='1.0' encoding='iso-8859-1'?>
<svg version='1.1' baseProfile='full'
              xmlns='http://www.w3.org/2000/svg'
                      xmlns:rdkit='http://www.rdkit.org/xml'
                      xmlns:xlink='http://www.w3.org/1999/xlink'
                  xml:space='preserve'
width='450px' height='150px' viewBox='0 0 450 150'>
<!-- END OF HEADER -->
<rect style='opacity:1.0;fill:#FFFFFF;stroke:none' width='450.0' height='150.0' x='0.0' y='0.0'> </rect>
<path class='bond-0 atom-0 atom-1' d='M 153.9,142.5 L 213.3,108.2' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 225.0,86.9 L 225.0,60.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-1 atom-1 atom-2' d='M 225.0,60.5 L 225.0,34.1' style='fill:none;fill-rule:evenodd;stroke:#FF0000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='bond-2 atom-1 atom-3' d='M 236.7,108.2 L 296.1,142.5' style='fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1' />
<path class='atom-1' d='M 216.0 101.5
Q 216.0 95.7, 218.7 92.7
Q 221.5 89.7, 226.6 89.7
Q 231.4 89.7, 234.0 93.0
L 231.8 94.8
Q 229.9 92.4, 226.6 92.4
Q 223.1 92.4, 221.2 94.7
Q 219.4 97.1, 219.4 101.5
Q 219.4 106.1, 221.3 108.5
Q 223.2 110.9, 227.0 110.9
Q 229.5 110.9, 232.5 109.3
L 233.4 111.8
Q 232.2 112.6, 230.4 113.0
Q 228.5 113.5, 226.5 113.5
Q 221.5 113.5, 218.7 110.4
Q 216.0 107.3, 216.0 101.5
' fill='#000000'/>
<path class='atom-1' d='M 237.0 93.8
L 241.0 93.8
L 241.0 89.5
L 242.9 89.5
L 242.9 93.8
L 247.1 93.8
L 247.1 95.4
L 242.9 95.4
L 242.9 99.7
L 241.0 99.7
L 241.0 95.4
L 237.0 95.4
L 237.0 93.8
' fill='#000000'/>
<path class='atom-2' d='M 214.3 19.3
Q 214.3 13.7, 217.1 10.6
Q 219.8 7.5, 225.0 7.5
Q 230.2 7.5, 232.9 10.6
Q 235.7 13.7, 235.7 19.3
Q 235.7 25.0, 232.9 28.2
Q 230.1 31.4, 225.0 31.4
Q 219.9 31.4, 217.1 28.2
Q 214.3 25.0, 214.3 19.3
M 225.0 28.8
Q 228.5 28.8, 230.5 26.4
Q 232.4 24.0, 232.4 19.3
Q 232.4 14.8, 230.5 12.5
Q 228.5 10.1, 225.0 10.1
Q 221.5 10.1, 219.5 12.4
Q 217.6 14.7, 217.6 19.3
Q 217.6 24.0, 219.5 26.4
Q 221.5 28.8, 225.0 28.8
' fill='#FF0000'/>
<path class='atom-2' d='M 239.0 11.3
L 247.0 11.3
L 247.0 13.0
L 239.0 13.0
L 239.0 11.3
' fill='#FF0000'/>
</svg>
</div></div>
</div>
</section>
<section id="further-reading">
<span id="fr15"></span><h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>RDKit: Open-Source Cheminformatics Software. <a class="reference external" href="https://www.rdkit.org/">https://www.rdkit.org/</a> (free resource)</p></li>
<li><p>The RDKit Book (collection of examples). <a class="reference external" href="https://www.rdkit.org/docs/RDKit_Book.html">https://www.rdkit.org/docs/RDKit_Book.html</a> (free resource)</p></li>
</ol>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>Complete the following exercises in a Jupyter notebook using RDKit. You are encouraged to also to use data libraries such as NumPy or pandas to support your solutions. Any data file(s) refered to in the problems can be found in the <a class="reference external" href="https://github.com/weisscharlesj/SciCompforChemists/tree/master/notebooks">data</a> folder in the same directory as this chapter’s Jupyter notebook. Alternatively, you can download a zip file of the data for this chapter from <a class="reference external" href="https://github.com/weisscharlesj/data_SciCompforChem">here</a> by selecting the appropriate chapter file and then clicking the <strong>Download</strong> button.</p>
<ol class="arabic">
<li><p>Load the structure for <strong>morphine</strong> into RDKit using either a SMILES or InChI representation. You will need to either generate one of these representations using chemical drawing software or find one online from a free resource.</p>
<p>a) Visualize the structure of morphine and save it as an SVG image file.</p>
<p>b) Use RDKit to determine the number of chiral centers in the structure. Your code should output an integer value, not just a list of chiral centers.</p>
<p>c) Use RDKit to determine the number of hydrogen bond acceptors in the structure.</p>
<p>d) Use RDKit to determine the number of rings in the structure.</p>
</li>
<li><p>Load the <strong>amino_acid_SMILES.txt</strong> file and use RDKit for the following.</p>
<p>a) Determine the absolute configuration (i.e., R vs. S) of the <span class="math notranslate nohighlight">\(\alpha\)</span>-carbon for all the chiral amino acids. Most are the same, but one is an exception. Which is it?</p>
<p>b) How many amino acids have two chiral centers?</p>
</li>
<li><p>Load the <strong>organic_molecules.txt</strong> dataset containing SMILES representations of a range of organic molecules.</p>
<p>a) Using descriptors, generate a list containing the SMILES representations of only primary and secondary alphatic alcohols.</p>
<p>b) Using pattern matching, generate an image containing only primary alcohols from the file. To help you along, here is the SMARTS representation of a primary alcohol for the pattern matching. <code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmarts('[CH2][OH]')</span></code></p>
<p>c) Calculate the percentage of heavy-element (i.e., not with hydrogens) bonds that are C-O bonds.</p>
<p>d) Calculate the percentage of carbon atoms in a ring.</p>
</li>
<li><p>Use RDKit to generate an image showing all isomers of 1,2-dimethylcyclohexane. You will need to look up the SMILES or other representation first.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "scicompchem-env"
        },
        kernelOptions: {
            name: "scicompchem-env",
            path: "./notebooks/chapter_15"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'scicompchem-env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../chapter_14/chap_14_notebook.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 14: Optimization and Root Finding</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter_16/chap_16_notebook.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 16: Bioinformatics with Biopython and Nglview</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-molecular-representations-into-rdkit">15.1 Loading Molecular Representations into RDKit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-chemical-structures">15.2 Visualizing Chemical Structures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-chemical-structures">15.2.1 Single Chemical Structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grids-of-chemical-structures">15.2.2 Grids of Chemical Structures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stereochemistry">15.3 Stereochemistry</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assigning-stereochemistry">15.3.1 Assigning Stereochemistry</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-and-generating-isomers">15.3.2 Counting and Generating Isomers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chem-descriptor-module">15.4 <code class="docutils literal notranslate"><span class="pre">Chem.Descriptor</span></code> Module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-features">15.4.1 Molecular Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-functional-groups">15.4.2 Quantifying Functional Groups</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-molecules-for-structural-patterns">15.5 Searching Molecules for Structural Patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#atoms-and-bonds">15.6 Atoms and Bonds</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Charles J. Weiss
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2017-2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Scientific Computing for Chemists with Python is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>