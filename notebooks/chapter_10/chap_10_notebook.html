

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 10: Plotting with Seaborn &#8212; Scientific Computing for Chemists with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/chapter_10/chap_10_notebook';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 11: Nuclear Magnetic Resonance with NMRglue" href="../chapter_11/chap_11_notebook.html" />
    <link rel="prev" title="Chapter 9: Simulations" href="../chapter_09/chap_09_notebook.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../introduction/intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction/intro.html">
                    Scientific Computing for Chemists with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_00/chap_00_notebook.html">Chapter 0: Python &amp; Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_01/chap_01_notebook.html">Chapter 1: Basic Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_02/chap_02_notebook.html">Chapter 2: Intermediate Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_03/chap_03_notebook.html">Chapter 3: Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_04/chap_04_notebook.html">Chapter 4: NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_05/chap_05_notebook.html">Chapter 5: Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_06/chap_06_notebook.html">Chapter 6: Signal &amp; Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_07/chap_07_notebook.html">Chapter 7: Image Processing &amp; Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_08/chap_08_notebook.html">Chapter 8: Mathematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_09/chap_09_notebook.html">Chapter 9: Simulations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 10: Plotting with Seaborn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_11/chap_11_notebook.html">Chapter 11: Nuclear Magnetic Resonance with NMRglue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_12/chap_12_notebook.html">Chapter 12: Machine Learning using Scikit-Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_13/chap_13_notebook.html">Chapter 13: Command Line &amp; Spyder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_14/chap_14_notebook.html">Chapter 14: Optimization and Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_15/chap_15_notebook.html">Chapter 15: Cheminformatics with RDKit <font color="C51E3A"> (BETA) </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_16/chap_16_notebook.html">Chapter 16: Bioinformations with Biopython <font color="C51E3A"> (BETA) </font></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists/issues/new?title=Issue%20on%20page%20%2Fnotebooks/chapter_10/chap_10_notebook.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/chapter_10/chap_10_notebook.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 10: Plotting with Seaborn</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn-plot-types">10.1 Seaborn Plot Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-plots">10.2 Regression Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regplot">10.2.1 regplot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lmplot">10.2.2 lmplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-plots">10.3 Categorical Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strip-plot">10.3.1 Strip Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swarm-plot">10.3.2 Swarm Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#violin-plot">10.3.3 Violin Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#box-plot">10.3.4 Box Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-plot">10.3.5 Count Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-plots">10.4 Distribution Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">10.4.1 histplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kde-plot">10.4.2 kde Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jointplot-diffusion-simulation">10.4.3 jointplot (diffusion simulation)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pair-plot">10.5 Pair Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-map">10.6 Heat Map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-plots">10.7 Relational Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots">10.7.1 Scatter Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-plots">10.7.2 Line Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-data-sets">10.8 Internal Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-10-plotting-with-seaborn">
<span id="id1"></span><h1>Chapter 10: Plotting with Seaborn<a class="headerlink" href="#chapter-10-plotting-with-seaborn" title="Permalink to this heading">#</a></h1>
<div class="cell tag_remove-input docutils container">
</div>
<p>There are a number of plotting libraries available for Python including Bokeh, Plotly, and MayaVi; but the most prevalent library is still probably matplotlib. It is often the first plotting library a Python user will learn, and for good reason. It is stable, well supported, and there are few plots that matplotlib cannot generate. Despite its popularity, there are some drawbacks… namely, it can be quite verbose. That is, you may be able to generate nearly any plot, but it will take at least a few lines of code if not dozens to create and customize your figure.</p>
<p>One attractive alternative is the seaborn plotting library. While seaborn cannot generate the same variety of plots as matplotlib, it is good at generating a few common plots that people use regularly, and here is the key detail… it often does what would take matplotlib 10+ lines of code in only one or two lines. To make things even better, seaborn is built on top of matplotlib. This means that if you are not completely happy with what seaborn creates, you can fine tune it with the same matplotlib commands you already know! In addition, seaborn is designed to work closely with the pandas library. For example, think of all the lines of code you have typed to simply add labels to your <em>x</em>- and <em>y</em>-axes. Instead, seaborn often pulls the labels from the DataFrame column headers. Again, if you do not like this default behavior, you can still override it with <code class="docutils literal notranslate"><span class="pre">plt.xlabel()</span></code> and other commands that you already know.</p>
<p>By convention, seaborn is imported with the <code class="docutils literal notranslate"><span class="pre">sns</span></code> alias, but being that this is a relatively young library, it is unclear how strong this convention is. The <a class="reference external" href="https://seaborn.pydata.org/">official seaborn website</a> uses it, so we will as well. All code in this chapter assumes the following import.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="seaborn-plot-types">
<span id="id2"></span><h2>10.1 Seaborn Plot Types<a class="headerlink" href="#seaborn-plot-types" title="Permalink to this heading">#</a></h2>
<p>A map of the seaborn plotting library is mainly a series of the different types of plots that it can generate. Below is table of the main categories. The rest of this chapter is a more in-depth survey of select plotting functions, and it is certainly not a complete list.</p>
<p><strong>Table 1</strong> Seaborn Plotting Type Categories Covered Herein</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Category</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Regression</p></td>
<td class="text-left"><p>Draws a regression line through the data</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Categorical</p></td>
<td class="text-left"><p>Plots frequency versus a category</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Distribution</p></td>
<td class="text-left"><p>Plots frequency versus a continuous value</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Matrix</p></td>
<td class="text-left"><p>Displays the data as a colored grid</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Relational</p></td>
<td class="text-left"><p>Visualizes the relationship between two continuous variables</p></td>
</tr>
</tbody>
</table>
<p>One distinction between some of the plotting categories above is whether they display continuous versus discrete/categorial information. When data are continuous, they can be nearly any value in a range like the density of a metal. This in contrast to discrete or categorial data that places data in a limited number of groups or bins such as the element(s) present in a metal sample.</p>
</section>
<section id="regression-plots">
<span id="id3"></span><h2>10.2 Regression Plots<a class="headerlink" href="#regression-plots" title="Permalink to this heading">#</a></h2>
<p>Generating a regression line through data is a common task in science, and seaborn includes multiple plotting types that perform this task. All of the plots discussed below use a least square best fit and include a confidence interval for the regression line as a shaded region. Remember that there is uncertainty in both the slope and <em>y</em>-intercept for a regression line. If we were to plot all the possible variations of the regression line within the slope and intercept uncertainties, we get the regression confidence interval. By default, seaborn displays the 95% confidence interval, but this can be changed.</p>
<section id="regplot">
<span id="id4"></span><h3>10.2.1 regplot<a class="headerlink" href="#regplot" title="Permalink to this heading">#</a></h3>
<span class="target" id="index-0"></span><p id="index-1">The <code class="docutils literal notranslate"><span class="pre">regplot</span></code> generates a single scatter plot of data with a linear regression through the data points complete with a 95% confidence interval. The <code class="docutils literal notranslate"><span class="pre">sns.regplot()</span></code> function can take <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> positional arguments just like <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code>, but it also can take the <em>x</em> and <em>y</em> column names from a pandas DataFrame. Both approaches are demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1f6291c68d384350ef7af5193e43133f7e6bdf7748d599af1d8e8e017444d9bb.svg" src="../../_images/1f6291c68d384350ef7af5193e43133f7e6bdf7748d599af1d8e8e017444d9bb.svg" /></div>
</div>
<p>If the data is in a DataFrame, the <em>x</em> and <em>y</em> values can be provide as the column names, and seaborn will automatically add the column names as x and y labels. Below is a series of boiling point and molecular weights for various organic compounds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/org_bp.csv&#39;</span><span class="p">)</span>
<span class="n">bp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bp</th>
      <th>MW</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65</td>
      <td>32.04</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>1</th>
      <td>78</td>
      <td>46.07</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98</td>
      <td>60.10</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>118</td>
      <td>74.12</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>4</th>
      <td>139</td>
      <td>88.15</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>5</th>
      <td>157</td>
      <td>102.18</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>6</th>
      <td>176</td>
      <td>116.20</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>7</th>
      <td>195</td>
      <td>130.23</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>8</th>
      <td>212</td>
      <td>144.25</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>9</th>
      <td>232</td>
      <td>158.28</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>10</th>
      <td>36</td>
      <td>72.15</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>11</th>
      <td>69</td>
      <td>86.18</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>12</th>
      <td>98</td>
      <td>100.21</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>13</th>
      <td>126</td>
      <td>114.23</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>14</th>
      <td>151</td>
      <td>128.26</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>15</th>
      <td>174</td>
      <td>142.29</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>16</th>
      <td>196</td>
      <td>156.31</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>17</th>
      <td>216</td>
      <td>170.34</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>18</th>
      <td>63</td>
      <td>86.18</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>19</th>
      <td>117</td>
      <td>114.23</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>20</th>
      <td>28</td>
      <td>72.15</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>21</th>
      <td>80</td>
      <td>100.21</td>
      <td>alkane</td>
    </tr>
    <tr>
      <th>22</th>
      <td>108</td>
      <td>74.12</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>23</th>
      <td>83</td>
      <td>74.12</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>24</th>
      <td>131</td>
      <td>88.15</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>25</th>
      <td>135</td>
      <td>102.18</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>26</th>
      <td>140</td>
      <td>116.20</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>27</th>
      <td>182</td>
      <td>94.11</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>28</th>
      <td>202</td>
      <td>108.14</td>
      <td>alcohol</td>
    </tr>
    <tr>
      <th>29</th>
      <td>220</td>
      <td>136.19</td>
      <td>alcohol</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you choose to provide column names from a pandas DataFrame, you must also provide the name of the DataFrame using the <code class="docutils literal notranslate"><span class="pre">data</span></code> keyword argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bp</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a67583339001e5ff00e5e434bab3ee1f2d9698ef9c6ba4cd00ce8766ccaa505e.svg" src="../../_images/a67583339001e5ff00e5e434bab3ee1f2d9698ef9c6ba4cd00ce8766ccaa505e.svg" /></div>
</div>
<p>While the DataFrame column names provide accurate axis labels, the units are missing. We can use matplotlib commands from chapter 3 to modify the axis labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MW, g/mol&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;bp, $^o$C&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/28500799680923eebc995ac234afc5d69ad8b3e7896133d27e2ee915ad76c7ef.svg" src="../../_images/28500799680923eebc995ac234afc5d69ad8b3e7896133d27e2ee915ad76c7ef.svg" /></div>
</div>
</section>
</section>
<section id="lmplot">
<span id="id5"></span><h2>10.2.2 lmplot<a class="headerlink" href="#lmplot" title="Permalink to this heading">#</a></h2>
<p>An <code class="docutils literal notranslate"><span class="pre">lmplot()</span></code> is very similar to the <code class="docutils literal notranslate"><span class="pre">regplot()</span></code> function except that an <code class="docutils literal notranslate"><span class="pre">lmplot()</span></code> also allows for multiple regressions based on additional pieces of information about each data point. For example, the <em>org_bp.csv</em> file above contains the boiling points of various alcohols and alkanes along with their molecular weights. Chemical intuition might bring one to expect two independent boiling point trends between the alcohol and alkanes, so we need two independent regression lines for the two classes of organic molecule. The <code class="docutils literal notranslate"><span class="pre">lmplot()</span></code> function can do exactly this.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lmplot()</span></code> function takes the <em>x</em> and <em>y</em> variables and the DataFrame name as either positional or keyword arguments, so the function call could also be as shown below where the first three arguments are positional arguments providing the <em>x</em>-values, <em>y</em>-values, and the DataFrame name in this order.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">hue=</span></code> argument is the column name that dictates the color of the markers, so in this example, it will be the type of organic molecule.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bp</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MW, g/mol&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;bp, $^o$C&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/cerberus/miniconda3/lib/python3.11/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
</pre></div>
</div>
<img alt="../../_images/a5a77984187e850ade5aa70f11ab25b92dc88a3bd67332ddb0814be7132300e4.svg" src="../../_images/a5a77984187e850ade5aa70f11ab25b92dc88a3bd67332ddb0814be7132300e4.svg" /></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lmplot()</span></code> function also provides arguments for modifying the appearance of the plot. Below is a demonstration of a few extra adjustments to the plot. The <code class="docutils literal notranslate"><span class="pre">facet_kws</span></code> argument takes extra parameters in the form of a dictionary with key-value pairs. In this case, the <code class="docutils literal notranslate"><span class="pre">legend_out</span></code> key controls whether the legend is outside the plot’s boundaries. The <code class="docutils literal notranslate"><span class="pre">aspect</span></code> argument sets the ratio of the <em>x</em>-axis versus the <em>y</em>-axis, and the marker shapes can also be modified using the <code class="docutils literal notranslate"><span class="pre">markers</span></code> argument with matplotlib conventions from <a class="reference internal" href="../chapter_03/chap_03_notebook.html#id4"><span class="std std-ref">section 3.1.2</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bp</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">],</span> 
           <span class="n">aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">facet_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;legend_out&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MW, g/mol&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;bp, $^o$C&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/cerberus/miniconda3/lib/python3.11/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
</pre></div>
</div>
<img alt="../../_images/893170be0f9595766beb068e366a80f0ba4a992c4a6d56394db660db2ab2b1c6.svg" src="../../_images/893170be0f9595766beb068e366a80f0ba4a992c4a6d56394db660db2ab2b1c6.svg" /></div>
</div>
</section>
<section id="categorical-plots">
<span id="id6"></span><h2>10.3 Categorical Plots<a class="headerlink" href="#categorical-plots" title="Permalink to this heading">#</a></h2>
<p id="index-2">Categorical plots contain one axis of continuous values and one axis of discrete or categorical values. For example, if the density of three metals were measured repeatedly in lab, we would want to plot measured density (continuous) with respect to metal identity (categorial). Below are a few fictitious laboratory measurements for the densities of copper, iron, and zinc.</p>
<p><strong>Table 2</strong> Density (g/mL) Measurements for Different Metals</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Cu</p></th>
<th class="head text-center"><p>Fe</p></th>
<th class="head text-center"><p>Zn</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>8.51</p></td>
<td class="text-center"><p>7.95</p></td>
<td class="text-center"><p>6.79</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9.49</p></td>
<td class="text-center"><p>7.53</p></td>
<td class="text-center"><p>7.06</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>8.48</p></td>
<td class="text-center"><p>8.09</p></td>
<td class="text-center"><p>7.96</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9.40</p></td>
<td class="text-center"><p>7.44</p></td>
<td class="text-center"><p>7.06</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>8.83</p></td>
<td class="text-center"><p>8.38</p></td>
<td class="text-center"><p>6.69</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9.45</p></td>
<td class="text-center"><p>7.83</p></td>
<td class="text-center"><p>7.21</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>8.73</p></td>
<td class="text-center"><p>6.88</p></td>
<td class="text-center"><p>7.35</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9.00</p></td>
<td class="text-center"><p>7.90</p></td>
<td class="text-center"><p>6.65</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>8.84</p></td>
<td class="text-center"><p>8.51</p></td>
<td class="text-center"><p>7.41</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9.32</p></td>
<td class="text-center"><p>7.89</p></td>
<td class="text-center"><p>7.89</p></td>
</tr>
</tbody>
</table>
<p>If we want to compare these values, the density can be plotted on the <em>y</em>-axis and metal on the <em>x</em>-axis. First, we need to load the values into a DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;Zn&#39;</span><span class="p">]</span>
<span class="n">densities</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">8.51</span><span class="p">,</span> <span class="mf">7.95</span><span class="p">,</span> <span class="mf">6.79</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">9.49</span><span class="p">,</span> <span class="mf">7.53</span><span class="p">,</span> <span class="mf">7.06</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">8.48</span><span class="p">,</span> <span class="mf">8.09</span><span class="p">,</span> <span class="mf">7.96</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">9.40</span><span class="p">,</span> <span class="mf">7.44</span><span class="p">,</span> <span class="mf">7.06</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">8.83</span><span class="p">,</span> <span class="mf">8.38</span><span class="p">,</span> <span class="mf">6.69</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">9.45</span><span class="p">,</span> <span class="mf">7.83</span><span class="p">,</span> <span class="mf">7.21</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">8.73</span><span class="p">,</span> <span class="mf">6.88</span><span class="p">,</span> <span class="mf">7.35</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">9.00</span><span class="p">,</span> <span class="mf">7.90</span><span class="p">,</span> <span class="mf">6.65</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">8.84</span><span class="p">,</span> <span class="mf">8.51</span><span class="p">,</span> <span class="mf">7.41</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">9.32</span><span class="p">,</span> <span class="mf">7.89</span><span class="p">,</span> <span class="mf">7.89</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">densities</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cu</th>
      <th>Fe</th>
      <th>Zn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.51</td>
      <td>7.95</td>
      <td>6.79</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.49</td>
      <td>7.53</td>
      <td>7.06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.48</td>
      <td>8.09</td>
      <td>7.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.40</td>
      <td>7.44</td>
      <td>7.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.83</td>
      <td>8.38</td>
      <td>6.69</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="strip-plot">
<span id="id7"></span><h3>10.3.1 Strip Plot<a class="headerlink" href="#strip-plot" title="Permalink to this heading">#</a></h3>
<p>The simplest categorical plot function is <code class="docutils literal notranslate"><span class="pre">stripplot()</span></code> which generates a scatter plot with the <em>x</em>-axis as the categorical dimension and the <em>y</em>-axis as the continuous value dimension. By providing the function with the DataFrame, it will assume the columns are the categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/34a226922710c2db21b5e447a3a711baaa2a01d6396a0a1d4f88b7d5e0e342fe.svg" src="../../_images/34a226922710c2db21b5e447a3a711baaa2a01d6396a0a1d4f88b7d5e0e342fe.svg" /></div>
</div>
<p>By default, the <em>x</em>-axis contains the column labels from the DataFrame, but the <em>y</em>-axis is without any label. Again, one of the conveniences of the seaborn library is that it is built on top of matplotlib, so any plot created by seaborn can be further modified by matplotlib commands as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density, g/mL&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Metals&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3a9a72fb209620bf470d98bb9fafff07807828081e117d33450f919cdd433803.svg" src="../../_images/3a9a72fb209620bf470d98bb9fafff07807828081e117d33450f919cdd433803.svg" /></div>
</div>
</section>
<section id="swarm-plot">
<span id="id8"></span><h3>10.3.2 Swarm Plot<a class="headerlink" href="#swarm-plot" title="Permalink to this heading">#</a></h3>
<p>While the plots above are elegantly simple, they can make it difficult to accurately interpret the data when multiple data points are overlapping as can happen with larger numbers of data points. This obscures the quantity of points in various regions. One plot that alleviates this issue is the swarm plot which is almost identical to the strip plot except that points are no permitted to overlap to make the quantity more apparent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">swarmplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density, g/mL&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Metals&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cb8661a29ab7cdc6e2242696a56510e91cbe4eba29f037e331c8333591607858.svg" src="../../_images/cb8661a29ab7cdc6e2242696a56510e91cbe4eba29f037e331c8333591607858.svg" /></div>
</div>
</section>
<section id="violin-plot">
<span id="id9"></span><h3>10.3.3 Violin Plot<a class="headerlink" href="#violin-plot" title="Permalink to this heading">#</a></h3>
<p id="index-3">An additional option for understanding the density of points is the violin plot. By default, this plot renders a blob with the width representing the density of points at various regions. Inside the blob are miniature box plots (discussed in the next section) that provide more information about the distribution of data points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density, g/mL&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Metals&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3b059fa59b27f6045d91ca271dc1fb426064393a0a0d145d7ddc01eb1878fdab.svg" src="../../_images/3b059fa59b27f6045d91ca271dc1fb426064393a0a0d145d7ddc01eb1878fdab.svg" /></div>
</div>
</section>
<section id="box-plot">
<span id="id10"></span><h3>10.3.4 Box Plot<a class="headerlink" href="#box-plot" title="Permalink to this heading">#</a></h3>
<p id="index-4">The box plot is a classic plot in statistics for representing the distribution of data and can be easily generated in seaborn using the <code class="docutils literal notranslate"><span class="pre">boxplot()</span></code> function which works much the same way as the above categorical plots. There are three main components to a box plot. The center box contains lines marking the 25, 50, and 75 percentile regions. For example, the 75 percentile line is where 75% of the data points are below. The 50 percentile is also known as the median. The length of the box (i.e., from 25 percentile to 75 percentile) is known as the <em>inner quartile range (IQR)</em>.  Beyond the box are the bars known as <em>whiskers</em> which mark the range of the rest of the data points up to 1.5x the IQR. If a data point is beyond 1.5x the IQR, it is an outlier and is explicitly represented with a spot (Figure 1)</p>
<p><img alt="" src="../../_images/box_plot_diagram.svg" /></p>
<p><strong>Figure 1</strong> A box plot is composed of a box with lines at the 25<span class="math notranslate nohighlight">\(^{th}\)</span>, 50<span class="math notranslate nohighlight">\(^{th}\)</span>, and 75<span class="math notranslate nohighlight">\(^{th}\)</span> percentiles and whiskers that extend out to the rest of the non-outlier data points. If a data point is greater than 1.5 <span class="math notranslate nohighlight">\(\times\)</span> the inner quartile range from the 25<span class="math notranslate nohighlight">\(^{th}\)</span> or 75<span class="math notranslate nohighlight">\(^{th}\)</span> percentiles, it is an outlier represented by a dot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density, g/mL&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Metals&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/df17286cbca2136006bb632b1533a37b2ae3fba909dc1390268ae47c65157ec6.svg" src="../../_images/df17286cbca2136006bb632b1533a37b2ae3fba909dc1390268ae47c65157ec6.svg" /></div>
</div>
</section>
<section id="count-plot">
<span id="id11"></span><h3>10.3.5 Count Plot<a class="headerlink" href="#count-plot" title="Permalink to this heading">#</a></h3>
<p>The count plot represents the frequency of values for different categories. This is similar to a histogram plot except that a histogram’s <em>x</em>-axis is a continuous set of values while a count plot’s <em>x</em>-axis is made up of discrete categories. The <code class="docutils literal notranslate"><span class="pre">countplot()</span></code> function accepts a raw collection of responses, tallies them up, and plots them as a labeled bar plot. For example, if we have a data set of all the chemical elements up to rutherfordium (Rf) and their physical state under standard conditions, the function accepts the list of their physical states, counts them, and generates the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elem</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/elements_data.csv&#39;</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symbol</th>
      <th>AN</th>
      <th>row</th>
      <th>block</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>1</td>
      <td>s</td>
      <td>gas</td>
    </tr>
    <tr>
      <th>1</th>
      <td>He</td>
      <td>2</td>
      <td>1</td>
      <td>s</td>
      <td>gas</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Li</td>
      <td>3</td>
      <td>2</td>
      <td>s</td>
      <td>solid</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Be</td>
      <td>4</td>
      <td>2</td>
      <td>s</td>
      <td>solid</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>5</td>
      <td>2</td>
      <td>p</td>
      <td>solid</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">elem</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/815c62cd52b2aad24a9d8fe860c1a6392f7d1355a8c6cd9d9bc0ae235a07030f.svg" src="../../_images/815c62cd52b2aad24a9d8fe860c1a6392f7d1355a8c6cd9d9bc0ae235a07030f.svg" /></div>
</div>
<p>Like many plotting types in seaborn, the count plot can be further customized through keyword arguments and using other available data. One shortcoming of the above plot is that the states are listed in the order they first appear in the data set instead of based on disorder. We can assert a different order by providing the <code class="docutils literal notranslate"><span class="pre">order</span></code> argument as a list of how the states should appear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">elem</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gas&#39;</span><span class="p">,</span> <span class="s1">&#39;liquid&#39;</span><span class="p">,</span> <span class="s1">&#39;solid&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/306e9184c7178e27691693211d270e427f8b0b64fa75b81a635a1c54920e573e.svg" src="../../_images/306e9184c7178e27691693211d270e427f8b0b64fa75b81a635a1c54920e573e.svg" /></div>
</div>
<p>We can also set the color of each bar based on the valence orbital block by providing the <code class="docutils literal notranslate"><span class="pre">hue</span></code> argument with the name of the column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">elem</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e2d46db0080903262d9dfab46c2f13f94e95d0e14e0fabf41078c4e9f6d10d76.svg" src="../../_images/e2d46db0080903262d9dfab46c2f13f94e95d0e14e0fabf41078c4e9f6d10d76.svg" /></div>
</div>
</section>
</section>
<section id="distribution-plots">
<span id="id12"></span><h2>10.4 Distribution Plots<a class="headerlink" href="#distribution-plots" title="Permalink to this heading">#</a></h2>
<p>Seaborn provides a set of plotting types that represent the distribution of data. These are essentially extensions of the histogram plot but with extra features like additional dimensions, kernel density estimates, and generating grids of histogram plots.</p>
<section id="histplot">
<span id="id13"></span><h3>10.4.1 histplot<a class="headerlink" href="#histplot" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">histplot()</span></code> function is one of the most basic distribution plotting functions in seaborn. This function is similar to the matplotlib <code class="docutils literal notranslate"><span class="pre">plt.hist()</span></code> function except that seaborn brings a few extra options like setting the color (<code class="docutils literal notranslate"><span class="pre">hue=</span></code>) based on a particular column of data.</p>
<p>To demonstrate this, we will use the results of a one-dimensional stochastic diffusion simulation. During the individual steps of this simulation, each of a thousand simulated molecules are either moved to the right one unit, to the left one unit, or not moved at all. A random number generator dictates this movement as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>   <span class="c1"># locations of molecules</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">+=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of Molecules&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3698667b18303848e7908683d27d35250f498018e05ee7cc663419a522bebb74.svg" src="../../_images/3698667b18303848e7908683d27d35250f498018e05ee7cc663419a522bebb74.svg" /></div>
</div>
</section>
<section id="kde-plot">
<span id="id14"></span><h3>10.4.2 kde Plot<a class="headerlink" href="#kde-plot" title="Permalink to this heading">#</a></h3>
<p id="index-5">The <code class="docutils literal notranslate"><span class="pre">kdeplot()</span></code> function is very similar to the <code class="docutils literal notranslate"><span class="pre">histplot()</span></code> except that it fits the histogram with a kernel density estimates (kde) curve. This curve is basically just a smoothed curve over the data to help visualize the overall trend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of Molecules&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d7f4e59078d75509987c6953b83604c7f59f499dd00a53e3a9cb4da37b97696.svg" src="../../_images/6d7f4e59078d75509987c6953b83604c7f59f499dd00a53e3a9cb4da37b97696.svg" /></div>
</div>
</section>
<section id="jointplot-diffusion-simulation">
<span id="id15"></span><h3>10.4.3 jointplot (diffusion simulation)<a class="headerlink" href="#jointplot-diffusion-simulation" title="Permalink to this heading">#</a></h3>
<p>A joint plot can be described as a scatter plot with histograms on the sides providing additional information or clarification on the density of the data points. To demonstrate this, below is a two dimensional stochastic diffusion simulation and the results. The principles are the same as above except applied to two dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="mi">7000</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span><span class="mi">7000</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2543ef6b4d78b66d9b1203c379f0202522b69cefc515e609f48073e3f6cede30.svg" src="../../_images/2543ef6b4d78b66d9b1203c379f0202522b69cefc515e609f48073e3f6cede30.svg" /></div>
</div>
<p>One of the issues with this plot is that there are so many data points in the plot that it is difficult to determine the distribution/density inside the blanket of solid dots. The seaborn joint plot adds histograms to the side to help the viewer recognize where most of the data points reside.</p>
<p>The joint plot function, <code class="docutils literal notranslate"><span class="pre">sns.jointplot()</span></code>, takes two required arguments of the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> variables. While this function does not require the use of pandas or a DataFrame, it is convenient because the axis labels are pulled directly from the column headers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;X Distance, au&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;Y Distance, au&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>

<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X Distance, au&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y Distance, au&#39;</span><span class="p">],</span> 
              <span class="n">height</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">joint_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/zy/7y6kpdbx6p1ffrp1vtxy3ttc0000gn/T/ipykernel_1697/285915158.py:5: UserWarning: The figure layout has changed to tight
  plt.tight_layout()
</pre></div>
</div>
<img alt="../../_images/532319b9cee3e70d037f8fe125b6a3167b559349ff5ae4685baa54d381d997d4.svg" src="../../_images/532319b9cee3e70d037f8fe125b6a3167b559349ff5ae4685baa54d381d997d4.svg" /></div>
</div>
<p>There are numerous arguments to fine tune the joint plot. For example, the joint plot does not need to be a scatter plot with histograms. The density of the data points can be represented with hexagonal patches or <em>kernel density estimates (kde)</em>. The latter represents the density of points through contours and is a reoccurring option in other plotting functions in the seaborn library. It is worth noting that the kde plotting types take a little time to calculate, so expect a brief delay in generating these plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X Distance, au&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y Distance, au&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hex&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1485871795da9da659657f6e6081d916ad0df1b3331bb00106cacda436c38225.svg" src="../../_images/1485871795da9da659657f6e6081d916ad0df1b3331bb00106cacda436c38225.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X Distance, au&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y Distance, au&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bc4103a35ad1fdaa2c5958f68840bd360636e34ebcff5176649de7c10d083e6c.svg" src="../../_images/bc4103a35ad1fdaa2c5958f68840bd360636e34ebcff5176649de7c10d083e6c.svg" /></div>
</div>
</section>
</section>
<section id="pair-plot">
<span id="id16"></span><h2>10.5 Pair Plot<a class="headerlink" href="#pair-plot" title="Permalink to this heading">#</a></h2>
<p>The pair plot belongs to the category of distribution plots, but it is different enough to be worth addressing separately. A pair plot is designed to show the relationship among multiple variables by generating a grid of plots in a single figure. Each plot in the grid is a scatter plot showing the relationship between two of the variables on either axis with the exception of the plots in the diagonals. Because the diagonal plots are the intersection between a variable and itself, these are histograms showing the distributions of values for that variable. Pair plots are particularly useful for looking at new data to see if there are any trends worth investigating because this entire grid can be easily generated with a single <code class="docutils literal notranslate"><span class="pre">sns.pairplot()</span></code> function.</p>
<p>To demonstrate a pair plot, the file <em>periodic_trends.csv</em> contains physical data on non-noble gas elements in the first three rows of the periodic table. To quickly see how each of the columns of data relate to each other, we will generate a pair plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/periodic_trends.csv&#39;</span><span class="p">)</span>
<span class="n">per</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symbol</th>
      <th>AN</th>
      <th>EN</th>
      <th>row</th>
      <th>IE_kJ</th>
      <th>radius_pm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>H</td>
      <td>1</td>
      <td>2.1</td>
      <td>1</td>
      <td>1310</td>
      <td>38</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Li</td>
      <td>3</td>
      <td>1.0</td>
      <td>2</td>
      <td>520</td>
      <td>134</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Be</td>
      <td>4</td>
      <td>1.5</td>
      <td>2</td>
      <td>900</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>5</td>
      <td>2.0</td>
      <td>2</td>
      <td>800</td>
      <td>82</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C</td>
      <td>6</td>
      <td>2.5</td>
      <td>2</td>
      <td>1090</td>
      <td>77</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">per</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;AN&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">per</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>EN</th>
      <th>row</th>
      <th>IE_kJ</th>
      <th>radius_pm</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.1</td>
      <td>1</td>
      <td>1310</td>
      <td>38</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2</td>
      <td>520</td>
      <td>134</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.5</td>
      <td>2</td>
      <td>900</td>
      <td>90</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>2</td>
      <td>800</td>
      <td>82</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
      <td>2</td>
      <td>1090</td>
      <td>77</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">per</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/cerberus/miniconda3/lib/python3.11/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
</pre></div>
</div>
<img alt="../../_images/c1e29d5a376c8f21888b6ad29dcbe034f225ad08b20c5ed391c002a52fd05288.svg" src="../../_images/c1e29d5a376c8f21888b6ad29dcbe034f225ad08b20c5ed391c002a52fd05288.svg" /></div>
</div>
<p>The color can also be set based on any piece of information. Below, the row is used to dictate the color of each data point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">per</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/cerberus/miniconda3/lib/python3.11/site-packages/seaborn/axisgrid.py:118: UserWarning: The figure layout has changed to tight
  self._figure.tight_layout(*args, **kwargs)
</pre></div>
</div>
<img alt="../../_images/44b4eee4088c946dc8e1b861d1876277b7393df033ae15a3474a37f4eb0421d7.svg" src="../../_images/44b4eee4088c946dc8e1b861d1876277b7393df033ae15a3474a37f4eb0421d7.svg" /></div>
</div>
</section>
<section id="heat-map">
<span id="id17"></span><h2>10.6 Heat Map<a class="headerlink" href="#heat-map" title="Permalink to this heading">#</a></h2>
<p id="index-6">Heat maps are color representations of 2D grids of numerical data and are ideal for making large tables of values easily interpretable. As an example, we can import a table of bond dissociation energies (in kJ/mol) and visualize these data as a heat map. In the following pandas function call, the <code class="docutils literal notranslate"><span class="pre">index_col=0</span></code> tells pandas to apply the first column as column headers as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bde</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/bond_enthalpy_kJmol.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bde</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>H</th>
      <th>C</th>
      <th>N</th>
      <th>O</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>H</th>
      <td>436</td>
      <td>415</td>
      <td>390</td>
      <td>464</td>
      <td>569</td>
    </tr>
    <tr>
      <th>C</th>
      <td>415</td>
      <td>345</td>
      <td>290</td>
      <td>350</td>
      <td>439</td>
    </tr>
    <tr>
      <th>N</th>
      <td>390</td>
      <td>290</td>
      <td>160</td>
      <td>200</td>
      <td>270</td>
    </tr>
    <tr>
      <th>O</th>
      <td>464</td>
      <td>350</td>
      <td>200</td>
      <td>140</td>
      <td>160</td>
    </tr>
    <tr>
      <th>F</th>
      <td>569</td>
      <td>439</td>
      <td>270</td>
      <td>160</td>
      <td>160</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This grid of numerical values is difficult to quickly interpret, and if it were a larger table of data, it could become almost impossible to interpret in this form. We can plot the heat map using the <code class="docutils literal notranslate"><span class="pre">heatmapt()</span></code> function and feeding it the DataFrame. The function also accepts NumPy arrays, but without the index and column labels of a DataFrame, the axes will not be automatically labeled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">bde</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/61617b76b21275744e858713cf6b73c255f0226ad4a86c780f3dde04bd0113e1.svg" src="../../_images/61617b76b21275744e858713cf6b73c255f0226ad4a86c780f3dde04bd0113e1.svg" /></div>
</div>
<p>Now we have a color grid where the colors represent numerical values defined in a colorbar automatically displayed on the righthand side. This default color map can easily be customized through various arguments in the <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> function. One nice addition is to display the numerical values on the heat map by setting <code class="docutils literal notranslate"><span class="pre">annot=True</span></code>. If you choose to annotate the rectangles, you may need to use the <code class="docutils literal notranslate"><span class="pre">fmt=</span></code> parameter to dictate the format of the annotation labels. Some common formats are <code class="docutils literal notranslate"><span class="pre">d</span></code> for decimal, <code class="docutils literal notranslate"><span class="pre">f</span></code> for floating point, and <code class="docutils literal notranslate"><span class="pre">.2f</span></code> gives two places after the decimal place in a floating point number. If you want a different color map, this can be set using the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> argument and any <a class="reference external" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">matplotlib colormap</a> you want. Below, the annotation is turned on with the perceptually uniform viridis colormap. To further customize the colorbar, use the <code class="docutils literal notranslate"><span class="pre">cbar_kws=</span></code> argument that takes a dictionary of parameters found on the <a class="reference external" href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure.colorbar">matplotlib website</a>. For example, to add a label, use the <code class="docutils literal notranslate"><span class="pre">label</span></code> key and the label text is the dictionary value as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">bde</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
           <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Bond Enthalpy, kJ/mol&#39;</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/377297541c0e39600dc621e7fbbb00b3c30a61672f93a7367e0dd88736f1ca32.svg" src="../../_images/377297541c0e39600dc621e7fbbb00b3c30a61672f93a7367e0dd88736f1ca32.svg" /></div>
</div>
</section>
<section id="relational-plots">
<span id="id18"></span><h2>10.7 Relational Plots<a class="headerlink" href="#relational-plots" title="Permalink to this heading">#</a></h2>
<p>Relational plots are a new addition to the seaborn library as of version 0.9 and include seaborn’s functions for scatter and line plots. Of course, matplotlib does a nice job making scatter and line plots reasonably easy, but seaborn offers a few extra ease-of-use improvements upon matplotlib that may be worth something to you depending upon your needs.</p>
<section id="scatter-plots">
<span id="id19"></span><h3>10.7.1 Scatter Plots<a class="headerlink" href="#scatter-plots" title="Permalink to this heading">#</a></h3>
<p>One difference between seaborn and matplotlib in generating scatter and line plots is that seaborn allows the user to change the color, size, and marker styles of individual markers based on numerical values or text data. Matplotlib can also change the color and size of the markers but only based on numerical values, and to change the marker style, the  <code class="docutils literal notranslate"><span class="pre">plt.scatter()</span></code> function needs to be called a second time. Seaborn allows this whole process in a single function call.</p>
<p>Below, we are using the periodic trends data (<code class="docutils literal notranslate"><span class="pre">per</span></code>) imported in <a class="reference internal" href="#id16"><span class="std std-ref">section 10.5</span></a>. We can start with plotting the electronegativity (<code class="docutils literal notranslate"><span class="pre">EN</span></code>) versus the atomic radius (<code class="docutils literal notranslate"><span class="pre">radius_pm</span></code>) using the <code class="docutils literal notranslate"><span class="pre">sns.scatterplot()</span></code> function which takes many of the same basic arguments as plots we have seen so far with seaborn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;radius_pm&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;EN&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">per</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/09545ed4746d43d74d617d39df1f0e27bf2e8c2873523c8e3254f4fedfa5ff8f.svg" src="../../_images/09545ed4746d43d74d617d39df1f0e27bf2e8c2873523c8e3254f4fedfa5ff8f.svg" /></div>
</div>
<p>To modify the color, size, and marker style of the data points, use the <code class="docutils literal notranslate"><span class="pre">hue</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, and <code class="docutils literal notranslate"><span class="pre">marker</span></code> arguments. This allows additional information to be infused into a single plot. Note that the legend automatically appears on the plot. In addition, the colormap for the plot can be modified using the <code class="docutils literal notranslate"><span class="pre">palette</span></code> keyword argument and the name of any matplotlib colormap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;radius_pm&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;EN&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">per</span><span class="p">,</span>  <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;IE_kJ&#39;</span><span class="p">,</span> 
                <span class="n">size</span><span class="o">=</span><span class="s1">&#39;IE_kJ&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;winter&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a05f34879fb2c6900a13132b1a8225ea011626df67f6423de4854838b17dca30.svg" src="../../_images/a05f34879fb2c6900a13132b1a8225ea011626df67f6423de4854838b17dca30.svg" /></div>
</div>
</section>
<section id="line-plots">
<span id="id20"></span><h3>10.7.2 Line Plots<a class="headerlink" href="#line-plots" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">lineplot()</span></code> function in seaborn is somewhat similar to the <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> function in matplotlib except it also includes a number of extra features similar to those seen in other seaborn plotting functions. This includes the ability to change the plotting color and style based on additional information, easy visualization of confidence intervals, automatic generation of a legend, and others. To demonstrate the <code class="docutils literal notranslate"><span class="pre">lineplot()</span></code> function, we will import simulated kinetic data for a first-order chemical reaction run seven times (i.e., runs 0 <span class="math notranslate nohighlight">\(\rightarrow\)</span> 6).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kinetics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/kinetic_runs.csv&#39;</span><span class="p">)</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>[A]</th>
      <th>run</th>
      <th>[P]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.956279</td>
      <td>0.0</td>
      <td>0.043721</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.526316</td>
      <td>0.636978</td>
      <td>0.0</td>
      <td>0.363022</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.052632</td>
      <td>0.355690</td>
      <td>0.0</td>
      <td>0.644310</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31.578947</td>
      <td>0.161173</td>
      <td>0.0</td>
      <td>0.838827</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42.105263</td>
      <td>0.157420</td>
      <td>0.0</td>
      <td>0.842580</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;[A]&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">kinetics</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time, s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[A], M&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/454a26923ff9d60876e75a27166dd4a16c7d1698b86c334b8ec7007409d9569a.svg" src="../../_images/454a26923ff9d60876e75a27166dd4a16c7d1698b86c334b8ec7007409d9569a.svg" /></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[A]</span></code> was plotted versus <code class="docutils literal notranslate"><span class="pre">Time</span></code>, and the hue of each line was set to the <code class="docutils literal notranslate"><span class="pre">Run</span></code> number. The result is that each kinetic run is shown in a separate color. If the user is not concerned so much with seeing the individual runs but instead wants to see an average of each all the runs with some indication of the variation, the <code class="docutils literal notranslate"><span class="pre">lineplot()</span></code> function provides a default 95% confidence interval as is shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;[A]&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">kinetics</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time, s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[A], M&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bcc451295276b1e3d4c3e7474be2d6b8c79fef7c7235a6a6670770a4202b4d15.svg" src="../../_images/bcc451295276b1e3d4c3e7474be2d6b8c79fef7c7235a6a6670770a4202b4d15.svg" /></div>
</div>
<p>A confidence interval is only shown if there are multiple data points for each time. The confidence intervals can also be represented with error bars by setting <code class="docutils literal notranslate"><span class="pre">err_style</span> <span class="pre">=</span> <span class="pre">'bars'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;[A]&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">kinetics</span><span class="p">,</span> <span class="n">err_style</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time, s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[A], M&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f9416ec176530f051f4cfeae50ccd7a7fe39817c97fa57c6b27e342a17353d61.svg" src="../../_images/f9416ec176530f051f4cfeae50ccd7a7fe39817c97fa57c6b27e342a17353d61.svg" /></div>
</div>
</section>
</section>
<section id="internal-data-sets">
<span id="id21"></span><h2>10.8 Internal Data Sets<a class="headerlink" href="#internal-data-sets" title="Permalink to this heading">#</a></h2>
<p>Similar to a number of other Python libraries, seaborn brings with it data sets for users to experiment with. These are callable using the <code class="docutils literal notranslate"><span class="pre">sns.load_dataset()</span></code> function with the name of the data set as the argument. Below is a table describing a few of the available Seaborn data sets. This list may change, so you can use the <code class="docutils literal notranslate"><span class="pre">sns.get_dataset_names()</span></code> to see the most current list.</p>
<p><strong>Table 3</strong> A Few Data Sets Available in Seaborn</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">anscombe</span></code></p></td>
<td class="text-center"><p>Anscombe’s quartet data with four artificial data sets that exhibit the same mean, standard deviation, and linear regression among other statistical descriptors</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">car_crashes</span></code></p></td>
<td class="text-center"><p>Data on car crashes including mph above the speed limit among other information</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">exercise</span></code></p></td>
<td class="text-center"><p>Diet and exercise data</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">flights</span></code></p></td>
<td class="text-center"><p>Aircraft flight information including year, month, and number of passengers</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">iris</span></code></p></td>
<td class="text-center"><p>Ronald Fisher’s famous iris data set used frequently in machine learning classification examples</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">planets</span></code></p></td>
<td class="text-center"><p>Information on discovered planets</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">tips</span></code></p></td>
<td class="text-center"><p>Restaurant information including bill total, tip, and information about the client</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">titanic</span></code></p></td>
<td class="text-center"><p>Titanic survivor data set</p></td>
</tr>
</tbody>
</table>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Seaborn Website. <a class="reference external" href="https://seaborn.pydata.org/">https://seaborn.pydata.org/</a> (free resource)</p></li>
</ol>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<p>Complete the following exercises in a Jupyter notebook and seaborn library. Any data file(s) refered to in the problems can be found in the <a class="reference external" href="https://github.com/weisscharlesj/SciCompforChemists/tree/master/notebooks">data</a> folder in the same directory as this chapter’s Jupyter notebook. Alternatively, you can download a zip file of the data for this chapter from <a class="reference external" href="https://github.com/weisscharlesj/data_SciCompforChem">here</a> by selecting the appropriate chapter file and then clicking the <strong>Download</strong> button.</p>
<ol class="arabic">
<li><p>Import the file <strong>linear_data.csv</strong> and visualize it using a <a class="reference internal" href="#id3"><span class="std std-ref">regression plot</span></a>.</p></li>
<li><p>Import the file titled <strong>ir_carbonyl.csv</strong> and visualize the carbonyl stretching frequencies using a seaborn <a class="reference internal" href="#id6"><span class="std std-ref">categorical plot</span></a>. Represent the different molecules with different colors.</p></li>
<li><p>Import the file titled <strong>ir_carbonyl.csv</strong> containing carbonyl stretches of ketones and aldehydes.</p>
<p>a) Separate the ketones and aldehydes values into individual Series.</p>
<p>b) Visualize the distribution of both ketone and aldehyde carbonyl stretches using a <a class="reference internal" href="#id14"><span class="std std-ref">kde plot</span></a>.</p>
</li>
<li><p>Import the <strong>elements_data.csv</strong> file and generate a <a class="reference internal" href="#id11"><span class="std std-ref">count plot</span></a> showing the number of elements in each block of the periodic table (i.e., s, p, d, f).</p></li>
<li><p>The following equation is Plank’s law which describes the relationship between the radiation intensity(<span class="math notranslate nohighlight">\(M\)</span>) with respect to wavelength (<span class="math notranslate nohighlight">\(\lambda\)</span>) and temperature (<span class="math notranslate nohighlight">\(T\)</span>).</p>
<div class="math notranslate nohighlight">
\[ M = \frac{2 \pi hc^2}{\lambda ^5 (e^{hc/\lambda kT} - 1)} \]</div>
<p>Import the data called <em><strong>blackbody.csv</strong></em> containing intensities at various temperatures and wavelengths based on Plank’s law. Generate a plot of intensity versus wavelength using the <code class="docutils literal notranslate"><span class="pre">lineplot()</span></code> function, and display the different temperatures as different colors.</p>
</li>
<li><p>Import the file <strong>ionization_energies.csv</strong> showing the first four ionization energies for a number of elements. Plot this grid of data as a <a class="reference internal" href="#id17"><span class="std std-ref">heat map</span></a>. Include labels in each cell using the <code class="docutils literal notranslate"><span class="pre">annot=</span></code> argument.</p></li>
<li><p>Import the file <strong>ROH_data_small.csv</strong> and plot visualize how boiling point (bp), molecular weight (MW), degree, and whether a compound is aliphatic are correlated using a <a class="reference internal" href="#id16"><span class="std std-ref">pairplot</span></a>.</p></li>
<li><p>The following code generates the radial probability plot for hydrogen atomic orbitals for n = 1-4 (see <a class="reference internal" href="../chapter_03/chap_03_notebook.html#id2"><span class="std std-ref">section 3.1</span></a>) and determines the radius of maximum probability (see <a class="reference internal" href="../chapter_06/chap_06_notebook.html#id3"><span class="std std-ref">section 6.1.1</span></a>). These values are combined into a pandas DataFrame called <code class="docutils literal notranslate"><span class="pre">max_prob</span></code> where the rows are the principle quantum numbers and columns are the angular quantum numbers. Display the DataFrame using a heatmap. Your heatmap should include numerical labels on each colored block on the heatmap, and you should select a non-default, perceptually uniform colormap for your colormap.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.physics.hydrogen</span> <span class="kn">import</span> <span class="n">R_nl</span>

<span class="n">R</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">max_radii</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">shell_max_radii</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">R_nl</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">shell_max_radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">max_radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shell_max_radii</span><span class="p">)</span>    
    
<span class="n">columns</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">max_prob</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">max_radii</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">max_prob</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/chapter_10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../chapter_09/chap_09_notebook.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 9: Simulations</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter_11/chap_11_notebook.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 11: Nuclear Magnetic Resonance with NMRglue</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn-plot-types">10.1 Seaborn Plot Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-plots">10.2 Regression Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regplot">10.2.1 regplot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lmplot">10.2.2 lmplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-plots">10.3 Categorical Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#strip-plot">10.3.1 Strip Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swarm-plot">10.3.2 Swarm Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#violin-plot">10.3.3 Violin Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#box-plot">10.3.4 Box Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-plot">10.3.5 Count Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-plots">10.4 Distribution Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">10.4.1 histplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kde-plot">10.4.2 kde Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jointplot-diffusion-simulation">10.4.3 jointplot (diffusion simulation)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pair-plot">10.5 Pair Plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-map">10.6 Heat Map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-plots">10.7 Relational Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-plots">10.7.1 Scatter Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#line-plots">10.7.2 Line Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-data-sets">10.8 Internal Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Charles J. Weiss
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2017-2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Scientific Computing for Chemists with Python is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>