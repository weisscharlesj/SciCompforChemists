
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 8: Mathematics &#8212; Scientific Computing for Chemists with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/chapter_08/chap_08_notebook';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 9: Simulations" href="../chapter_09/chap_09_notebook.html" />
    <link rel="prev" title="Chapter 7: Image Processing &amp; Analysis" href="../chapter_07/chap_07_notebook.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../introduction/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Scientific Computing for Chemists with Python - Home"/>
    <img src="../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt="Scientific Computing for Chemists with Python - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction/intro.html">
                    Scientific Computing for Chemists with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic Scientific Computing Skills</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_00/chap_00_notebook.html">Chapter 0: Python &amp; Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_01/chap_01_notebook.html">Chapter 1: Basic Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_02/chap_02_notebook.html">Chapter 2: Intermediate Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_03/chap_03_notebook.html">Chapter 3: Plotting with Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_04/chap_04_notebook.html">Chapter 4: NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_05/chap_05_notebook.html">Chapter 5: Pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Topics &amp; Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter_06/chap_06_notebook.html">Chapter 6: Signal &amp; Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_07/chap_07_notebook.html">Chapter 7: Image Processing &amp; Analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 8: Mathematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_09/chap_09_notebook.html">Chapter 9: Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_10/chap_10_notebook.html">Chapter 10: Plotting with Seaborn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_11/chap_11_notebook.html">Chapter 11: Nuclear Magnetic Resonance with nmrglue and nmrsim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_12/chap_12_notebook.html">Chapter 12: Machine Learning using Scikit-Learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_13/chap_13_notebook.html">Chapter 13: Command Line &amp; Spyder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_14/chap_14_notebook.html">Chapter 14: Optimization and Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_15/chap_15_notebook.html">Chapter 15: Cheminformatics with RDKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_16/chap_16_notebook.html">Chapter 16: Bioinformatics with Biopython and Nglview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix_00/appendix_00_notebook.html">Appendix 0: Ipython Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/weisscharlesj/SciCompforChemists/issues/new?title=Issue%20on%20page%20%2Fnotebooks/chapter_08/chap_08_notebook.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/chapter_08/chap_08_notebook.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 8: Mathematics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-mathematics">8.1 Symbolic Mathematics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbols">8.1.1 Symbols</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pretty-printing">8.1.2 Pretty Printing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sympy-mathematical-functions">8.1.3 SymPy Mathematical Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algebra-in-sympy">8.2 Algebra in SymPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomial-expansion-and-factoring">8.2.1 Polynomial Expansion and Factoring</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplification">8.2.2 Simplification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-equations">8.2.3 Solving Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-ice-table">8.2.4 Equilibrium ICE Table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitutions">8.2.5 Substitutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">8.3 Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-operations-with-arrays">8.3.1 Mathematical Operations with Arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-systems-of-equations">8.3.2 Solving Systems of Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#least-square-minimization-by-the-normal-equation">8.3.3 Least-Square Minimization by the Normal Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balancing-chemical-equations">8.3.4 Balancing Chemical Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eigenvalues-and-eigenvectors">8.3.5 Eigenvalues and Eigenvectors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculus">8.4 Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differentiation">8.4.1 Differentiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-functions">8.4.2 Integration of Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-sampled-data">8.4.3 Integrating Sampled Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-ordinary-differential-equations">8.4.4 Integrating Ordinary Differential Equations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-in-python">8.5 Mathematics in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-8-mathematics">
<span id="id1"></span><h1>Chapter 8: Mathematics<a class="headerlink" href="#chapter-8-mathematics" title="Link to this heading">#</a></h1>
<div class="cell tag_remove-input docutils container">
</div>
<p>We have already been doing math throughout this book as Python is fundamentally performing mathematical operations through arithmetic, calculus, algebra, and Boolean logic among others, but this chapter will dive deeper into symbolic mathematics, matrix operations, and integration. Some of this chapter will rely on SciPy and NumPy, but for the symbolic mathematics, we will use the popular <a class="reference external" href="http://www.sympy.org/en/index.html">SymPy  library</a>.</p>
<p>SymPy is the main library in the SciPy ecosystem for performing symbolic mathematics, and it is suitable for a wide audience from high school students to scientific researchers. It is something like a free, open source Mathematica substitute that is built on Python and is arguably more accessible in terms of cost and ease of acquisition. All of the following SymPy code relies on the following import which makes all of the SymPy modules available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
</pre></div>
</div>
</div>
</div>
<section id="symbolic-mathematics">
<span id="id2"></span><h2>8.1 Symbolic Mathematics<a class="headerlink" href="#symbolic-mathematics" title="Link to this heading">#</a></h2>
<p>SymPy differentiates itself from the rest of Python and SciPy stack in that it returns exact or symbolic results whereas Python, SciPy, and NumPy will generate numerical answers which may not be exact. That is to say, not only does SymPy perform symbolic mathematical operations, but even if the result of an operation has a numerical answer, SymPy will return the value in exact form. For example, if we take the square root of 2 using the <code class="docutils literal notranslate"><span class="pre">math</span></code> module, we get a numerical value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4142135623730951
</pre></div>
</div>
</div>
</div>
<p>The value returned is a rounded approximation of the true answer. In contrast, if the same operation is performed using SymPy, we get a different result.</p>
<div class="cell docutils container" id="index-0">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \sqrt{2}\]</div>
</div>
</div>
<p>Because the square root of two is an irrational number, it cannot be represented exactly by a decimal, so SymPy leaves it in the exact form of <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>. If we absolutely need a numerical value, SymPy can be instructed to evaluate an imprecise, numerical value using the <code class="docutils literal notranslate"><span class="pre">evalf()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 1.4142135623731\]</div>
</div>
</div>
<p>One of the advantages of <code class="docutils literal notranslate"><span class="pre">evalf()</span></code> is that it also accepts a significant figures argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 1.41421356237309504880168872421\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 3.141592653589793238462643383279502884197\]</div>
</div>
</div>
<section id="symbols">
<span id="id3"></span><h3>8.1.1 Symbols<a class="headerlink" href="#symbols" title="Link to this heading">#</a></h3>
<p id="index-1">Before SymPy will accept a variable as a symbol, the variable must first be defined as a SymPy symbol using the <code class="docutils literal notranslate"><span class="pre">symbols()</span></code> function. It takes one or more symbols at a time and attaches them to variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x c m&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x\]</div>
</div>
</div>
<p>There is no value attached to <code class="docutils literal notranslate"><span class="pre">x</span></code> as it is a symbol, so now it can be used to generate symbolic mathematical expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c^{2} m\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c^{4} m^{2}\]</div>
</div>
</div>
<p>SymPy can also be used to solve expressions for numerical values, and there are times when ony certain ranges or types of numerical values make physical sense. For example, concentrations should only be nonnegative and real values. To constrain solutions of an expression to positive and nonnegative values, additional arguments known as predicates can be added to the <code class="docutils literal notranslate"><span class="pre">sympy.symbols()</span></code> function such as <code class="docutils literal notranslate"><span class="pre">nonnegative=True</span></code> or <code class="docutils literal notranslate"><span class="pre">real=True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To see what constrains were placed on a variable, use the <code class="docutils literal notranslate"><span class="pre">assumptions()</span></code> function demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.core.assumptions</span> <span class="kn">import</span> <span class="n">assumptions</span>
<span class="n">assumptions</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;real&#39;: True,
 &#39;extended_real&#39;: True,
 &#39;finite&#39;: True,
 &#39;hermitian&#39;: True,
 &#39;imaginary&#39;: False,
 &#39;infinite&#39;: False,
 &#39;commutative&#39;: True,
 &#39;complex&#39;: True,
 &#39;nonnegative&#39;: True,
 &#39;extended_negative&#39;: False,
 &#39;negative&#39;: False,
 &#39;extended_nonnegative&#39;: True}
</pre></div>
</div>
</div>
</div>
<p>A selection of predicate arguments for the <code class="docutils literal notranslate"><span class="pre">sympy.symbols()</span></code> function are listed below in Table 1. This is not an exhaustive list, but a complete list can be found on the <a class="reference external" href="https://docs.sympy.org/latest/guides/assumptions.html#gotcha-symbols-with-different-assumptions">SymPy website</a> under “Predicates.”</p>
<p><strong>Table 1</strong> Predicates for<code class="docutils literal notranslate"><span class="pre">sympy.symbols()</span></code></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">positive</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">negative</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">imaginary</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">real</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">complex</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">finite</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">infinite</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">nonzero</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">rational</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">irrational</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">even</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">prime</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">composite</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="pretty-printing">
<span id="id4"></span><h3>8.1.2 Pretty Printing<a class="headerlink" href="#pretty-printing" title="Link to this heading">#</a></h3>
<p>Depending upon settings and version of SymPy, the output may look like Python equations which are not always the easiest to read. If so, you can turn on <em>pretty printing</em>, shown below, which will instruct SymPy to render the expressions in more traditional mathematical representations that you might see in a math textbook. More recent versions of SymPy make this unnecessary, however, as it generates more traditional mathematical representations by default.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="sympy-mathematical-functions">
<span id="id5"></span><h3>8.1.3 SymPy Mathematical Functions<a class="headerlink" href="#sympy-mathematical-functions" title="Link to this heading">#</a></h3>
<p>Similar to the <code class="docutils literal notranslate"><span class="pre">math</span></code> Python module, SymPy contains an assortment of standard mathematical operators such as square root and trigonometric functions. A table of common functions is below. Some of the functions start with a capital letter such as <code class="docutils literal notranslate"><span class="pre">Abs()</span></code>. This is important so that they do not collide with native Python functions if SymPy is imported into the global namespace.</p>
<p><strong>Table 2</strong> Common SymPy Functions</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Abs()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sin()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">cos()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">tan()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">cot()</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sec()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">csc()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">asin()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">acos()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">atan()</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">ceiling()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">floor()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Min()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">Max()</span></code></p></td>
<td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sqrt()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>It is important to note that any mathematical function operating on a symbol needs to be from the SymPy library. For example, using a <code class="docutils literal notranslate"><span class="pre">math.cos()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">math</span></code> Python modeule will result in an error.</p>
</section>
</section>
<section id="algebra-in-sympy">
<span id="id6"></span><h2>8.2 Algebra in SymPy<a class="headerlink" href="#algebra-in-sympy" title="Link to this heading">#</a></h2>
<p>SymPy is quite capable at algebraic operations and is knowledgeable of common identities such as <span class="math notranslate nohighlight">\(sin(x)^2 + cos(x)^2 = 1\)</span>, but before we proceed with doing algebra in SymPy, we need to cover some basic algebraic methods. These are provided in Table 3 which includes polynomial expansion and factoring, expression simplification, and solving equations. The subsequent sections demonstrate each of these.</p>
<p><strong>Table 3</strong> Common Algebraic Methods</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Method</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sympy.expand()</span></code></p></td>
<td class="text-left"><p>Expand polynomials</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sympy.factor()</span></code></p></td>
<td class="text-left"><p>Factors polynomials</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sympy.simplify()</span></code></p></td>
<td class="text-left"><p>Simplifies the expression</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sympy.solve()</span></code></p></td>
<td class="text-left"><p>Equates the expression to zero and solves for the requested variable</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">sympy.subs()</span></code></p></td>
<td class="text-left"><p>Substitutes a variable for a value, expression, or another variable</p></td>
</tr>
</tbody>
</table>
</div>
<section id="polynomial-expansion-and-factoring">
<span id="id7"></span><h3>8.2.1 Polynomial Expansion and Factoring<a class="headerlink" href="#polynomial-expansion-and-factoring" title="Link to this heading">#</a></h3>
<p id="index-2">When dealing with polynomials, expansion and factoring are common operations that can be tedious and time-consuming by hand. SymPy makes these quick and easy. For example, we can expand the expression <span class="math notranslate nohighlight">\((x - 1)(3x + 2)\)</span> as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 3 x^{2} - x - 2\]</div>
</div>
</div>
<p>The process can be reversed by factoring the polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left(x - 1\right) \left(3 x + 2\right)\]</div>
</div>
</div>
</section>
<section id="simplification">
<span id="id8"></span><h3>8.2.2 Simplification<a class="headerlink" href="#simplification" title="Link to this heading">#</a></h3>
<p>SymPy may not always return a mathematical expression into the simplest form. Below is an expression with a simpler form, and if we feed this into SymPy, it is not automatically simplified.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">15</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 3 x^{2} - 4 x - \frac{15}{x - 3}\]</div>
</div>
</div>
<p>However, if we instruct SymPy to simplify the expression using the <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> method, it will make a best attempt at finding a simpler form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 3 x + 5\]</div>
</div>
</div>
</section>
<section id="solving-equations">
<span id="id9"></span><h3>8.2.3 Solving Equations<a class="headerlink" href="#solving-equations" title="Link to this heading">#</a></h3>
<p id="index-3">SymPy can also solve equations for an unknown variable using the <code class="docutils literal notranslate"><span class="pre">solve()</span></code> function. The function requires a single expression that is equal to zero. For example, the following solves for <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(x^2 + 1.4x – 5.76 = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">5.76</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.20000000000000, 1.80000000000000]
</pre></div>
</div>
</div>
</div>
</section>
<section id="equilibrium-ice-table">
<span id="id10"></span><h3>8.2.4 Equilibrium ICE Table<a class="headerlink" href="#equilibrium-ice-table" title="Link to this heading">#</a></h3>
<p id="index-4">A common chemical application of the above algebraic operations is solving equilibrium problems using the ICE (Initial, Change, and Equilibrium) method. As a penultimate step, the mathematical expressions are inserted into the equilibrium expression and often result in a polynomial equation. Below is an example problem with completed ICE table and equilibrium expression.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>2 NH<span class="math notranslate nohighlight">\(_3\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(\rightleftharpoons\)</span></p></th>
<th class="head text-center"><p>3 H<span class="math notranslate nohighlight">\(_2\)</span> (g)</p></th>
<th class="head text-center"><p>+</p></th>
<th class="head text-left"><p>N<span class="math notranslate nohighlight">\(_2\)</span> (g)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Initial</p></td>
<td class="text-center"><p>0.60 M</p></td>
<td class="text-center"><p></p></td>
<td class="text-center"><p>0.60 M</p></td>
<td class="text-center"><p></p></td>
<td class="text-left"><p>0.00 M</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Change, <span class="math notranslate nohighlight">\(\Delta\)</span></p></td>
<td class="text-center"><p>-2x</p></td>
<td class="text-center"><p></p></td>
<td class="text-center"><p>+3x</p></td>
<td class="text-center"><p></p></td>
<td class="text-left"><p>+x</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Equilibrium</p></td>
<td class="text-center"><p>0.60 - 2x</p></td>
<td class="text-center"><p></p></td>
<td class="text-center"><p>0.60 + 3x</p></td>
<td class="text-center"><p></p></td>
<td class="text-left"><p>x</p></td>
</tr>
</tbody>
</table>
</div>
<div class="math notranslate nohighlight">
\[ K_c = 3.44 = \frac{[N_2][H_2]^3}{[NH_3]^2} = \frac{(x)(0.60 + 3x)^3}{(0.60 - 2x)^2}  \]</div>
<p>To expand the right portion of the equation, we can use the <code class="docutils literal notranslate"><span class="pre">expand()</span></code> method. Notice that the variable <code class="docutils literal notranslate"><span class="pre">x</span></code> has been constrained below to real (<code class="docutils literal notranslate"><span class="pre">real=True</span></code>) and nonnegative (<code class="docutils literal notranslate"><span class="pre">nonnegative=True</span></code>) values here. This is because in this example, <code class="docutils literal notranslate"><span class="pre">x</span></code> is one of the equilibrium concentrations, so imaginary and negative values would make no physical sense. These constraints may not be appropriate for other examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.60</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.60</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{27 x^{4}}{4 x^{2} - 2.4 x + 0.36} + \frac{16.2 x^{3}}{4 x^{2} - 2.4 x + 0.36} + \frac{3.24 x^{2}}{4 x^{2} - 2.4 x + 0.36} + \frac{0.216 x}{4 x^{2} - 2.4 x + 0.36}\]</div>
</div>
</div>
<p>This is probably not what you were expecting or hoping for. The polynomial has been expanded, but the result is still a fraction. We can instruct SymPy to simplify the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{x \left(27 x^{3} + 16.2 x^{2} + 3.24 x + 0.216\right)}{4 x^{2} - 2.4 x + 0.36}\]</div>
</div>
</div>
<p>This is much better. Ultimately, we want to solve for <span class="math notranslate nohighlight">\(x\)</span>, but the <code class="docutils literal notranslate"><span class="pre">solve()</span></code> function requires an expression that equals zero. We can achieve this by subtracting 3.44.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">expr</span> <span class="o">-</span> <span class="mf">3.44</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.170006841512893]
</pre></div>
</div>
</div>
</div>
<p>If the variable <code class="docutils literal notranslate"><span class="pre">x</span></code> was <em>not</em> constrained to real and nonnegative values, a fourth-order polynomial would return four solutions, with only one making physical sense. Because we did constrain <code class="docutils literal notranslate"><span class="pre">x</span></code>, the <code class="docutils literal notranslate"><span class="pre">solve()</span></code> function conveniently only returns 0.17.</p>
</section>
<section id="substitutions">
<span id="id11"></span><h3>8.2.5 Substitutions<a class="headerlink" href="#substitutions" title="Link to this heading">#</a></h3>
<p>Another common algebreic operation is the substitution of one variable in an expression for another variable, expression, or value. This is accomplished in SymPy using the <code class="docutils literal notranslate"><span class="pre">sympy.subs()</span></code> function which requires two pieces of information - the variable being replaced (<code class="docutils literal notranslate"><span class="pre">x_old</span></code>) and the new varible, expression, or value (<code class="docutils literal notranslate"><span class="pre">x_new</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x_old</span><span class="p">,</span> <span class="n">x_new</span><span class="p">)</span>
</pre></div>
</div>
<p>As an example, let’s determine the composition of a mixture of two enantiomers based on the net optical rotation of this mixture. The net rotation of a mixture, <span class="math notranslate nohighlight">\([\alpha]_{mix}\)</span>, of two enantiomers <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> is described below as the linear combination of rotations of each enantiomer where <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> are the mole fractions and [<span class="math notranslate nohighlight">\(\alpha\)</span>]<span class="math notranslate nohighlight">\(_d\)</span> and [<span class="math notranslate nohighlight">\(\alpha\)</span>]<span class="math notranslate nohighlight">\(_l\)</span> are the specific rotations of each enantiomer.</p>
<div class="math notranslate nohighlight">
\[ [\alpha]_{mix} = d[\alpha]_d + l[\alpha]_l \]</div>
<p>If we have a mixture where the net rotation is +8.3<span class="math notranslate nohighlight">\(^\circ\)</span> and the <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span> enantiomers have specific rotations of +32.4<span class="math notranslate nohighlight">\(^\circ\)</span> and -32.4<span class="math notranslate nohighlight">\(^\circ\)</span>, respectively, we can insert these values into the above equation to get the below result.</p>
<div class="math notranslate nohighlight">
\[ +8.3^\circ = d(+32.4^\circ) + l(-32.4^\circ) \]</div>
<p>We now have one equation with two unknowns, <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(l\)</span>. To solve this, we need a second equation which we can generate by recognizing that the sum of the fractions equals 1 just as the sum of percentages total to 100%.</p>
<div class="math notranslate nohighlight">
\[ d + l = 1 \]</div>
<p>We rearrange the above equation to <span class="math notranslate nohighlight">\(d = 1 - l\)</span> and now need to substitute this expression for <code class="docutils literal notranslate"><span class="pre">d</span></code> in the first equation. We can let SymPy perform this substitution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;d, l&#39;</span><span class="p">)</span>

<span class="n">net</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="mf">32.4</span> <span class="o">+</span> <span class="n">l</span> <span class="o">*</span> <span class="o">-</span><span class="mf">32.4</span><span class="p">)</span> <span class="o">-</span> <span class="mf">8.3</span>
<span class="n">net_new</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span>
<span class="n">net_new</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 24.1 - 64.8 l\]</div>
</div>
</div>
<p>We can then solve this expression for <span class="math notranslate nohighlight">\(l\)</span> using the <code class="docutils literal notranslate"><span class="pre">sympy.solve()</span></code> function being that it equals zero in the current form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">net_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.371913580246914]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sympy.subs()</span></code> function can also substitute variables for numberical values. If we want to see the net rotation is <span class="math notranslate nohighlight">\(l = 0.6\)</span> and <span class="math notranslate nohighlight">\(d = 0.4\)</span>, we can run the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">subs</span><span class="p">([[</span><span class="n">l</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle -14.78\]</div>
</div>
</div>
</section>
</section>
<section id="matrices">
<span id="id12"></span><h2>8.3 Matrices<a class="headerlink" href="#matrices" title="Link to this heading">#</a></h2>
<p id="index-5">Matrices are an efficient method of working with larger amounts of data. When done by hand, as is the case in many classroom environments, it is likely slow and painful. The beauty and power of matrices is when they are used with computers because they simplify bulk calculations. SymPy, SciPy, and NumPy all support matrix operations. If you need to do symbolic math, SymPy should be your go-to, but for the numerical calculations that we will do here, we will use NumPy’s <code class="docutils literal notranslate"><span class="pre">linalg</span></code> module.</p>
<p>SciPy and NumPy both offer a matrix object, but the SciPy official documentation discourages their use as they offer little advantage over a standard NumPy array. We will stick with NumPy arrays here, but below demonstrates creating a matrix object if you feel that you absolutely must use them. See the <a class="reference external" href="https://numpy.org/doc/stable/reference/routines.matlib.html">NumPy documentation page</a> for further details on attributes and methods for this class of object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>matrix([[1, 8],
        [3, 2]])
</pre></div>
</div>
</div>
</div>
<section id="mathematical-operations-with-arrays">
<span id="id13"></span><h3>8.3.1 Mathematical Operations with Arrays<a class="headerlink" href="#mathematical-operations-with-arrays" title="Link to this heading">#</a></h3>
<p>Being that we are using NumPy arrays, the standard mathematical operations use the <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">‒</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>, and <code class="docutils literal notranslate"><span class="pre">**</span></code> operators as demonstrated in <a class="reference internal" href="../chapter_04/chap_04_notebook.html#id17"><span class="std std-ref">chapter 4</span></a>. There are a few other operations and methods, however, that are important for matrices such as calculating the inverse, determinant, transpose, and dot product. For these operations, we have the following methods provided by NumPy’s <code class="docutils literal notranslate"><span class="pre">linalg</span></code> module, Table 4, which are demonstrated in the following sections.</p>
<p id="index-6"><strong>Table 4</strong> Common <code class="docutils literal notranslate"><span class="pre">np.linalg</span></code> Methods</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Method</p></th>
<th class="head text-left"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.dot()</span></code></p></td>
<td class="text-left"><p>Calculates the dot product</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.inv()</span></code></p></td>
<td class="text-left"><p>Returns the inverse of an array (if it exists)</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.pinv()</span></code></p></td>
<td class="text-left"><p>Returns the Moore-Penrose <a class="reference internal" href="#singular-matrix"><span class="std std-ref">pseudoinverse</span></a> of an array</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.det()</span></code></p></td>
<td class="text-left"><p>Returns the determinant of an array</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code></p></td>
<td class="text-left"><p>Solves a system of linear equations</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">np.linalg.lstsq()</span></code></p></td>
<td class="text-left"><p>Returns <a class="reference internal" href="#singular-matrix"><span class="std std-ref">approximate solution</span></a> to a system of linear equations</p></td>
</tr>
</tbody>
</table>
</div>
<p>In addition, it is worth reiterating that there is a general NumPy array method <code class="docutils literal notranslate"><span class="pre">transpose()</span></code> that will transpose or rotate the array around the diagonal. There is a convenient <code class="docutils literal notranslate"><span class="pre">array.T</span></code> shortcut that is often used. See <a class="reference internal" href="../chapter_04/chap_04_notebook.html#id10"><span class="std std-ref">section 4.2.3</span></a> for details.</p>
</section>
<section id="solving-systems-of-equations">
<span id="id14"></span><h3>8.3.2 Solving Systems of Equations<a class="headerlink" href="#solving-systems-of-equations" title="Link to this heading">#</a></h3>
<p id="index-7">Solving systems of equations can be a tedious process by hand, but solving them using matrices can save time and effort. Let us say we want to solve the following system of equations for <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>.</p>
<div class="math notranslate nohighlight">
\[ 6x + 10y + −5z = 21 \]</div>
<div class="math notranslate nohighlight">
\[ 2x + 7y + z = 13 \]</div>
<div class="math notranslate nohighlight">
\[ −10x + −11y + 11z = −21 \]</div>
<p>These equations can be rewritten in matrix or array form as follows with the left matrix holding the coefficients.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{ccc} 6 &amp; 10 &amp; -5 \\ 2 &amp; 7 &amp; 1 \\ -10 &amp; -11 &amp; 11 \end{array} \right]
\cdot
\left[ \begin{array}{c} x \\ y \\ z \end{array} \right]
=
\left[ \begin{array}{c} 21 \\ 13 \\ -21 \end{array} \right] \end{split}\]</div>
<p>We will call the first array <code class="docutils literal notranslate"><span class="pre">M</span></code>, the second <code class="docutils literal notranslate"><span class="pre">X</span></code>, and the third <code class="docutils literal notranslate"><span class="pre">y</span></code>, so we get</p>
<div class="math notranslate nohighlight">
\[ M \cdot X = y \]</div>
<p>We can solve for X by multiplying (<em>dot product</em>) both sides by the inverse of M, <span class="math notranslate nohighlight">\(M^{-1}\)</span>. Anything multiplied by its inverse is the identity, so <span class="math notranslate nohighlight">\(M^{-1} \cdot M\)</span> is the identity matrix and can be ignored.</p>
<div class="math notranslate nohighlight">
\[ M^{-1} \cdot M \cdot X = M^{-1} \cdot y \]</div>
<div class="math notranslate nohighlight">
\[ X = M^{-1} \cdot y \]</div>
<p id="index-9"><span id="index-8"></span>To get the inverse of a matrix or array, we can use the <code class="docutils literal notranslate"><span class="pre">np.linalg.inv()</span></code> function provided by NumPy’s linear algebra module and use the <code class="docutils literal notranslate"><span class="pre">dot()</span></code> method to take the dot product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
               <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 2., 1.])
</pre></div>
</div>
</div>
</div>
<p>This means that <span class="math notranslate nohighlight">\(x\)</span> = 1, <span class="math notranslate nohighlight">\(y\)</span> = 2, and <span class="math notranslate nohighlight">\(z\)</span> = 1.</p>
<p>As a chemical example, we can use the above mathematics and Beer’s law to determine the concentration of three light absorbing analytes in a solution. The mathematical representation of Beer’s law is written below where <span class="math notranslate nohighlight">\(A\)</span> is absorbance (unitless), <span class="math notranslate nohighlight">\(b\)</span> is path length (cm), <span class="math notranslate nohighlight">\(C\)</span> is concentration (M), and <span class="math notranslate nohighlight">\(\epsilon\)</span> is the molar absorptivity (cm<span class="math notranslate nohighlight">\(^{-1}\)</span>M<span class="math notranslate nohighlight">\(^{-1}\)</span>). The latter value is analyte dependent.</p>
<div class="math notranslate nohighlight">
\[ A = \epsilon bC \]</div>
<p>For a path length of 1.0 cm, which is quite common, the equation simplifies down to:</p>
<div class="math notranslate nohighlight">
\[ A = \epsilon C \]</div>
<p>When there are three analytes, <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>, the absorption of light at a given wavelength equals the sum of the individual absorptions.</p>
<div class="math notranslate nohighlight">
\[ A = \epsilon_x C_x +  \epsilon_y C_y +  \epsilon_z C_z \]</div>
<p>If we measure the absorbance of a three analyte solution at three different wavelengths (<span class="math notranslate nohighlight">\(\lambda\)</span>), we get the following three equations.</p>
<div class="math notranslate nohighlight">
\[ A_{\lambda 1} = \epsilon_{x \lambda 1} C_x +  \epsilon_{y \lambda 1} C_y +  \epsilon_{z \lambda 1} C_z \]</div>
<div class="math notranslate nohighlight">
\[ A_{\lambda 2} = \epsilon_{x \lambda 2} C_x +  \epsilon_{y \lambda 2} C_y +  \epsilon_{z \lambda 2} C_z \]</div>
<div class="math notranslate nohighlight">
\[ A_{\lambda 3} = \epsilon_{x \lambda 3} C_x +  \epsilon_{y \lambda 3} C_y +  \epsilon_{z \lambda 3} C_z \]</div>
<p>As long as we know the molar absorptivity of each analyte at each wavelength collected from pure samples, we have three unknowns and three equations, so we can calculate the concentration of each component. The above equations can be represented as matrices shown below.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{ccc} \epsilon_{x \lambda 1} &amp; \epsilon_{y \lambda 1} &amp; \epsilon_{z \lambda 1} \\ \epsilon_{x \lambda 2} &amp; \epsilon_{y \lambda 2} &amp; \epsilon_{z \lambda 2} \\ \epsilon_{x \lambda 3} &amp; \epsilon_{y \lambda 3} &amp; \epsilon_{z \lambda 3} \end{array} \right]
\cdot
\left[ \begin{array}{c} C_x \\ C_y \\ C_z \end{array} \right]
=
\left[ \begin{array}{c} A_{\lambda 1} \\ A_{\lambda 2} \\ A_{\lambda 3} \end{array} \right] \end{split}\]</div>
<p>If the absorbances at the three wavelengths are 0.6469, 0.2823, and 0.2221, respectively, and we know the molar absorptivities, we get the following matrices.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{ccc} 7.8 &amp; 1.1 &amp; 2.0 \\ 2.6 &amp; 3.2 &amp; 0.89 \\ 1.8 &amp; 1.0 &amp; 8.9 \end{array} \right]
\cdot
\left[ \begin{array}{c} C_x \\ C_y \\ C_z \end{array} \right]
=
\left[ \begin{array}{c} 0.6469 \\ 0.2823 \\ 0.2221 \end{array} \right] \end{split}\]</div>
<p>We simply solve for the concentration matrix as was done earlier. Again, this is solvable using NumPy as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">7.8</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">]])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6469</span><span class="p">,</span> <span class="mf">0.282274</span><span class="p">,</span> <span class="mf">0.22214</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.078 , 0.023 , 0.0066])
</pre></div>
</div>
</div>
</div>
<p>The concentrations are <span class="math notranslate nohighlight">\(C_x\)</span> = 0.078 M, <span class="math notranslate nohighlight">\(C_y\)</span> = 0.023 M, and <span class="math notranslate nohighlight">\(C_z\)</span> = 0.0066 M.</p>
<p>Alternatively, there is a <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code> function that accomplishes the same calculation in a single function call. This function requires two pieces of information: the coefficient matrix and the dependant variable matrix. In our example, these are <code class="docutils literal notranslate"><span class="pre">E</span></code> and <code class="docutils literal notranslate"><span class="pre">A</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.078 , 0.023 , 0.0066])
</pre></div>
</div>
</div>
</div>
<p id="index-10">If you perform either the above calculations on other data and receive a <code class="docutils literal notranslate"><span class="pre">LinAlgError:</span> <span class="pre">Singular</span> <span class="pre">matrix</span></code> error, this means that the coefficient matrix does not have an inverse and cannot be solved by these methods. One possible reason is that the coefficient matrix is not square - a requirement for obtaining an inverse. Here are two possible solutions to working around this issue.</p>
<span id="index-11"></span><ol class="arabic simple" id="singular-matrix">
<li><p>Substitute the <code class="docutils literal notranslate"><span class="pre">np.linalg.inv()</span></code> function with the Moore-Penrose pseudoinverse function <code class="docutils literal notranslate"><span class="pre">np.linalg.pinv()</span></code>. This versatile function can work with non-square matrices.</p></li>
<li><p>Substitute the <code class="docutils literal notranslate"><span class="pre">np.linalg.lstsq()</span></code> for the <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code> function. The former can find approximate solutions when exact solutions do not exist or when the coefficient matrix is not square. This is not uncommon when dealing with linear fitting because not all data points may fall perfectly on the line of best fit or the number of data points does not equal the number of independent variables.</p></li>
</ol>
<p>As an example inspired by <a class="reference external" href="https://doi.org/10.1021/ed077p185"><em>J. Chem. Educ.</em> <strong>2000,</strong> 77, 185-187</a>, let’s calculate the enthalpy of the following reaction</p>
<div class="math notranslate nohighlight">
\[ S_8(s) + 8 \, O_2(g) \rightarrow 8 \, SO_2(g) \quad \Delta H_{net} = ? \]</div>
<p>knowing the enthalpy of the following two subreactions.</p>
<div class="math notranslate nohighlight">
\[ S_8(s) + 4 \, O_2(g) \rightarrow SO_2(g) \quad \Delta H_1 = -3160 kJ \]</div>
<div class="math notranslate nohighlight">
\[ 2 \, SO_2(g) + O_2(g) \rightarrow 2 \, SO_3(g) \quad \Delta H_2 = -196 kJ \]</div>
<p id="index-12">Using Hess’s law, we need to multiply the subreactions 1 and 2 by coefficients and add them together to generate the overall net reaction. Remember that reversing a reaction results in reversing the sign of reaction enthalpy, so it’s the same as multiplying by -1. We can represent this calculation using matrices show below where r<span class="math notranslate nohighlight">\(_1\)</span> and r<span class="math notranslate nohighlight">\(_2\)</span> are the coefficients for each subreaction. The values in each row of the first matrix are the number of SO<span class="math notranslate nohighlight">\(_2\)</span>, SO<span class="math notranslate nohighlight">\(_3\)</span>, O<span class="math notranslate nohighlight">\(_2\)</span>, and S<span class="math notranslate nohighlight">\(_8\)</span> molecules, respectively, in the two subreactions, and the numbers in the last matrix are the numbers of the same molecules in the net reaction. The gray molecular formulas in the equation below are not part of the equation but rather are simply labels for clarity. You may notice that the coefficients in the balance equations on the reactant side are negative while products are positive. This allows us keep track of the side they are on.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{array}{ccc} \color{gray} {SO_2 \rightarrow} \\ \color{gray} {SO_3 \rightarrow} \\ \color{gray}{O_2 \rightarrow} \\ \color{gray}{S_8 \rightarrow} \end{array}
\left[ \begin{array}{ccc} 0 &amp; -2 \\ 8 &amp; 2 \\ -12 &amp; -1 \\ -1 &amp; 0 \end{array} \right]
\cdot
\left[ \begin{array}{c} r_1 \\ r_2 \end{array} \right]
=
\left[ \begin{array}{c} 8 \\ 0 \\ -8 \\ -1 \end{array} \right] \end{split}\]</div>
<p>If the three matrices are called A, R, and Y, respectively, we can rewrite the above calculation as follows.</p>
<div class="math notranslate nohighlight">
\[ A \cdot R = Y \]</div>
<p>When solving for R in the past, we simply multiplied both sides by <span class="math notranslate nohighlight">\(A^{-1}\)</span> like below.</p>
<div class="math notranslate nohighlight">
\[ A^{-1} \cdot A \cdot R = A^{-1} \cdot Y \]</div>
<div class="math notranslate nohighlight">
\[ R = A^{-1} \cdot Y \]</div>
<p>The problem we face is that matrix A is not square and thus the matrix inverse cannot be calculated. Instead, we can use the Moore-Penrose pseudoinverse in place of the regular inverse as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1., -4.])
</pre></div>
</div>
</div>
</div>
<p>This means we need to multiply the first subreaction by 1 and the second subreaction by -4 (i.e., reverse it and quadruple everything).</p>
<p>Alternatively, we can use the <code class="docutils literal notranslate"><span class="pre">np.linalg.lstsq()</span></code> similarly to how we use the <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code> function. Set the keyword argument <code class="docutils literal notranslate"><span class="pre">rcond=None</span></code> to avoid an error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 1., -4.]),
 array([1.85454492e-31]),
 np.int32(2),
 array([14.58924398,  2.27023349]))
</pre></div>
</div>
</div>
</div>
<p>For the final step of our calculation, we need to multiply the values r<span class="math notranslate nohighlight">\(_1\)</span> and r<span class="math notranslate nohighlight">\(_1\)</span> by the enthalpy values of the subreactions and add them together.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dH_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3160</span><span class="p">,</span> <span class="o">-</span><span class="mi">196</span><span class="p">])</span>

<span class="n">dH</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dH_sub</span><span class="p">)</span>
<span class="n">dH</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-2375.9999999999995)
</pre></div>
</div>
</div>
</div>
<p>This means that the enthalpy of the overall net reaction is -2376 kJ.</p>
</section>
<section id="least-square-minimization-by-the-normal-equation">
<span id="id15"></span><h3>8.3.3 Least-Square Minimization by the Normal Equation<a class="headerlink" href="#least-square-minimization-by-the-normal-equation" title="Link to this heading">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The normal equation used in this section is really just the Moore-Penrose pseudoinverse and is used here as a demonstration of performing matrix calculations.</p>
</div>
</aside>
<p id="index-14"><span id="index-13"></span>Finding the line of best fit through data points can be accomplished by least-square minimization. What we are essentially looking for is an equation of the form <span class="math notranslate nohighlight">\(y = mx + b\)</span> that is as close as possible to the data points, and the mean square error determines what qualifies as “close.” If we rewrite this problem in matrix or array form, it will look like the following for a series of four point (<span class="math notranslate nohighlight">\(x_n\)</span>, <span class="math notranslate nohighlight">\(y_n\)</span>) on a two-dimensional plane. The first array contains a column of ones to multiply with b, so for the first row, we get <span class="math notranslate nohighlight">\(mx_0 + b = y_0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{cc} x_0 &amp; 1 \\ x_1 &amp; 1 \\ x_2 &amp; 1 \\ x_3 &amp; 1 \end{array} \right]
\cdot
\left[ \begin{array}{c} m \\ b \end{array} \right]
=
\left[ \begin{array}{c} y_0 \\ y_1 \\ y_2 \\ y_3 \end{array} \right] \end{split}\]</div>
<p>We will call the leftmost matrix <span class="math notranslate nohighlight">\(X\)</span>, the center matrix <span class="math notranslate nohighlight">\(\theta\)</span>, and the rightmost matrix <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="math notranslate nohighlight">
\[ X \cdot \theta = y \]</div>
<p>Ultimately, we are looking for the values of <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, so we need to solve for matrix <span class="math notranslate nohighlight">\(\theta\)</span>. This can be accomplished through optimization algorithms (section <a class="reference internal" href="../chapter_14/chap_14_notebook.html#id6"><span class="std std-ref">14.2</span></a>), or in the case of linear regression, there is a direct solution known as the <em>normal equation</em> shown below where <span class="math notranslate nohighlight">\(X^T\)</span> is the transpose of <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="math notranslate nohighlight">
\[ (X^T \cdot X)^{-1} \cdot X^T \cdot y = \theta \]</div>
<p>As an example, below is a table of synthetic data for copper cuprizone absorbances at various concentrations at 591 nm. We can use a linear fit to create a calibration curve from this data.</p>
<p><strong>Table 5</strong> Beer-Lambert Law Data for Copper Cuprizone</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Concentration (10<span class="math notranslate nohighlight">\(^{-6}\)</span> M)</p></th>
<th class="head text-center"><p>Absorbance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1.0</p></td>
<td class="text-center"><p>0.0154</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3.0</p></td>
<td class="text-center"><p>0.0467</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>6.0</p></td>
<td class="text-center"><p>0.0930</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>15</p></td>
<td class="text-center"><p>0.2311</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>25</p></td>
<td class="text-center"><p>0.3925</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>35</p></td>
<td class="text-center"><p>0.5413</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0e-06</span><span class="p">,</span> <span class="mf">3.0e-06</span><span class="p">,</span> <span class="mf">6.0e-06</span><span class="p">,</span> <span class="mf">1.5e-05</span><span class="p">,</span> <span class="mf">2.5e-05</span><span class="p">,</span> <span class="mf">3.5e-05</span><span class="p">])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0154</span><span class="p">,</span> <span class="mf">0.0467</span><span class="p">,</span> <span class="mf">0.0930</span> <span class="p">,</span> <span class="mf">0.2311</span><span class="p">,</span> <span class="mf">0.3975</span><span class="p">,</span> <span class="mf">0.5413</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">A</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.0e-06, 1.0e+00],
       [3.0e-06, 1.0e+00],
       [6.0e-06, 1.0e+00],
       [1.5e-05, 1.0e+00],
       [2.5e-05, 1.0e+00],
       [3.5e-05, 1.0e+00]])
</pre></div>
</div>
</div>
</div>
<p>For the sake of readability, the calculation using the normal equation has been split in half as shown below.</p>
<div class="math notranslate nohighlight">
\[ u = (X^T \cdot X)^{-1} \]</div>
<div class="math notranslate nohighlight">
\[ v = X^T \cdot y \]</div>
<div class="math notranslate nohighlight">
\[ u\cdot v = \theta \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.55886203e+04, -5.45355390e-06])
</pre></div>
</div>
</div>
</div>
<p>A plot of the linear regression and the data points is shown below, and the linear regression returned a molar absorptivity of 1.55 <span class="math notranslate nohighlight">\(\times\)</span> 10<span class="math notranslate nohighlight">\(^4\)</span> cm<span class="math notranslate nohighlight">\(^{-1}\)</span>M<span class="math notranslate nohighlight">\(^{-1}\)</span>.The regression also returned a <span class="math notranslate nohighlight">\(y\)</span>-intercept value of -5.45 <span class="math notranslate nohighlight">\(\times\)</span> 10<span class="math notranslate nohighlight">\(^{-6}\)</span>, which is below the detection limits making it practically zero. This makes sense because the <span class="math notranslate nohighlight">\(y\)</span>-intercept should always be approximately zero if the background is subtracted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4e-5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.55886e4</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">5.45355e-6</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Concentration, M&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorbance, au&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4c84e532916e022f8aba273c382a24bfbebdbf7e99bbfc0885d8e3296a157b04.svg" src="../../_images/4c84e532916e022f8aba273c382a24bfbebdbf7e99bbfc0885d8e3296a157b04.svg" />
</div>
</div>
</section>
<section id="balancing-chemical-equations">
<span id="id16"></span><h3>8.3.4 Balancing Chemical Equations<a class="headerlink" href="#balancing-chemical-equations" title="Link to this heading">#</a></h3>
<p id="index-15">Matricies can also be used to balance chemical equations as shown below where <span class="math notranslate nohighlight">\(x_1\)</span> through <span class="math notranslate nohighlight">\(x_4\)</span> are the coefficients for the balanced chemical equation.</p>
<div class="math notranslate nohighlight">
\[ x_1 C_3H_{8} + x_2 O_2 \rightarrow x_3 CO_2 + x_4 H_2O \]</div>
<p>We can then describe the number of carbon, hydrogen, and oxygen atoms in each compound using 3 <span class="math notranslate nohighlight">\(\times\)</span> 1 matricies <span class="math notranslate nohighlight">\(\left[ \begin{array}{c} C \\ H \\ O \end{array} \right]\)</span> as shown below.</p>
<div class="math notranslate nohighlight">
\[\begin{split} x_1 \left[ \begin{array}{c} 3 \\ 8 \\ 0 \end{array} \right] +
   x_2 \left[ \begin{array}{c} 0 \\ 0 \\ 2 \end{array} \right] \rightarrow
   x_3 \left[ \begin{array}{c} 1 \\ 0 \\ 2 \end{array} \right] +
   x_4 \left[ \begin{array}{c} 0 \\ 2 \\ 1 \end{array} \right]
\end{split}\]</div>
<p>Because the number of carbons, hydrogens, and oxygens should be the same on both sides of the balanced chemical equation, if we subtract the products from the reactants, we should get zero.</p>
<div class="math notranslate nohighlight">
\[\begin{split} x_1 \left[ \begin{array}{c} 3 \\ 8 \\ 0 \end{array} \right] +
   x_2 \left[ \begin{array}{c} 0 \\ 0 \\ 2 \end{array} \right] -
   x_3 \left[ \begin{array}{c} 1 \\ 0 \\ 2 \end{array} \right] -
   x_4 \left[ \begin{array}{c} 0 \\ 2 \\ 1 \end{array} \right] =
   \left[ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right]
\end{split}\]</div>
<p>One potentiall issue with this set of linear equations is that making all the <span class="math notranslate nohighlight">\(x\)</span> variables zero is a valid solution, so to avoid this solution, we will set one of the <span class="math notranslate nohighlight">\(x\)</span> variables to one. Remember that a balanced chemical equation is about the appropriate ratio between the reactants and products, so setting a single coefficient to one can still generate a balanced equation. The one issue is that the coefficients generated by the software may not be integers, but this can be fixed by multiplying the fractions to get whole numbers as a final step demonstrated below.</p>
<p>Here we have set <span class="math notranslate nohighlight">\(x_4\)</span> = 1.</p>
<div class="math notranslate nohighlight">
\[\begin{split} x_1 \left[ \begin{array}{c} 3 \\ 8 \\ 0 \end{array} \right] +
   x_2 \left[ \begin{array}{c} 0 \\ 0 \\ 2 \end{array} \right] -
   x_3 \left[ \begin{array}{c} 1 \\ 0 \\ 2 \end{array} \right] -
   (1) \left[ \begin{array}{c} 0 \\ 2 \\ 1 \end{array} \right] =
   \left[ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right]
\end{split}\]</div>
<p>Now we move the last term to the right side.</p>
<div class="math notranslate nohighlight">
\[\begin{split} x_1 \left[ \begin{array}{c} 3 \\ 8 \\ 0 \end{array} \right] +
   x_2 \left[ \begin{array}{c} 0 \\ 0 \\ 2 \end{array} \right] -
   x_3 \left[ \begin{array}{c} 1 \\ 0 \\ 2 \end{array} \right] = 
   \left[ \begin{array}{c} 0 \\ 2 \\ 1 \end{array} \right]
\end{split}\]</div>
<p>These matricies can now be merged into one larger matrix. The left matrix below will be called <code class="docutils literal notranslate"><span class="pre">M</span></code> and the right matrix below is called <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{ccc} 3 &amp; 0 &amp; -1 \\ 8 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; -2 \end{array} \right]
\cdot
\left[ \begin{array}{c} x_1 \\ x_2 \\ x_3 \end{array} \right]
=
\left[ \begin{array}{c} 0 \\ 2 \\ 1 \end{array} \right] \end{split}\]</div>
<p>We can then solve for the <span class="math notranslate nohighlight">\(x\)</span> values to get our coefficients using the <code class="docutils literal notranslate"><span class="pre">np.linalg.solve()</span></code> function as demonstrated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.25, 1.25, 0.75])
</pre></div>
</div>
</div>
</div>
<p>This means that <span class="math notranslate nohighlight">\(x_1\)</span>=0.25, <span class="math notranslate nohighlight">\(x_2\)</span>=1.25, and <span class="math notranslate nohighlight">\(x_3\)</span>=0.75. We can append <span class="math notranslate nohighlight">\(x_4\)</span> below and then multiply all the values by the same number to generate all integers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">*</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 5., 3., 4.])
</pre></div>
</div>
</div>
</div>
<p>This means that the integer coefficients for the balanced chemical equation are <span class="math notranslate nohighlight">\(x_1\)</span>=1, <span class="math notranslate nohighlight">\(x_2\)</span>=5, <span class="math notranslate nohighlight">\(x_3\)</span>=3, and <span class="math notranslate nohighlight">\(x_4\)</span>=4.</p>
<div class="math notranslate nohighlight">
\[ C_3H_{8} + 5\, O_2 \rightarrow 3\, CO_2 + 4\, H_2O \]</div>
</section>
<section id="eigenvalues-and-eigenvectors">
<span id="id17"></span><h3>8.3.5 Eigenvalues and Eigenvectors<a class="headerlink" href="#eigenvalues-and-eigenvectors" title="Link to this heading">#</a></h3>
<p id="index-19"><span id="index-18"></span><span id="index-17"></span><span id="index-16"></span>This section covers using <code class="docutils literal notranslate"><span class="pre">np.linalg</span></code> to calculate <em>eigenvalues</em> and <em>eigenvectors</em> which is useful in quantum mechanics among other applications. This topic will not be utilized later in this book, so feel free to skip over this section if you have no interest in this topic.</p>
<p>For a square matrix <span class="math notranslate nohighlight">\(A\)</span>, there can exist a scalar <span class="math notranslate nohighlight">\(\lambda\)</span> and vector <span class="math notranslate nohighlight">\(V\)</span> that satisfy the following equation.</p>
<div class="math notranslate nohighlight">
\[ AV = \lambda V \]</div>
<p>The vector and scalar are known as the eigenvector and eigenvalue, respectively, and there may be more than one solution for any given matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">np.linalg</span></code> module includes a function <code class="docutils literal notranslate"><span class="pre">np.linalg.eig()</span></code> that returns the eigenvalue(s) and eigenvector(s) for a given square matrix in this order</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>As an example, we can determine the eigenvalues and eigenvector for the following matrix.</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \left[ \begin{array}{c} 3 &amp; 1 \\ 4 &amp; 3 \end{array} \right] \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EigResult(eigenvalues=array([5., 1.]), eigenvectors=array([[ 0.4472136 , -0.4472136 ],
       [ 0.89442719,  0.89442719]]))
</pre></div>
</div>
</div>
</div>
<p>The first array contains the two eigenvalues while the second matrix contains the two eigenvector solutions.</p>
<p>Not every matrix has eigenvalues or eigenvectors. In the case of the following 90<span class="math notranslate nohighlight">\(\circ\)</span> rotation matrix, the solution generated includes <span class="math notranslate nohighlight">\(j\)</span> values which is Python’s notation used for imaginary and complex numbers.</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \left[ \begin{array}{c} 0 &amp; -1 \\ 1 &amp; 0 \end{array} \right] \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EigResult(eigenvalues=array([0.+1.j, 0.-1.j]), eigenvectors=array([[0.70710678+0.j        , 0.70710678-0.j        ],
       [0.        -0.70710678j, 0.        +0.70710678j]]))
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="calculus">
<span id="id18"></span><h2>8.4 Calculus<a class="headerlink" href="#calculus" title="Link to this heading">#</a></h2>
<p id="index-20">SymPy and SciPy both contain functionality for performing calculus operations. We will start with SymPy for the symbolic math and switch over to SciPy for the strictly numerical work in <a class="reference internal" href="#id21"><span class="std std-ref">section 8.4.3</span></a>. In this section, we will be working with the radial density functions (<span class="math notranslate nohighlight">\(\psi\)</span>) for hydrogen atomic orbitals. The squares of these functions (<span class="math notranslate nohighlight">\(\psi ^2\)</span>) provide the probability of finding an electron with respect to distance from the nucleus. While these equations are available in various textbooks, SymPy provides a <code class="docutils literal notranslate"><span class="pre">physics</span></code> module with a <code class="docutils literal notranslate"><span class="pre">R_nl()</span></code> function for generating these equations based on the principle (<em>n</em>) quantum number, angular (<em>l</em>) quantum number, and the atomic number (<em>Z</em>). For example, to generate the function for the 2p orbital of hydrogen, <em>n</em> = 2, <em>l</em> = 1, and <em>Z</em> = 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.physics.hydrogen</span> <span class="kn">import</span> <span class="n">R_nl</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">R_21</span> <span class="o">=</span> <span class="n">R_nl</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R_21</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\sqrt{6} r e^{- \frac{r}{2}}}{12}\]</div>
</div>
</div>
<p>This provides the wavefunction equation with respect to the radius, <em>r</em>. We can also convert it to a Python function using the <code class="docutils literal notranslate"><span class="pre">sympy.lambdify()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">R_21</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This function is now callable by providing a value for <em>r</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.07948602207520471)
</pre></div>
</div>
</div>
</div>
<section id="differentiation">
<span id="id19"></span><h3>8.4.1 Differentiation<a class="headerlink" href="#differentiation" title="Link to this heading">#</a></h3>
<p id="index-21">SymPy can take the derivative of mathematical expression using the <code class="docutils literal notranslate"><span class="pre">sympy.diff()</span></code> function.  This function requires a mathematical expression, the variable with respect the derivative is taken from, and the degree. The default behavior is to take the first derivative if a degree is not specified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
<p>As an example problem, the radius of maximum density can be found by taking the first derivative of the radial equation and solving for zero slope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dR_21</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">R_21</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dR_21</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{\sqrt{6} r e^{- \frac{r}{2}}}{24} + \frac{\sqrt{6} e^{- \frac{r}{2}}}{12}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">dR_21</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">solve()</span></code> function returns an array, so we need to index it to get the single value out. We can plot the radial density and the maximum density point to see if it worked.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">mx</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Radius, $a_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/27dc3bdfa8579c39f917f3493b601fb9fb7ab07e828600a2eed71d3ba717f430.svg" src="../../_images/27dc3bdfa8579c39f917f3493b601fb9fb7ab07e828600a2eed71d3ba717f430.svg" />
</div>
</div>
<p>The radius is in Bohrs (<span class="math notranslate nohighlight">\(a_0\)</span>) which is equal to approximately 0.53 angstroms.</p>
</section>
<section id="integration-of-functions">
<span id="id20"></span><h3>8.4.2 Integration of Functions<a class="headerlink" href="#integration-of-functions" title="Link to this heading">#</a></h3>
<p id="index-22">SymPy can also integrate expressions using the <code class="docutils literal notranslate"><span class="pre">sympy.integrate()</span></code> function which takes the mathematical expression and the variable plus integration range in the form of a tuple. If the integration range is omitted, then SymPy will return a symbolic expression.</p>
<p>The normalized (i.e., totals to one) density function is the squared wave function times <span class="math notranslate nohighlight">\(r^2\)</span> (i.e, <span class="math notranslate nohighlight">\(\psi ^2 r^2\)</span>). We can use this to determine the probability of finding an electron in a particular range of distances from the radius. Below, we integrate from the nucleus to the radius of maximum density.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">R_21</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 0.0526530173437111\]</div>
</div>
</div>
<p>There is a 5.27% probability finding an electron between the nucleus and the radius of maximum probability. This is probably may be a bit surprising, but examination of the radial density plot reveals that the radius of maximum probabily is quite close to the nucleus with a significant amount of density beyond the maximum radius. Let’s see the probability of finding an electron between 0 and 10 Bohrs from the nucleus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">R_21</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 0.970747311923039\]</div>
</div>
</div>
<p>There is a 97.1% chance of finding the electron between 0 and 10 angstroms.</p>
<p>The SciPy library also includes functions in the <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module for integrating mathematical functions. Information can be found on the SciPy documentation page listed at the end of this chapter under <a class="reference internal" href="#further-reading08"><span class="std std-ref">Further Reading</span></a>.</p>
</section>
<section id="integrating-sampled-data">
<span id="id21"></span><h3>8.4.3 Integrating Sampled Data<a class="headerlink" href="#integrating-sampled-data" title="Link to this heading">#</a></h3>
<p>The above integration assumes a mathematical function is known. There are times when there is no known function to describe the data such as spectra. This is common in NMR spectroscopy and gas chromatography (GC) among many other applications where integrations of peak areas are used to quantify different components of a spectrum.</p>
<p>In the following example, we will use a section of a <span class="math notranslate nohighlight">\(^1\)</span>H NMR spectrum where we want to determine the ratio of the three triplet peaks via integration. NMR spectra are typically stored in binary files that require a special library to read, which is covered in chapter 11. For simplicity in this example, the data for a section of the NMR spectrum has been converted to a CSV file titled <em>Ar_NMR.csv</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;data/Ar_NMR.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">nmr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.00000000e+00, 3.42490660e-03],
       [1.00000000e+00, 4.52560300e-03],
       [2.00000000e+00, 6.67372160e-03],
       [3.00000000e+00, 8.58410100e-03],
       [4.00000000e+00, 1.23892580e-02],
       [5.00000000e+00, 2.12517060e-02],
       [6.00000000e+00, 5.18062560e-02],
       [7.00000000e+00, 1.23403220e-01],
       [8.00000000e+00, 7.49717060e-02],
       [9.00000000e+00, 1.12987520e-01],
       [1.00000000e+01, 2.47482900e-01],
       [1.10000000e+01, 1.04401566e-01],
       [1.20000000e+01, 8.17907750e-02],
       [1.30000000e+01, 1.38453960e-01],
       [1.40000000e+01, 5.04080100e-02],
       [1.50000000e+01, 2.00982630e-02],
       [1.60000000e+01, 1.38752850e-02],
       [1.70000000e+01, 1.28241135e-02],
       [1.80000000e+01, 1.54948140e-02],
       [1.90000000e+01, 1.70803180e-02],
       [2.00000000e+01, 2.34651420e-02],
       [2.10000000e+01, 4.76330930e-02],
       [2.20000000e+01, 1.10299855e-01],
       [2.30000000e+01, 7.56612400e-02],
       [2.40000000e+01, 1.15097150e-01],
       [2.50000000e+01, 1.85112450e-01],
       [2.60000000e+01, 3.18055840e-01],
       [2.70000000e+01, 2.44278220e-01],
       [2.80000000e+01, 1.44489410e-01],
       [2.90000000e+01, 6.10540140e-02],
       [3.00000000e+01, 7.93569160e-02],
       [3.10000000e+01, 7.98874400e-02],
       [3.20000000e+01, 2.85217260e-02],
       [3.30000000e+01, 1.68548040e-02],
       [3.40000000e+01, 1.48743290e-02],
       [3.50000000e+01, 1.39662160e-02],
       [3.60000000e+01, 1.28568120e-02],
       [3.70000000e+01, 1.59042850e-02],
       [3.80000000e+01, 2.24487820e-02],
       [3.90000000e+01, 5.66768200e-02],
       [4.00000000e+01, 6.38733950e-02],
       [4.10000000e+01, 4.39581830e-02],
       [4.20000000e+01, 1.09901360e-01],
       [4.30000000e+01, 9.82578100e-02],
       [4.40000000e+01, 3.91401280e-02],
       [4.50000000e+01, 6.37550060e-02],
       [4.60000000e+01, 4.55453170e-02],
       [4.70000000e+01, 1.38955860e-02],
       [4.80000000e+01, 7.40419900e-03],
       [4.90000000e+01, 4.81957300e-03]])
</pre></div>
</div>
</div>
</div>
<p>The imported data are stored in an array where the first column contains the index values and the second column contains the amplitudes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nmr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nmr</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d8113ac034872781d86dda003ac764282490136c85c9639aa971c847b498f5f6.svg" src="../../_images/d8113ac034872781d86dda003ac764282490136c85c9639aa971c847b498f5f6.svg" />
</div>
</div>
<p>Above is a plot of the peaks with respect to the index values (not ppm). To integrate under each of the triplet peaks, first we need the index values for the edges of each peak. Below is a list, <code class="docutils literal notranslate"><span class="pre">i</span></code>, that provides reasonable boundaries, and a plot is below with these edges marked in orange squares.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span> <span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nmr</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">nmr</span><span class="p">[</span><span class="n">point</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;C1s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c824dd4d147e84b88b950f977b9fc613ab612197349e476cf7001dd50c0aad82.svg" src="../../_images/c824dd4d147e84b88b950f977b9fc613ab612197349e476cf7001dd50c0aad82.svg" />
</div>
</div>
<p>Integrations under sampled data do not include the values between data points, so these regions are estimated based on assumptions. The <code class="docutils literal notranslate"><span class="pre">trapezoid()</span></code> function assumes that any data point between known points lies directly between the known data points (i.e., linear interpolation) as shown below by the blue lines.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../../_images/f255f63adc09cfe45d57adc7d3c65ae0c40d0a5eb6fd8672870dfbb1ea7cf50a.svg" src="../../_images/f255f63adc09cfe45d57adc7d3c65ae0c40d0a5eb6fd8672870dfbb1ea7cf50a.svg" />
</div>
</div>
<p>Alternatively, the <code class="docutils literal notranslate"><span class="pre">simpson()</span></code> function uses the <em>Simpson’s rule</em> which estimates the data between known points using quadratic interpolation shown below.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../../_images/1eb16b67a39f3e475b38cf16a9af78164ec4ffd4ce527e35769126424acc1484.svg" src="../../_images/1eb16b67a39f3e475b38cf16a9af78164ec4ffd4ce527e35769126424acc1484.svg" />
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of Scipy 1.14, the former <code class="docutils literal notranslate"><span class="pre">trapz()</span></code> and <code class="docutils literal notranslate"><span class="pre">simps()</span></code> functions have been replaced by <code class="docutils literal notranslate"><span class="pre">trapezoid()</span></code> and <code class="docutils literal notranslate"><span class="pre">simpson()</span></code>, respectively.</p>
</div>
</aside>
<p>Below, both the trapezoidal and Simpson’s methods are demonstrated. Note that the <code class="docutils literal notranslate"><span class="pre">trapezoid(x,</span> <span class="pre">y)</span></code> function takes both the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> values as required, positional arguments while <code class="docutils literal notranslate"><span class="pre">simpson(y,</span> <span class="pre">x=)</span></code> only requires  the <span class="math notranslate nohighlight">\(y\)</span> data but will optionally accept the <span class="math notranslate nohighlight">\(x\)</span> data as a keyword argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapezoid</span><span class="p">,</span> <span class="n">simpson</span>

<span class="c1"># trapezoid method</span>
<span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">nmr</span><span class="p">[</span><span class="n">peak</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">peak</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">nmr</span><span class="p">[</span><span class="n">peak</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">peak</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0401881535
1.529880057
0.5834871775
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simpson method (note the different arguments)</span>
<span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">nmr</span><span class="p">[</span><span class="n">peak</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">peak</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">nmr</span><span class="p">[</span><span class="n">peak</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">peak</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">simpson</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0405229256666666
1.5661107306666666
0.5839565783333334
</pre></div>
</div>
</div>
</div>
<p>The three peaks have areas of approximately 2:3:1 ratio. Using Simpson’s rule here gives approximately the same result.</p>
</section>
<section id="integrating-ordinary-differential-equations">
<span id="id22"></span><h3>8.4.4 Integrating Ordinary Differential Equations<a class="headerlink" href="#integrating-ordinary-differential-equations" title="Link to this heading">#</a></h3>
<p><em>Ordinary differential equations (ODE)</em> mathematically describe the change of one or more dependent variables with respect to an independent variable. Common chemical applications include chemical kinetics, diffusion, electric current, among others. The SciPy <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module provides an ODE integrator called <code class="docutils literal notranslate"><span class="pre">odeint()</span></code> which can integrate ordinary differential equations. This is useful for, among other things, integrating under kinetic differential equations to determine the concentration of reactants and products over the course of a chemical reaction.</p>
<p>For example, the following is a first-order chemical reaction with starting material, A, and product, P.</p>
<div class="math notranslate nohighlight">
\[ A \rightarrow P \]</div>
<p id="index-23">The decay of a radioactive isotope is an example of a first-order reaction because the rate of decay is proportional to the amount of A. First-order reaction rates are described by</p>
<div class="math notranslate nohighlight">
\[ Rate = \frac{d[A]}{dt} = -k[A] \]</div>
<p>where [A] is the concentration (M) of A, <span class="math notranslate nohighlight">\(k\)</span> is the rate constant (1/s), and rate is the change in [A] versus time (M/s). The <code class="docutils literal notranslate"><span class="pre">odeint()</span></code> function below takes a differential equation in the form of a Python function, <code class="docutils literal notranslate"><span class="pre">func</span></code>, the initial values for A, <code class="docutils literal notranslate"><span class="pre">A0</span></code>, and a list or array of the times,<code class="docutils literal notranslate"><span class="pre">t</span></code>, to calculate the [A] .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">A0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>The Python function can be defined by a <code class="docutils literal notranslate"><span class="pre">def</span></code> statement or a lambda expression. The former is used below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rate_1st</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<p>The function should take the dependent variable(s) as the first positional argument and the independent variable as the second positional argument. In this example, <code class="docutils literal notranslate"><span class="pre">A</span></code> is the dependent variable and time, <code class="docutils literal notranslate"><span class="pre">t</span></code>, is the independent variable. If there are multiple dependent variables, they need to be provided inside a composite object like a list or tuple which can be unpacked through indexing or tuple unpacking once inside the function. You may also notice that t is an unused argument in our Python function. It is included and required to signal to <code class="docutils literal notranslate"><span class="pre">odeint()</span></code> that the independent variable is <code class="docutils literal notranslate"><span class="pre">t</span></code>. The function is integrated below at times defined by <code class="docutils literal notranslate"><span class="pre">t</span></code>, and the initial concentration of A and rate constant are <code class="docutils literal notranslate"><span class="pre">A0</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># time(seconds)</span>
<span class="n">A0</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># starting concentration (molarity)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># rate constant in 1/s</span>
<span class="n">A_t</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rate_1st</span><span class="p">,</span> <span class="n">A0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">P_t</span> <span class="o">=</span> <span class="n">A0</span> <span class="o">-</span> <span class="n">A_t</span>    <span class="c1"># concentration of product</span>
</pre></div>
</div>
</div>
</div>
<p>The concentration of product (<code class="docutils literal notranslate"><span class="pre">P_t</span></code>) is calculated through the difference between the initial concentration of starting material and the current concentration. That is, we assume that whatever starting material was consumed has become product. The results of the simulation have been visualized below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">A_t</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">P_t</span><span class="p">,</span> <span class="s1">&#39;p-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time, s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[X], M&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8fc319368f9130b0ff9259a6046fb792680eb0670c61be8da6862229f41dcdcd.svg" src="../../_images/8fc319368f9130b0ff9259a6046fb792680eb0670c61be8da6862229f41dcdcd.svg" />
</div>
</div>
<p>This approach to kinetic simulations can be adapted to even more complex reactions which are demonstrated in <a class="reference internal" href="../chapter_09/chap_09_notebook.html#id6"><span class="std std-ref">section 9.1.4</span></a>.</p>
</section>
</section>
<section id="mathematics-in-python">
<span id="id23"></span><h2>8.5 Mathematics in Python<a class="headerlink" href="#mathematics-in-python" title="Link to this heading">#</a></h2>
<p>Between SymPy, NumPy, SciPy, and Python’s built-in functionality, there is often more than one way to carry out calculations in Python. For example, finding roots and derivatives of polynomials can be, along with the approaches demonstrated in this chapter, calculated by creating a NumPy <code class="docutils literal notranslate"><span class="pre">Polynomial</span></code> object and using NumPy’s <code class="docutils literal notranslate"><span class="pre">roots()</span></code> and <code class="docutils literal notranslate"><span class="pre">deriv()</span></code> methods, respectively. How you carry out a calculation can often come down to matter of person preference, though there are differences in terms of speed and the output format. Find what works for you and do not necessarily worry if others are doing the same calculations through a different library or set of functions.</p>
</section>
<section id="further-reading">
<span id="further-reading08"></span><h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>SymPy Website. <a class="reference external" href="http://www.sympy.org/en/index.html">http://www.sympy.org/en/index.html</a> (free resource)</p></li>
<li><p>SciPy and NumPy Documentation Pages. <a class="reference external" href="http://www.sympy.org/en/index.html">https://docs.scipy.org/doc/</a> (free resource)</p></li>
</ol>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>Complete the following exercises in a Jupyter notebook using the SymPy and SciPy libraries. Any data file(s) refered to in the problems can be found in the <a class="reference external" href="https://github.com/weisscharlesj/SciCompforChemists/tree/master/notebooks">data</a> folder in the same directory as this chapter’s Jupyter notebook. Alternatively, you can download a zip file of the data for this chapter from <a class="reference external" href="https://github.com/weisscharlesj/data_SciCompforChem">here</a> by selecting the appropriate chapter file and then clicking the <strong>Download</strong> button.</p>
<ol class="arabic">
<li><p>Factor the following polynomial using SymPy: <span class="math notranslate nohighlight">\(x^2 + x – 6\)</span></p></li>
<li><p>Simplify the following mathematical expression using SymPy: <span class="math notranslate nohighlight">\( z = 3x + x^2 + 2xy \)</span></p></li>
<li><p>Expand the following expression using SymPy: <span class="math notranslate nohighlight">\((x – 2)(x + 5)(x)\)</span></p></li>
<li><p>A 53.2 g block of lead (Cp = 0.128 J/g·°C) at 128 °C is dropped into a 238.1 g water (Cp = 4.18 J/g·°C) at 25.0 °C. What is the final temperature of both the lead and water?
Hint: Assume this is an isolated system, so q<span class="math notranslate nohighlight">\(_{lead}\)</span> + q<span class="math notranslate nohighlight">\(_{water}\)</span> = 0. We also know that <span class="math notranslate nohighlight">\(q = mCp \Delta T\)</span>.</p></li>
<li><p>The following equation relates the <span class="math notranslate nohighlight">\(\Delta\)</span>G with respect to the equilibrium constant K.</p>
<div class="math notranslate nohighlight">
\[ \Delta G = \Delta G^o - RT ln(K) \]</div>
<p>If <span class="math notranslate nohighlight">\(\Delta G^o\)</span> = -1.22 kJ/mol for a chemical reaction, what is the value for K for this reaction at 298 K? Use the <code class="docutils literal notranslate"><span class="pre">sympy.solve()</span></code> function to solve this problem. Remember that equilibrium is when <span class="math notranslate nohighlight">\(\Delta\)</span>G = 0 kJ/mol, and watch your energy units. (R = 8.314 J/mol·K)</p>
</li>
<li><p>A matrix or array of x,y coordinates can be rotated on a two-dimensional plane around the origion by multiplying by the following rotation matrix (M<span class="math notranslate nohighlight">\(_R\)</span>). The angle (<span class="math notranslate nohighlight">\(\theta\)</span>) is in radians, and the coordinates are rotated clockwise around the origin.</p>
<div class="math notranslate nohighlight">
\[\begin{split} M_R = \left[ \begin{array}{cc} cos(\theta) &amp; -sin(\theta) \\ sin(\theta) &amp; cos(\theta) \end{array} \right] \end{split}\]</div>
<p>Below is an example using three generic points on the x,y plane.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \begin{array}{cc} x_0 &amp; y_0 \\ x_1 &amp; y_1 \\ x_2 &amp; y_2 \end{array} \right] 
    \cdot  
    \left[ \begin{array}{cc} cos(\theta) &amp; -sin(\theta) \\ sin(\theta) &amp; cos(\theta) \end{array} \right]  
    =
    \left[ \begin{array}{cc} x'_0 &amp; y'_0 \\ x'_1 &amp; y'_1 \\ x'_2 &amp; y'_2 \end{array} \right]
    \end{split}\]</div>
<p>a) Given the following coordinates for the four atoms in carbonate (CO<span class="math notranslate nohighlight">\(_3^{2-}\)</span>) measured in angstroms, rotate them       90<span class="math notranslate nohighlight">\(^o\)</span> clockwise. Plot the initial and rotated points in different colors to show that it worked.</p>
<div class="math notranslate nohighlight">
\[ C: (2.00, 2.00) \quad O1: (2.00, 3.28) \quad O2: (0.27, 1.50) \quad O3: (3.73, 1.50) \]</div>
<p>b) Package the above code into a function that takes an array of points and an angle and performs the above rotation.</p>
</li>
<li><p>Using the rotation matrix described in the above problem, write a function that rotates the carbonate anion around its own center of mass. The suggested steps to complete this task are listed below.</p>
<p>a) Calculate the center of mass</p>
<p>b)  Subtract the center of mass from all points to shift the cluster to the origin.</p>
<p>c) Rotate the cluster of points.</p>
<p>d) Add the center of mass back the cluster the shift the points back.</p>
</li>
<li><p>The following is the equation for the work performed by a reversible, isothermal (i.e., constant T) expansion of a piston by a fixed quantity of gas.</p>
<div class="math notranslate nohighlight">
\[ w = \int_{v_i}^{v_f} -nRT \frac{1}{V}dV \]</div>
<p>a) Using SymPy, integrate this expression symbolically for V<span class="math notranslate nohighlight">\(_i\)</span> <span class="math notranslate nohighlight">\(\rightarrow\)</span> V<span class="math notranslate nohighlight">\(_f\)</span>. Try having SymPy simplify the answer to see if there is a simpler form.</p>
<p>b) Integrate the same express above for the expansion of 2.44 mol of He gas from 0.552 L to 1.32 L at 298 K. Feel free to use either SymPy or SciPy.</p>
</li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">odeint()</span></code>, simulate the concentration of starting material for the second-order reaction below and overlay it with the second-order integrated rate law to show that they agree.</p>
<div class="math notranslate nohighlight">
\[ 2A \rightarrow P \]</div>
</li>
<li><p>Below are the transformation matricies for an S<span class="math notranslate nohighlight">\(_4\)</span> and C<span class="math notranslate nohighlight">\(_2\)</span> operation used in group theory. Show that two S<span class="math notranslate nohighlight">\(_4\)</span> operations equal one C<span class="math notranslate nohighlight">\(_2\)</span> operation by multiplying two S<span class="math notranslate nohighlight">\(_4\)</span> operations together. That is, show that S<span class="math notranslate nohighlight">\(_4\)</span>S<span class="math notranslate nohighlight">\(_4\)</span> = C<span class="math notranslate nohighlight">\(_2\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split} S_4 = \left[ \begin{array}{ccc} 0 &amp; -1 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; -1 \end{array} \right]
\quad
C_2 = \left[ \begin{array}{ccc} -1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right]
\end{split}\]</div>
</li>
<li><p>Using dot product math, write your own linear regression function that accepts the <em>x</em> and <em>y</em> coordinates of data points as separate arrays and returns the slope and intercept of a line of best fit.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "scicompchem-env"
        },
        kernelOptions: {
            name: "scicompchem-env",
            path: "./notebooks/chapter_08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'scicompchem-env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../chapter_07/chap_07_notebook.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 7: Image Processing &amp; Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../chapter_09/chap_09_notebook.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 9: Simulations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-mathematics">8.1 Symbolic Mathematics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbols">8.1.1 Symbols</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pretty-printing">8.1.2 Pretty Printing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sympy-mathematical-functions">8.1.3 SymPy Mathematical Functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algebra-in-sympy">8.2 Algebra in SymPy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomial-expansion-and-factoring">8.2.1 Polynomial Expansion and Factoring</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplification">8.2.2 Simplification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-equations">8.2.3 Solving Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibrium-ice-table">8.2.4 Equilibrium ICE Table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#substitutions">8.2.5 Substitutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">8.3 Matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-operations-with-arrays">8.3.1 Mathematical Operations with Arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-systems-of-equations">8.3.2 Solving Systems of Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#least-square-minimization-by-the-normal-equation">8.3.3 Least-Square Minimization by the Normal Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balancing-chemical-equations">8.3.4 Balancing Chemical Equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eigenvalues-and-eigenvectors">8.3.5 Eigenvalues and Eigenvectors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculus">8.4 Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differentiation">8.4.1 Differentiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-functions">8.4.2 Integration of Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-sampled-data">8.4.3 Integrating Sampled Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-ordinary-differential-equations">8.4.4 Integrating Ordinary Differential Equations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-in-python">8.5 Mathematics in Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Charles J. Weiss
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2017-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Scientific Computing for Chemists with Python is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>